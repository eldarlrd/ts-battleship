(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Kg=!1,Qg=(n,e)=>n===e,dt=Symbol("solid-proxy"),id=typeof Proxy=="function",Sa=Symbol("solid-track"),Pi={equals:Qg};let od=ud;const vn=1,Ci=2,ad={owned:null,cleanups:null,context:null,owner:null};var be=null;let aa=null,Xg=null,pe=null,Fe=null,Dt=null,ao=0;function ts(n,e){const t=pe,r=be,s=n.length===0,i=e===void 0?r:e,a=s?ad:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=s?n:()=>n(()=>st(()=>us(a)));be=a,pe=null;try{return br(c,!0)}finally{pe=t,be=r}}function Se(n,e){e=e?Object.assign({},Pi,e):Pi;const t={value:n,observers:null,observerSlots:null,comparator:e.equals||void 0},r=s=>(typeof s=="function"&&(s=s(t.value)),ld(t,s));return[cd.bind(t),r]}function re(n,e,t){const r=uc(n,e,!1,vn);As(r)}function Mt(n,e,t){od=tp;const r=uc(n,e,!1,vn);r.user=!0,Dt?Dt.push(r):As(r)}function at(n,e,t){t=t?Object.assign({},Pi,t):Pi;const r=uc(n,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=t.equals||void 0,As(r),cd.bind(r)}function Yg(n){return br(n,!1)}function st(n){if(pe===null)return n();const e=pe;pe=null;try{return n()}finally{pe=e}}function hu(n,e,t){const r=Array.isArray(n);let s,i=t&&t.defer;return a=>{let c;if(r){c=Array(n.length);for(let h=0;h<n.length;h++)c[h]=n[h]()}else c=n();if(i)return i=!1,a;const l=st(()=>e(c,s,a));return s=c,l}}function lc(n){Mt(()=>st(n))}function Ar(n){return be===null||(be.cleanups===null?be.cleanups=[n]:be.cleanups.push(n)),n}function Ra(){return pe}function Jg(n){const e=at(n),t=at(()=>Pa(e()));return t.toArray=()=>{const r=t();return Array.isArray(r)?r:r!=null?[r]:[]},t}function cd(){if(this.sources&&this.state)if(this.state===vn)As(this);else{const n=Fe;Fe=null,br(()=>Vi(this),!1),Fe=n}if(pe){const n=this.observers?this.observers.length:0;pe.sources?(pe.sources.push(this),pe.sourceSlots.push(n)):(pe.sources=[this],pe.sourceSlots=[n]),this.observers?(this.observers.push(pe),this.observerSlots.push(pe.sources.length-1)):(this.observers=[pe],this.observerSlots=[pe.sources.length-1])}return this.value}function ld(n,e,t){let r=n.value;return(!n.comparator||!n.comparator(r,e))&&(n.value=e,n.observers&&n.observers.length&&br(()=>{for(let s=0;s<n.observers.length;s+=1){const i=n.observers[s],a=aa&&aa.running;a&&aa.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?Fe.push(i):Dt.push(i),i.observers&&hd(i)),a||(i.state=vn)}if(Fe.length>1e6)throw Fe=[],new Error},!1)),e}function As(n){if(!n.fn)return;us(n);const e=ao;Zg(n,n.value,e)}function Zg(n,e,t){let r;const s=be,i=pe;pe=be=n;try{r=n.fn(e)}catch(a){return n.pure&&(n.state=vn,n.owned&&n.owned.forEach(us),n.owned=null),n.updatedAt=t+1,dd(a)}finally{pe=i,be=s}(!n.updatedAt||n.updatedAt<=t)&&(n.updatedAt!=null&&"observers"in n?ld(n,r):n.value=r,n.updatedAt=t)}function uc(n,e,t,r=vn,s){const i={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:be,context:be?be.context:null,pure:t};return be===null||be!==ad&&(be.owned?be.owned.push(i):be.owned=[i]),i}function ki(n){if(n.state===0)return;if(n.state===Ci)return Vi(n);if(n.suspense&&st(n.suspense.inFallback))return n.suspense.effects.push(n);const e=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<ao);)n.state&&e.push(n);for(let t=e.length-1;t>=0;t--)if(n=e[t],n.state===vn)As(n);else if(n.state===Ci){const r=Fe;Fe=null,br(()=>Vi(n,e[0]),!1),Fe=r}}function br(n,e){if(Fe)return n();let t=!1;e||(Fe=[]),Dt?t=!0:Dt=[],ao++;try{const r=n();return ep(t),r}catch(r){t||(Dt=null),Fe=null,dd(r)}}function ep(n){if(Fe&&(ud(Fe),Fe=null),n)return;const e=Dt;Dt=null,e.length&&br(()=>od(e),!1)}function ud(n){for(let e=0;e<n.length;e++)ki(n[e])}function tp(n){let e,t=0;for(e=0;e<n.length;e++){const r=n[e];r.user?n[t++]=r:ki(r)}for(e=0;e<t;e++)ki(n[e])}function Vi(n,e){n.state=0;for(let t=0;t<n.sources.length;t+=1){const r=n.sources[t];if(r.sources){const s=r.state;s===vn?r!==e&&(!r.updatedAt||r.updatedAt<ao)&&ki(r):s===Ci&&Vi(r,e)}}}function hd(n){for(let e=0;e<n.observers.length;e+=1){const t=n.observers[e];t.state||(t.state=Ci,t.pure?Fe.push(t):Dt.push(t),t.observers&&hd(t))}}function us(n){let e;if(n.sources)for(;n.sources.length;){const t=n.sources.pop(),r=n.sourceSlots.pop(),s=t.observers;if(s&&s.length){const i=s.pop(),a=t.observerSlots.pop();r<s.length&&(i.sourceSlots[a]=r,s[r]=i,t.observerSlots[r]=a)}}if(n.tOwned){for(e=n.tOwned.length-1;e>=0;e--)us(n.tOwned[e]);delete n.tOwned}if(n.owned){for(e=n.owned.length-1;e>=0;e--)us(n.owned[e]);n.owned=null}if(n.cleanups){for(e=n.cleanups.length-1;e>=0;e--)n.cleanups[e]();n.cleanups=null}n.state=0}function np(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function dd(n,e=be){throw np(n)}function Pa(n){if(typeof n=="function"&&!n.length)return Pa(n());if(Array.isArray(n)){const e=[];for(let t=0;t<n.length;t++){const r=Pa(n[t]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return n}const rp=Symbol("fallback");function du(n){for(let e=0;e<n.length;e++)n[e]()}function sp(n,e,t={}){let r=[],s=[],i=[],a=0,c=e.length>1?[]:null;return Ar(()=>du(i)),()=>{let l=n()||[],h=l.length,f,m;return l[Sa],st(()=>{let I,P,C,R,N,V,O,$,U;if(h===0)a!==0&&(du(i),i=[],r=[],s=[],a=0,c&&(c=[])),t.fallback&&(r=[rp],s[0]=ts(B=>(i[0]=B,t.fallback())),a=1);else if(a===0){for(s=new Array(h),m=0;m<h;m++)r[m]=l[m],s[m]=ts(p);a=h}else{for(C=new Array(h),R=new Array(h),c&&(N=new Array(h)),V=0,O=Math.min(a,h);V<O&&r[V]===l[V];V++);for(O=a-1,$=h-1;O>=V&&$>=V&&r[O]===l[$];O--,$--)C[$]=s[O],R[$]=i[O],c&&(N[$]=c[O]);for(I=new Map,P=new Array($+1),m=$;m>=V;m--)U=l[m],f=I.get(U),P[m]=f===void 0?-1:f,I.set(U,m);for(f=V;f<=O;f++)U=r[f],m=I.get(U),m!==void 0&&m!==-1?(C[m]=s[f],R[m]=i[f],c&&(N[m]=c[f]),m=P[m],I.set(U,m)):i[f]();for(m=V;m<h;m++)m in C?(s[m]=C[m],i[m]=R[m],c&&(c[m]=N[m],c[m](m))):s[m]=ts(p);s=s.slice(0,a=h),r=l.slice(0)}return s});function p(I){if(i[m]=I,c){const[P,C]=Se(m);return c[m]=C,e(l[m],P)}return e(l[m])}}}function z(n,e){return st(()=>n(e||{}))}function ni(){return!0}const Ca={get(n,e,t){return e===dt?t:n.get(e)},has(n,e){return e===dt?!0:n.has(e)},set:ni,deleteProperty:ni,getOwnPropertyDescriptor(n,e){return{configurable:!0,enumerable:!0,get(){return n.get(e)},set:ni,deleteProperty:ni}},ownKeys(n){return n.keys()}};function ca(n){return(n=typeof n=="function"?n():n)?n:{}}function ip(){for(let n=0,e=this.length;n<e;++n){const t=this[n]();if(t!==void 0)return t}}function Ct(...n){let e=!1;for(let a=0;a<n.length;a++){const c=n[a];e=e||!!c&&dt in c,n[a]=typeof c=="function"?(e=!0,at(c)):c}if(id&&e)return new Proxy({get(a){for(let c=n.length-1;c>=0;c--){const l=ca(n[c])[a];if(l!==void 0)return l}},has(a){for(let c=n.length-1;c>=0;c--)if(a in ca(n[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<n.length;c++)a.push(...Object.keys(ca(n[c])));return[...new Set(a)]}},Ca);const t={},r=Object.create(null);for(let a=n.length-1;a>=0;a--){const c=n[a];if(!c)continue;const l=Object.getOwnPropertyNames(c);for(let h=l.length-1;h>=0;h--){const f=l[h];if(f==="__proto__"||f==="constructor")continue;const m=Object.getOwnPropertyDescriptor(c,f);if(!r[f])r[f]=m.get?{enumerable:!0,configurable:!0,get:ip.bind(t[f]=[m.get.bind(c)])}:m.value!==void 0?m:void 0;else{const p=t[f];p&&(m.get?p.push(m.get.bind(c)):m.value!==void 0&&p.push(()=>m.value))}}}const s={},i=Object.keys(r);for(let a=i.length-1;a>=0;a--){const c=i[a],l=r[c];l&&l.get?Object.defineProperty(s,c,l):s[c]=l?l.value:void 0}return s}function op(n,...e){const t=e.length;if(id&&dt in n){const s=t>1?e.flat():e[0],i=e.map(a=>new Proxy({get(c){return a.includes(c)?n[c]:void 0},has(c){return a.includes(c)&&c in n},keys(){return a.filter(c=>c in n)}},Ca));return i.push(new Proxy({get(a){return s.includes(a)?void 0:n[a]},has(a){return s.includes(a)?!1:a in n},keys(){return Object.keys(n).filter(a=>!s.includes(a))}},Ca)),i}const r=[];for(let s=0;s<=t;s++)r[s]={};for(const s of Object.getOwnPropertyNames(n)){let i=t;for(let l=0;l<e.length;l++)if(e[l].includes(s)){i=l;break}const a=Object.getOwnPropertyDescriptor(n,s);!a.get&&!a.set&&a.enumerable&&a.writable&&a.configurable?r[i][s]=a.value:Object.defineProperty(r[i],s,a)}return r}const ap=n=>`Stale read from <${n}>.`;function ka(n){const e="fallback"in n&&{fallback:()=>n.fallback};return at(sp(()=>n.each,n.children,e||void 0))}function cp(n){const e=Jg(()=>n.children),t=at(()=>{const r=e(),s=Array.isArray(r)?r:[r];let i=()=>{};for(let a=0;a<s.length;a++){const c=a,l=s[a],h=i,f=at(()=>h()?void 0:l.when,void 0,void 0),m=l.keyed?f:at(f,void 0,{equals:(p,I)=>!p==!I});i=()=>h()||(m()?[c,f,l]:void 0)}return i});return at(()=>{const r=t()();if(!r)return n.fallback;const[s,i,a]=r,c=a.children;return typeof c=="function"&&c.length>0?st(()=>c(a.keyed?i():()=>{if(st(t)()?.[0]!==s)throw ap("Match");return i()})):c},void 0,void 0)}function ri(n){return n}const lp=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],up=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...lp]),hp=new Set(["innerHTML","textContent","innerText","children"]),dp=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),fp=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function mp(n,e){const t=fp[n];return typeof t=="object"?t[e]?t.$:void 0:t}const gp=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),pp={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},qe=n=>at(()=>n());function _p(n,e,t){let r=t.length,s=e.length,i=r,a=0,c=0,l=e[s-1].nextSibling,h=null;for(;a<s||c<i;){if(e[a]===t[c]){a++,c++;continue}for(;e[s-1]===t[i-1];)s--,i--;if(s===a){const f=i<r?c?t[c-1].nextSibling:t[i-c]:l;for(;c<i;)n.insertBefore(t[c++],f)}else if(i===c)for(;a<s;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===t[i-1]&&t[c]===e[s-1]){const f=e[--s].nextSibling;n.insertBefore(t[c++],e[a++].nextSibling),n.insertBefore(t[--i],f),e[s]=t[i]}else{if(!h){h=new Map;let m=c;for(;m<i;)h.set(t[m],m++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<i){let m=a,p=1,I;for(;++m<s&&m<i&&!((I=h.get(e[m]))==null||I!==f+p);)p++;if(p>f-c){const P=e[a];for(;c<f;)n.insertBefore(t[c++],P)}else n.replaceChild(t[c++],e[a++])}else a++;else e[a++].remove()}}}const fu="_$DX_DELEGATE";function yp(n,e,t,r={}){let s;return ts(i=>{s=i,e===document?n():q(e,n(),e.firstChild?null:void 0,t)},r.owner),()=>{s(),e.textContent=""}}function de(n,e,t,r){let s;const i=()=>{const c=r?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=n,t?c.content.firstChild.firstChild:r?c.firstChild:c.content.firstChild},a=e?()=>st(()=>document.importNode(s||(s=i()),!0)):()=>(s||(s=i())).cloneNode(!0);return a.cloneNode=a,a}function jn(n,e=window.document){const t=e[fu]||(e[fu]=new Set);for(let r=0,s=n.length;r<s;r++){const i=n[r];t.has(i)||(t.add(i),e.addEventListener(i,Ap))}}function it(n,e,t){t==null?n.removeAttribute(e):n.setAttribute(e,t)}function wp(n,e,t,r){r==null?n.removeAttributeNS(e,t):n.setAttributeNS(e,t,r)}function vp(n,e,t){t?n.setAttribute(e,""):n.removeAttribute(e)}function Y(n,e){e==null?n.removeAttribute("class"):n.className=e}function fd(n,e,t,r){if(r)Array.isArray(t)?(n[`$$${e}`]=t[0],n[`$$${e}Data`]=t[1]):n[`$$${e}`]=t;else if(Array.isArray(t)){const s=t[0];n.addEventListener(e,t[0]=i=>s.call(n,t[1],i))}else n.addEventListener(e,t,typeof t!="function"&&t)}function Ep(n,e,t={}){const r=Object.keys(e||{}),s=Object.keys(t);let i,a;for(i=0,a=s.length;i<a;i++){const c=s[i];!c||c==="undefined"||e[c]||(mu(n,c,!1),delete t[c])}for(i=0,a=r.length;i<a;i++){const c=r[i],l=!!e[c];!c||c==="undefined"||t[c]===l||!l||(mu(n,c,!0),t[c]=l)}return t}function St(n,e,t){if(!e)return t?it(n,"style"):e;const r=n.style;if(typeof e=="string")return r.cssText=e;typeof t=="string"&&(r.cssText=t=void 0),t||(t={}),e||(e={});let s,i;for(i in t)e[i]==null&&r.removeProperty(i),delete t[i];for(i in e)s=e[i],s!==t[i]&&(r.setProperty(i,s),t[i]=s);return t}function xt(n,e={},t,r){const s={};return r||re(()=>s.children=ds(n,e.children,s.children)),re(()=>typeof e.ref=="function"&&hs(e.ref,n)),re(()=>Tp(n,e,t,!0,s,!0)),s}function hs(n,e,t){return st(()=>n(e,t))}function q(n,e,t,r){if(t!==void 0&&!r&&(r=[]),typeof e!="function")return ds(n,e,r,t);re(s=>ds(n,e(),s,t),r)}function Tp(n,e,t,r,s={},i=!1){e||(e={});for(const a in s)if(!(a in e)){if(a==="children")continue;s[a]=gu(n,a,null,s[a],t,i,e)}for(const a in e){if(a==="children")continue;const c=e[a];s[a]=gu(n,a,c,s[a],t,i,e)}}function Ip(n){return n.toLowerCase().replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function mu(n,e,t){const r=e.trim().split(/\s+/);for(let s=0,i=r.length;s<i;s++)n.classList.toggle(r[s],t)}function gu(n,e,t,r,s,i,a){let c,l,h,f,m;if(e==="style")return St(n,t,r);if(e==="classList")return Ep(n,t,r);if(t===r)return r;if(e==="ref")i||t(n);else if(e.slice(0,3)==="on:"){const p=e.slice(3);r&&n.removeEventListener(p,r,typeof r!="function"&&r),t&&n.addEventListener(p,t,typeof t!="function"&&t)}else if(e.slice(0,10)==="oncapture:"){const p=e.slice(10);r&&n.removeEventListener(p,r,!0),t&&n.addEventListener(p,t,!0)}else if(e.slice(0,2)==="on"){const p=e.slice(2).toLowerCase(),I=gp.has(p);if(!I&&r){const P=Array.isArray(r)?r[0]:r;n.removeEventListener(p,P)}(I||t)&&(fd(n,p,t,I),I&&jn([p]))}else if(e.slice(0,5)==="attr:")it(n,e.slice(5),t);else if(e.slice(0,5)==="bool:")vp(n,e.slice(5),t);else if((m=e.slice(0,5)==="prop:")||(h=hp.has(e))||!s&&((f=mp(e,n.tagName))||(l=up.has(e)))||(c=n.nodeName.includes("-")||"is"in a))m&&(e=e.slice(5),l=!0),e==="class"||e==="className"?Y(n,t):c&&!l&&!h?n[Ip(e)]=t:n[f||e]=t;else{const p=s&&e.indexOf(":")>-1&&pp[e.split(":")[0]];p?wp(n,p,e,t):it(n,dp[e]||e,t)}return t}function Ap(n){let e=n.target;const t=`$$${n.type}`,r=n.target,s=n.currentTarget,i=l=>Object.defineProperty(n,"target",{configurable:!0,value:l}),a=()=>{const l=e[t];if(l&&!e.disabled){const h=e[`${t}Data`];if(h!==void 0?l.call(e,h,n):l.call(e,n),n.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(n.target)&&i(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),n.composedPath){const l=n.composedPath();i(l[0]);for(let h=0;h<l.length-2&&(e=l[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===s)break}}else c();i(r)}function ds(n,e,t,r,s){for(;typeof t=="function";)t=t();if(e===t)return t;const i=typeof e,a=r!==void 0;if(n=a&&t[0]&&t[0].parentNode||n,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===t))return t;if(a){let c=t[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),t=Kn(n,t,r,c)}else t!==""&&typeof t=="string"?t=n.firstChild.data=e:t=n.textContent=e}else if(e==null||i==="boolean")t=Kn(n,t,r);else{if(i==="function")return re(()=>{let c=e();for(;typeof c=="function";)c=c();t=ds(n,c,t,r)}),()=>t;if(Array.isArray(e)){const c=[],l=t&&Array.isArray(t);if(Va(c,e,t,s))return re(()=>t=ds(n,c,t,r,!0)),()=>t;if(c.length===0){if(t=Kn(n,t,r),a)return t}else l?t.length===0?pu(n,c,r):_p(n,t,c):(t&&Kn(n),pu(n,c));t=c}else if(e.nodeType){if(Array.isArray(t)){if(a)return t=Kn(n,t,r,e);Kn(n,t,null,e)}else t==null||t===""||!n.firstChild?n.appendChild(e):n.replaceChild(e,n.firstChild);t=e}}return t}function Va(n,e,t,r){let s=!1;for(let i=0,a=e.length;i<a;i++){let c=e[i],l=t&&t[n.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)n.push(c);else if(Array.isArray(c))s=Va(n,c,l)||s;else if(h==="function")if(r){for(;typeof c=="function";)c=c();s=Va(n,Array.isArray(c)?c:[c],Array.isArray(l)?l:[l])||s}else n.push(c),s=!0;else{const f=String(c);l&&l.nodeType===3&&l.data===f?n.push(l):n.push(document.createTextNode(f))}}return s}function pu(n,e,t=null){for(let r=0,s=e.length;r<s;r++)n.insertBefore(e[r],t)}function Kn(n,e,t,r){if(t===void 0)return n.textContent="";const s=r||document.createTextNode("");if(e.length){let i=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(s!==c){const l=c.parentNode===n;!i&&!a?l?n.replaceChild(s,c):n.insertBefore(s,t):l&&c.remove()}else i=!0}}else n.insertBefore(s,t);return[s]}const bp=!1;function Sp(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function Rp(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Pp=(function(){function n(t){var r=this;this._insertTag=function(s){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,i),r.tags.push(s)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Rp(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var i=Sp(s);try{i.insertRule(r,i.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var s;return(s=r.parentNode)==null?void 0:s.removeChild(r)}),this.tags=[],this.ctr=0},n})(),xe="-ms-",Di="-moz-",se="-webkit-",md="comm",hc="rule",dc="decl",Cp="@import",gd="@keyframes",kp="@layer",Vp=Math.abs,co=String.fromCharCode,Dp=Object.assign;function Np(n,e){return Ne(n,0)^45?(((e<<2^Ne(n,0))<<2^Ne(n,1))<<2^Ne(n,2))<<2^Ne(n,3):0}function pd(n){return n.trim()}function Op(n,e){return(n=e.exec(n))?n[0]:n}function ie(n,e,t){return n.replace(e,t)}function Da(n,e){return n.indexOf(e)}function Ne(n,e){return n.charCodeAt(e)|0}function fs(n,e,t){return n.slice(e,t)}function yt(n){return n.length}function fc(n){return n.length}function si(n,e){return e.push(n),n}function Mp(n,e){return n.map(e).join("")}var lo=1,hr=1,_d=0,Ke=0,Ee=0,Sr="";function uo(n,e,t,r,s,i,a){return{value:n,root:e,parent:t,type:r,props:s,children:i,line:lo,column:hr,length:a,return:""}}function Xr(n,e){return Dp(uo("",null,null,"",null,null,0),n,{length:-n.length},e)}function xp(){return Ee}function Lp(){return Ee=Ke>0?Ne(Sr,--Ke):0,hr--,Ee===10&&(hr=1,lo--),Ee}function et(){return Ee=Ke<_d?Ne(Sr,Ke++):0,hr++,Ee===10&&(hr=1,lo++),Ee}function vt(){return Ne(Sr,Ke)}function pi(){return Ke}function bs(n,e){return fs(Sr,n,e)}function ms(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function yd(n){return lo=hr=1,_d=yt(Sr=n),Ke=0,[]}function wd(n){return Sr="",n}function _i(n){return pd(bs(Ke-1,Na(n===91?n+2:n===40?n+1:n)))}function Up(n){for(;(Ee=vt())&&Ee<33;)et();return ms(n)>2||ms(Ee)>3?"":" "}function Fp(n,e){for(;--e&&et()&&!(Ee<48||Ee>102||Ee>57&&Ee<65||Ee>70&&Ee<97););return bs(n,pi()+(e<6&&vt()==32&&et()==32))}function Na(n){for(;et();)switch(Ee){case n:return Ke;case 34:case 39:n!==34&&n!==39&&Na(Ee);break;case 40:n===41&&Na(n);break;case 92:et();break}return Ke}function $p(n,e){for(;et()&&n+Ee!==57;)if(n+Ee===84&&vt()===47)break;return"/*"+bs(e,Ke-1)+"*"+co(n===47?n:et())}function Bp(n){for(;!ms(vt());)et();return bs(n,Ke)}function jp(n){return wd(yi("",null,null,null,[""],n=yd(n),0,[0],n))}function yi(n,e,t,r,s,i,a,c,l){for(var h=0,f=0,m=a,p=0,I=0,P=0,C=1,R=1,N=1,V=0,O="",$=s,U=i,B=r,E=O;R;)switch(P=V,V=et()){case 40:if(P!=108&&Ne(E,m-1)==58){Da(E+=ie(_i(V),"&","&\f"),"&\f")!=-1&&(N=-1);break}case 34:case 39:case 91:E+=_i(V);break;case 9:case 10:case 13:case 32:E+=Up(P);break;case 92:E+=Fp(pi()-1,7);continue;case 47:switch(vt()){case 42:case 47:si(zp($p(et(),pi()),e,t),l);break;default:E+="/"}break;case 123*C:c[h++]=yt(E)*N;case 125*C:case 59:case 0:switch(V){case 0:case 125:R=0;case 59+f:N==-1&&(E=ie(E,/\f/g,"")),I>0&&yt(E)-m&&si(I>32?yu(E+";",r,t,m-1):yu(ie(E," ","")+";",r,t,m-2),l);break;case 59:E+=";";default:if(si(B=_u(E,e,t,h,f,s,c,O,$=[],U=[],m),i),V===123)if(f===0)yi(E,e,B,B,$,i,m,c,U);else switch(p===99&&Ne(E,3)===110?100:p){case 100:case 108:case 109:case 115:yi(n,B,B,r&&si(_u(n,B,B,0,0,s,c,O,s,$=[],m),U),s,U,m,c,r?$:U);break;default:yi(E,B,B,B,[""],U,0,c,U)}}h=f=I=0,C=N=1,O=E="",m=a;break;case 58:m=1+yt(E),I=P;default:if(C<1){if(V==123)--C;else if(V==125&&C++==0&&Lp()==125)continue}switch(E+=co(V),V*C){case 38:N=f>0?1:(E+="\f",-1);break;case 44:c[h++]=(yt(E)-1)*N,N=1;break;case 64:vt()===45&&(E+=_i(et())),p=vt(),f=m=yt(O=E+=Bp(pi())),V++;break;case 45:P===45&&yt(E)==2&&(C=0)}}return i}function _u(n,e,t,r,s,i,a,c,l,h,f){for(var m=s-1,p=s===0?i:[""],I=fc(p),P=0,C=0,R=0;P<r;++P)for(var N=0,V=fs(n,m+1,m=Vp(C=a[P])),O=n;N<I;++N)(O=pd(C>0?p[N]+" "+V:ie(V,/&\f/g,p[N])))&&(l[R++]=O);return uo(n,e,t,s===0?hc:c,l,h,f)}function zp(n,e,t){return uo(n,e,t,md,co(xp()),fs(n,2,-2),0)}function yu(n,e,t,r){return uo(n,e,t,dc,fs(n,0,r),fs(n,r+1,-1),r)}function rr(n,e){for(var t="",r=fc(n),s=0;s<r;s++)t+=e(n[s],s,n,e)||"";return t}function qp(n,e,t,r){switch(n.type){case kp:if(n.children.length)break;case Cp:case dc:return n.return=n.return||n.value;case md:return"";case gd:return n.return=n.value+"{"+rr(n.children,r)+"}";case hc:n.value=n.props.join(",")}return yt(t=rr(n.children,r))?n.return=n.value+"{"+t+"}":""}function Hp(n){var e=fc(n);return function(t,r,s,i){for(var a="",c=0;c<e;c++)a+=n[c](t,r,s,i)||"";return a}}function Gp(n){return function(e){e.root||(e=e.return)&&n(e)}}function Wp(n){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=n(t)),e[t]}}var Kp=function(e,t,r){for(var s=0,i=0;s=i,i=vt(),s===38&&i===12&&(t[r]=1),!ms(i);)et();return bs(e,Ke)},Qp=function(e,t){var r=-1,s=44;do switch(ms(s)){case 0:s===38&&vt()===12&&(t[r]=1),e[r]+=Kp(Ke-1,t,r);break;case 2:e[r]+=_i(s);break;case 4:if(s===44){e[++r]=vt()===58?"&\f":"",t[r]=e[r].length;break}default:e[r]+=co(s)}while(s=et());return e},Xp=function(e,t){return wd(Qp(yd(e),t))},wu=new WeakMap,Yp=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!wu.get(r))&&!s){wu.set(e,!0);for(var i=[],a=Xp(t,i),c=r.props,l=0,h=0;l<a.length;l++)for(var f=0;f<c.length;f++,h++)e.props[h]=i[l]?a[l].replace(/&\f/g,c[f]):c[f]+" "+a[l]}}},Jp=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function vd(n,e){switch(Np(n,e)){case 5103:return se+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return se+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return se+n+Di+n+xe+n+n;case 6828:case 4268:return se+n+xe+n+n;case 6165:return se+n+xe+"flex-"+n+n;case 5187:return se+n+ie(n,/(\w+).+(:[^]+)/,se+"box-$1$2"+xe+"flex-$1$2")+n;case 5443:return se+n+xe+"flex-item-"+ie(n,/flex-|-self/,"")+n;case 4675:return se+n+xe+"flex-line-pack"+ie(n,/align-content|flex-|-self/,"")+n;case 5548:return se+n+xe+ie(n,"shrink","negative")+n;case 5292:return se+n+xe+ie(n,"basis","preferred-size")+n;case 6060:return se+"box-"+ie(n,"-grow","")+se+n+xe+ie(n,"grow","positive")+n;case 4554:return se+ie(n,/([^-])(transform)/g,"$1"+se+"$2")+n;case 6187:return ie(ie(ie(n,/(zoom-|grab)/,se+"$1"),/(image-set)/,se+"$1"),n,"")+n;case 5495:case 3959:return ie(n,/(image-set\([^]*)/,se+"$1$`$1");case 4968:return ie(ie(n,/(.+:)(flex-)?(.*)/,se+"box-pack:$3"+xe+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+se+n+n;case 4095:case 3583:case 4068:case 2532:return ie(n,/(.+)-inline(.+)/,se+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(yt(n)-1-e>6)switch(Ne(n,e+1)){case 109:if(Ne(n,e+4)!==45)break;case 102:return ie(n,/(.+:)(.+)-([^]+)/,"$1"+se+"$2-$3$1"+Di+(Ne(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~Da(n,"stretch")?vd(ie(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(Ne(n,e+1)!==115)break;case 6444:switch(Ne(n,yt(n)-3-(~Da(n,"!important")&&10))){case 107:return ie(n,":",":"+se)+n;case 101:return ie(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+se+(Ne(n,14)===45?"inline-":"")+"box$3$1"+se+"$2$3$1"+xe+"$2box$3")+n}break;case 5936:switch(Ne(n,e+11)){case 114:return se+n+xe+ie(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return se+n+xe+ie(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return se+n+xe+ie(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return se+n+xe+n+n}return n}var Zp=function(e,t,r,s){if(e.length>-1&&!e.return)switch(e.type){case dc:e.return=vd(e.value,e.length);break;case gd:return rr([Xr(e,{value:ie(e.value,"@","@"+se)})],s);case hc:if(e.length)return Mp(e.props,function(i){switch(Op(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return rr([Xr(e,{props:[ie(i,/:(read-\w+)/,":"+Di+"$1")]})],s);case"::placeholder":return rr([Xr(e,{props:[ie(i,/:(plac\w+)/,":"+se+"input-$1")]}),Xr(e,{props:[ie(i,/:(plac\w+)/,":"+Di+"$1")]}),Xr(e,{props:[ie(i,/:(plac\w+)/,xe+"input-$1")]})],s)}return""})}},e_=[Zp],t_=function(e){var t=e.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(C){var R=C.getAttribute("data-emotion");R.indexOf(" ")!==-1&&(document.head.appendChild(C),C.setAttribute("data-s",""))})}var s=e.stylisPlugins||e_,i={},a,c=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(C){for(var R=C.getAttribute("data-emotion").split(" "),N=1;N<R.length;N++)i[R[N]]=!0;c.push(C)});var l,h=[Yp,Jp];{var f,m=[qp,Gp(function(C){f.insert(C)})],p=Hp(h.concat(s,m)),I=function(R){return rr(jp(R),p)};l=function(R,N,V,O){f=V,I(R?R+"{"+N.styles+"}":N.styles),O&&(P.inserted[N.name]=!0)}}var P={key:t,sheet:new Pp({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:l};return P.sheet.hydrate(c),P};function n_(n){for(var e=0,t,r=0,s=n.length;s>=4;++r,s-=4)t=n.charCodeAt(r)&255|(n.charCodeAt(++r)&255)<<8|(n.charCodeAt(++r)&255)<<16|(n.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(r+2)&255)<<16;case 2:e^=(n.charCodeAt(r+1)&255)<<8;case 1:e^=n.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var r_={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},s_=/[A-Z]|^ms/g,i_=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ed=function(e){return e.charCodeAt(1)===45},vu=function(e){return e!=null&&typeof e!="boolean"},la=Wp(function(n){return Ed(n)?n:n.replace(s_,"-$&").toLowerCase()}),Eu=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(i_,function(r,s,i){return rn={name:s,styles:i,next:rn},s})}return r_[e]!==1&&!Ed(e)&&typeof t=="number"&&t!==0?t+"px":t};function Ni(n,e,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var s=t;if(s.anim===1)return rn={name:s.name,styles:s.styles,next:rn},s.name;var i=t;if(i.styles!==void 0){var a=i.next;if(a!==void 0)for(;a!==void 0;)rn={name:a.name,styles:a.styles,next:rn},a=a.next;var c=i.styles+";";return c}return o_(n,e,t)}}var l=t;if(e==null)return l;var h=e[l];return h!==void 0?h:l}function o_(n,e,t){var r="";if(Array.isArray(t))for(var s=0;s<t.length;s++)r+=Ni(n,e,t[s])+";";else for(var i in t){var a=t[i];if(typeof a!="object"){var c=a;e!=null&&e[c]!==void 0?r+=i+"{"+e[c]+"}":vu(c)&&(r+=la(i)+":"+Eu(i,c)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var l=0;l<a.length;l++)vu(a[l])&&(r+=la(i)+":"+Eu(i,a[l])+";");else{var h=Ni(n,e,a);switch(i){case"animation":case"animationName":{r+=la(i)+":"+h+";";break}default:r+=i+"{"+h+"}"}}}return r}var Tu=/label:\s*([^\s;{]+)\s*(;|$)/g,rn;function ua(n,e,t){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var r=!0,s="";rn=void 0;var i=n[0];if(i==null||i.raw===void 0)r=!1,s+=Ni(t,e,i);else{var a=i;s+=a[0]}for(var c=1;c<n.length;c++)if(s+=Ni(t,e,n[c]),r){var l=i;s+=l[c]}Tu.lastIndex=0;for(var h="",f;(f=Tu.exec(s))!==null;)h+="-"+f[1];var m=n_(s)+h;return{name:m,styles:s,next:rn}}function Td(n,e,t){var r="";return t.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):s&&(r+=s+" ")}),r}var a_=function(e,t,r){var s=e.key+"-"+t.name;e.registered[s]===void 0&&(e.registered[s]=t.styles)},c_=function(e,t,r){a_(e,t);var s=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var i=t;do e.insert(t===i?"."+s:"",i,e.sheet,!0),i=i.next;while(i!==void 0)}};function Iu(n,e){if(n.inserted[e.name]===void 0)return n.insert("",e,n.sheet,!0)}function Au(n,e,t){var r=[],s=Td(n,r,t);return r.length<2?t:s+e(r)}var l_=function(e){var t=t_(e);t.sheet.speedy=function(c){this.isSpeedy=c},t.compat=!0;var r=function(){for(var l=arguments.length,h=new Array(l),f=0;f<l;f++)h[f]=arguments[f];var m=ua(h,t.registered,void 0);return c_(t,m),t.key+"-"+m.name},s=function(){for(var l=arguments.length,h=new Array(l),f=0;f<l;f++)h[f]=arguments[f];var m=ua(h,t.registered),p="animation-"+m.name;return Iu(t,{name:m.name,styles:"@keyframes "+p+"{"+m.styles+"}"}),p},i=function(){for(var l=arguments.length,h=new Array(l),f=0;f<l;f++)h[f]=arguments[f];var m=ua(h,t.registered);Iu(t,m)},a=function(){for(var l=arguments.length,h=new Array(l),f=0;f<l;f++)h[f]=arguments[f];return Au(t.registered,r,u_(h))};return{css:r,cx:a,injectGlobal:i,keyframes:s,hydrate:function(l){l.forEach(function(h){t.inserted[h]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Td.bind(null,t.registered),merge:Au.bind(null,t.registered,r)}},u_=function n(e){for(var t="",r=0;r<e.length;r++){var s=e[r];if(s!=null){var i=void 0;switch(typeof s){case"boolean":break;case"object":{if(Array.isArray(s))i=n(s);else{i="";for(var a in s)s[a]&&a&&(i&&(i+=" "),i+=a)}break}default:i=s}i&&(t&&(t+=" "),t+=i)}}return t},h_=l_({key:"css"}),Q=h_.css,d_=de("<svg stroke-width=0>");function Qe(n,e){const t=Ct(n.a,e),[r,s]=op(t,["src"]),[i,a]=Se(""),c=at(()=>e.title?`${n.c}<title>${e.title}</title>`:n.c);return Mt(()=>a(c())),Ar(()=>{a("")}),(()=>{var l=d_();return xt(l,Ct({get stroke(){return n.a?.stroke},get color(){return e.color||"currentColor"},get fill(){return e.color||"currentColor"},get style(){return{...e.style,overflow:"visible"}}},s,{get height(){return e.size||"1em"},get width(){return e.size||"1em"},xmlns:"http://www.w3.org/2000/svg",get innerHTML(){return i()}}),!0,!0),q(l,()=>bp),l})()}function Id(n){return Qe({a:{fill:"none",viewBox:"0 0 24 24"},c:'<path fill="currentColor" d="M12 22c5.523 0 10-4.477 10-10h-3a7 7 0 0 1-7 7v3ZM2 12C2 6.477 6.477 2 12 2v3a7 7 0 0 0-7 7H2Z"/>'},n)}function f_(n){return Qe({a:{viewBox:"0 0 496 512"},c:'<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>'},n)}function m_(n){return Qe({a:{viewBox:"0 0 320 512"},c:'<path d="M2 334.5c-3.8 8.8-2 19 4.6 26l136 144c4.5 4.8 10.8 7.5 17.4 7.5s12.9-2.7 17.4-7.5l136-144c6.6-7 8.4-17.2 4.6-26S305.5 320 296 320h-72V32c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v288H24c-9.6 0-18.2 5.7-22 14.5z"/>'},n)}function g_(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<path d="M334.5 414c8.8 3.8 19 2 26-4.6l144-136c4.8-4.5 7.5-10.8 7.5-17.4s-2.7-12.9-7.5-17.4l-144-136c-7-6.6-17.2-8.4-26-4.6S320 110.5 320 120v72H32c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32h288v72c0 9.6 5.7 18.2 14.5 22z"/>'},n)}function Ad(n){return Qe({a:{viewBox:"0 0 640 512"},c:'<path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/>'},n)}function p_(n){return Qe({a:{viewBox:"0 0 576 512"},c:'<path d="M192 32c0-17.7 14.3-32 32-32h128c17.7 0 32 14.3 32 32v32h48c26.5 0 48 21.5 48 48v128l44.4 14.8c23.1 7.7 29.5 37.5 11.5 53.9l-101 92.6c-16.2 9.4-34.7 15.1-50.9 15.1-19.6 0-40.8-7.7-59.2-20.3-22.1-15.5-51.6-15.5-73.7 0-17.1 11.8-38 20.3-59.2 20.3-16.2 0-34.7-5.7-50.9-15.1L40 308.7c-18-16.5-11.6-46.2 11.5-53.9L96 240V112c0-26.5 21.5-48 48-48h48V32zm-32 186.7 107.8-35.9c13.1-4.4 27.3-4.4 40.5 0L416 218.7V128H160v90.7zm146.5 203.2c22.5 15.5 50 26.1 77.5 26.1 26.9 0 55.4-10.8 77.4-26.1 11.9-8.5 28.1-7.8 39.2 1.7 14.4 11.9 32.5 21 50.6 25.2 17.2 4 27.9 21.2 23.9 38.4s-21.2 27.9-38.4 23.9c-24.5-5.7-44.9-16.5-58.2-25-29 15.6-61.5 25.9-94.5 25.9-31.9 0-60.6-9.9-80.4-18.9-5.8-2.7-11.1-5.3-15.6-7.7-4.5 2.4-9.7 5.1-15.6 7.7-19.8 9-48.5 18.9-80.4 18.9-33 0-65.5-10.3-94.5-25.8-13.4 8.4-33.7 19.3-58.2 25-17.2 4-34.4-6.7-38.4-23.9s6.7-34.4 23.9-38.4c18.1-4.2 36.2-13.3 50.6-25.2 11.1-9.4 27.3-10.1 39.2-1.7 22.1 15.2 50.5 26 77.4 26 27.5 0 55-10.6 77.5-26.1 11.1-7.9 25.9-7.9 37 0z"/>'},n)}function __(n){return Qe({a:{viewBox:"0 0 640 512"},c:'<path d="M96 128a128 128 0 1 1 256 0 128 128 0 1 1-256 0zM0 482.3C0 383.8 79.8 304 178.3 304h91.4c98.5 0 178.3 79.8 178.3 178.3 0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3zM609.3 512H471.4c5.4-9.4 8.6-20.3 8.6-32v-8c0-60.7-27.1-115.2-69.8-151.8 2.4-.1 4.7-.2 7.1-.2h61.4c89.1 0 161.3 72.2 161.3 161.3 0 17-13.8 30.7-30.7 30.7zM432 256c-31 0-59-12.6-79.3-32.9 19.7-26.6 31.3-59.5 31.3-95.1 0-26.8-6.6-52.1-18.3-74.3C384.3 40.1 407.2 32 432 32c61.9 0 112 50.1 112 112s-50.1 112-112 112z"/>'},n)}function Oa(n){return Qe({a:{viewBox:"0 0 448 512"},c:'<path d="M224 256a128 128 0 1 0 0-256 128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3 0 498.7 13.3 512 29.7 512h388.6c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3h-91.4z"/>'},n)}function bd(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<path fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10" stroke-width="48" d="M328 112 184 256 328 400"/>'},n)}function y_(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<path d="M440.88 129.37 288.16 40.62a64.14 64.14 0 0 0-64.33 0L71.12 129.37a4 4 0 0 0 0 6.9L254 243.85a4 4 0 0 0 4.06 0L440.9 136.27a4 4 0 0 0-.02-6.9ZM256 152c-13.25 0-24-7.16-24-16s10.75-16 24-16 24 7.16 24 16-10.75 16-24 16ZM238 270.81 54 163.48a4 4 0 0 0-6 3.46v173.92a48 48 0 0 0 23.84 41.39L234 479.48a4 4 0 0 0 6-3.46V274.27a4 4 0 0 0-2-3.46ZM96 368c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24Zm96-32c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24ZM458 163.51 274 271.56a4 4 0 0 0-2 3.45V476a4 4 0 0 0 6 3.46l162.15-97.23A48 48 0 0 0 464 340.86V167a4 4 0 0 0-6-3.49ZM320 424c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24Zm0-88c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24Zm96 32c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24Zm0-88c-8.84 0-16-10.75-16-24s7.16-24 16-24 16 10.75 16 24-7.16 24-16 24Z"/>'},n)}function w_(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<rect width="448" height="80" x="32" y="48" rx="32" ry="32"/><path d="M74.45 160a8 8 0 0 0-8 8.83l26.31 252.56a1.5 1.5 0 0 0 0 .22A48 48 0 0 0 140.45 464h231.09a48 48 0 0 0 47.67-42.39v-.21l26.27-252.57a8 8 0 0 0-8-8.83Zm248.86 180.69a16 16 0 1 1-22.63 22.62L256 318.63l-44.69 44.68a16 16 0 0 1-22.63-22.62L233.37 296l-44.69-44.69a16 16 0 0 1 22.63-22.62L256 273.37l44.68-44.68a16 16 0 0 1 22.63 22.62L278.62 296Z"/>'},n)}function v_(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<path fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10" stroke-width="32" d="M320 320c9.74-19.38 16-40.84 16-64 0-23.48-6-44.42-16-64M368 368c19.48-33.92 32-64.06 32-112s-12-77.74-32-112M416 416c30-46 48-91.43 48-160s-18-113-48-160"/><path d="M125.65 176.1 32 176.1 32 335.9 125.65 335.9 256 440 256 72 125.65 176.1z"/>'},n)}function E_(n){return Qe({a:{viewBox:"0 0 512 512"},c:'<path fill="none" stroke="currentColor" stroke-linecap="square" stroke-miterlimit="10" stroke-width="32" d="M416 432 64 80"/><path d="M352 256c0-24.56-5.81-47.88-17.75-71.27L327 170.47 298.48 185l7.27 14.25C315.34 218.06 320 236.62 320 256a112.91 112.91 0 0 1-.63 11.74l27.32 27.32A148.8 148.8 0 0 0 352 256ZM416 256c0-51.19-13.08-83.89-34.18-120.06l-8.06-13.82-27.64 16.12 8.06 13.82C373.07 184.44 384 211.83 384 256c0 25.93-3.89 46.21-11 65.33l24.5 24.51C409.19 319.68 416 292.42 416 256Z"/><path d="M480 256c0-74.26-20.19-121.11-50.51-168.61l-8.61-13.49-27 17.22 8.61 13.49C429.82 147.38 448 189.5 448 256c0 48.76-9.4 84-24.82 115.55l23.7 23.7C470.16 351.39 480 309 480 256Z"/><path d="M256 72 182.4 130.78 256 204.37 256 72z"/><path d="M32 176.1 32 335.9 125.65 335.9 256 440 256 339.63 92.47 176.1 32 176.1z"/>'},n)}function ha(n){return Qe({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-target-arrow",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/><path d="M12 7a5 5 0 1 0 5 5"/><path d="M13 3.055a9 9 0 1 0 7.941 7.945"/><path d="M15 6v3h3l3 -3h-3v-3z"/><path d="M15 9l-3 3"/>'},n)}const x={primary:"#60a5fa",secondary:"#f8fafc",ship:"#334155",hover:"#cbd5e1",grid:"#1e293b",emptyHit:"#10b981",shipHit:"#f59e0b",shipSunk:"#f43f5e",outOfBounds:"#fda4af"},ae={sm:"@media (min-width: 40rem)",md:"@media (min-width: 48rem)",lg:"@media (min-width: 64rem)",mouse:"@media (hover: hover)"},Qn={connecting:"Connecting to matchmaking...",waitingToJoin:"Waiting for opponent to join...",waitingForSetup:"Waiting for opponent to setup...",ready:"Both players ready! Starting game..."};var T_=de('<footer>Â© 2023 - 2025<a title=Source target=_blank type=text/html rel="noreferrer external author"href=https://github.com/eldarlrd/ts-battleship> eldarlrd');const I_=()=>(()=>{var n=T_(),e=n.firstChild,t=e.nextSibling,r=t.firstChild;return q(t,z(f_,{}),r),re(s=>{var i=Q`
      display: flex;
      flex-direction: column;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      margin: 1rem;
      gap: 0.5rem;
    `,a=Q`
        border-radius: 0.125rem;
        text-decoration: none;
        color: inherit;
        transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);

        &:active {
          color: ${x.grid};
        }

        ${ae.mouse} {
          &:hover {
            color: ${x.grid};
          }
        }

        svg {
          vertical-align: top;
        }
      `;return i!==s.e&&Y(n,s.e=i),a!==s.t&&Y(t,s.t=a),s},{e:void 0,t:void 0}),n})();var A_=de("<header>TS Battleship");const b_=()=>(()=>{var n=A_();return re(()=>Y(n,Q`
      font-size: 2.5rem;
      font-weight: 600;
      margin: 1rem;
    `)),n})(),S_=n=>typeof n=="function",Oi=(n,e)=>S_(n)?n(e):n;var ve;(function(n){n[n.ADD_TOAST=0]="ADD_TOAST",n[n.UPDATE_TOAST=1]="UPDATE_TOAST",n[n.UPSERT_TOAST=2]="UPSERT_TOAST",n[n.DISMISS_TOAST=3]="DISMISS_TOAST",n[n.REMOVE_TOAST=4]="REMOVE_TOAST",n[n.START_PAUSE=5]="START_PAUSE",n[n.END_PAUSE=6]="END_PAUSE"})(ve||(ve={}));const Mi=Symbol("store-raw"),sr=Symbol("store-node"),Rt=Symbol("store-has"),Sd=Symbol("store-self");function Rd(n){let e=n[dt];if(!e&&(Object.defineProperty(n,dt,{value:e=new Proxy(n,C_)}),!Array.isArray(n))){const t=Object.keys(n),r=Object.getOwnPropertyDescriptors(n);for(let s=0,i=t.length;s<i;s++){const a=t[s];r[a].get&&Object.defineProperty(n,a,{enumerable:r[a].enumerable,get:r[a].get.bind(e)})}}return e}function dr(n){let e;return n!=null&&typeof n=="object"&&(n[dt]||!(e=Object.getPrototypeOf(n))||e===Object.prototype||Array.isArray(n))}function fr(n,e=new Set){let t,r,s,i;if(t=n!=null&&n[Mi])return t;if(!dr(n)||e.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):e.add(n);for(let a=0,c=n.length;a<c;a++)s=n[a],(r=fr(s,e))!==s&&(n[a]=r)}else{Object.isFrozen(n)?n=Object.assign({},n):e.add(n);const a=Object.keys(n),c=Object.getOwnPropertyDescriptors(n);for(let l=0,h=a.length;l<h;l++)i=a[l],!c[i].get&&(s=n[i],(r=fr(s,e))!==s&&(n[i]=r))}return n}function xi(n,e){let t=n[e];return t||Object.defineProperty(n,e,{value:t=Object.create(null)}),t}function gs(n,e,t){if(n[e])return n[e];const[r,s]=Se(t,{equals:!1,internal:!0});return r.$=s,n[e]=r}function R_(n,e){const t=Reflect.getOwnPropertyDescriptor(n,e);return!t||t.get||!t.configurable||e===dt||e===sr||(delete t.value,delete t.writable,t.get=()=>n[dt][e]),t}function Pd(n){Ra()&&gs(xi(n,sr),Sd)()}function P_(n){return Pd(n),Reflect.ownKeys(n)}const C_={get(n,e,t){if(e===Mi)return n;if(e===dt)return t;if(e===Sa)return Pd(n),t;const r=xi(n,sr),s=r[e];let i=s?s():n[e];if(e===sr||e===Rt||e==="__proto__")return i;if(!s){const a=Object.getOwnPropertyDescriptor(n,e);Ra()&&(typeof i!="function"||n.hasOwnProperty(e))&&!(a&&a.get)&&(i=gs(r,e,i)())}return dr(i)?Rd(i):i},has(n,e){return e===Mi||e===dt||e===Sa||e===sr||e===Rt||e==="__proto__"?!0:(Ra()&&gs(xi(n,Rt),e)(),e in n)},set(){return!0},deleteProperty(){return!0},ownKeys:P_,getOwnPropertyDescriptor:R_};function mr(n,e,t,r=!1){if(!r&&n[e]===t)return;const s=n[e],i=n.length;t===void 0?(delete n[e],n[Rt]&&n[Rt][e]&&s!==void 0&&n[Rt][e].$()):(n[e]=t,n[Rt]&&n[Rt][e]&&s===void 0&&n[Rt][e].$());let a=xi(n,sr),c;if((c=gs(a,e,s))&&c.$(()=>t),Array.isArray(n)&&n.length!==i){for(let l=n.length;l<i;l++)(c=a[l])&&c.$();(c=gs(a,"length",i))&&c.$(n.length)}(c=a[Sd])&&c.$()}function Cd(n,e){const t=Object.keys(e);for(let r=0;r<t.length;r+=1){const s=t[r];mr(n,s,e[s])}}function k_(n,e){if(typeof e=="function"&&(e=e(n)),e=fr(e),Array.isArray(e)){if(n===e)return;let t=0,r=e.length;for(;t<r;t++){const s=e[t];n[t]!==s&&mr(n,t,s)}mr(n,"length",r)}else Cd(n,e)}function Yr(n,e,t=[]){let r,s=n;if(e.length>1){r=e.shift();const a=typeof r,c=Array.isArray(n);if(Array.isArray(r)){for(let l=0;l<r.length;l++)Yr(n,[r[l]].concat(e),t);return}else if(c&&a==="function"){for(let l=0;l<n.length;l++)r(n[l],l)&&Yr(n,[l].concat(e),t);return}else if(c&&a==="object"){const{from:l=0,to:h=n.length-1,by:f=1}=r;for(let m=l;m<=h;m+=f)Yr(n,[m].concat(e),t);return}else if(e.length>1){Yr(n[r],e,[r].concat(t));return}s=n[r],t=[r].concat(t)}let i=e[0];typeof i=="function"&&(i=i(s,t),i===s)||r===void 0&&i==null||(i=fr(i),r===void 0||dr(s)&&dr(i)&&!Array.isArray(i)?Cd(s,i):mr(n,r,i))}function V_(...[n,e]){const t=fr(n||{}),r=Array.isArray(t),s=Rd(t);function i(...a){Yg(()=>{r&&a.length===1?k_(t,a[0]):Yr(t,a)})}return[s,i]}const Li=new WeakMap,kd={get(n,e){if(e===Mi)return n;const t=n[e];let r;return dr(t)?Li.get(t)||(Li.set(t,r=new Proxy(t,kd)),r):t},set(n,e,t){return mr(n,e,fr(t)),!0},deleteProperty(n,e){return mr(n,e,void 0,!0),!0}};function ii(n){return e=>{if(dr(e)){let t;(t=Li.get(e))||Li.set(e,t=new Proxy(e,kd)),n(t)}return e}}const[Mn,Yt]=V_({toasts:[],pausedAt:void 0}),D_=()=>{const{pausedAt:n,toasts:e}=Mn;if(n)return;const t=Date.now();return e.map(s=>{if(s.duration===1/0)return;const i=(s.duration||0)+s.pauseDuration-(t-s.createdAt);if(i<=0){s.visible&&ft({type:ve.DISMISS_TOAST,toastId:s.id});return}return setTimeout(()=>{ft({type:ve.DISMISS_TOAST,toastId:s.id})},i)})},ns=new Map,bu=(n,e)=>{if(ns.has(n))return;const t=setTimeout(()=>{ns.delete(n),ft({type:ve.REMOVE_TOAST,toastId:n})},e);ns.set(n,t)},N_=n=>{const e=ns.get(n);ns.delete(n),e&&clearTimeout(e)},ft=n=>{switch(n.type){case ve.ADD_TOAST:Yt("toasts",s=>{const i=s;return[n.toast,...i]});break;case ve.DISMISS_TOAST:const{toastId:e}=n,t=Mn.toasts;if(e){const s=t.find(i=>i.id===e);s&&bu(e,s.unmountDelay),Yt("toasts",i=>i.id===e,ii(i=>i.visible=!1))}else t.forEach(s=>{bu(s.id,s.unmountDelay)}),Yt("toasts",s=>s.id!==void 0,ii(s=>s.visible=!1));break;case ve.REMOVE_TOAST:if(!n.toastId){Yt("toasts",[]);break}Yt("toasts",s=>s.filter(a=>a.id!==n.toastId));break;case ve.UPDATE_TOAST:n.toast.id&&N_(n.toast.id),Yt("toasts",s=>s.id===n.toast.id,s=>({...s,...n.toast}));break;case ve.UPSERT_TOAST:Mn.toasts.find(s=>s.id===n.toast.id)?ft({type:ve.UPDATE_TOAST,toast:n.toast}):ft({type:ve.ADD_TOAST,toast:n.toast});break;case ve.START_PAUSE:Yt(ii(s=>{s.pausedAt=Date.now(),s.toasts.forEach(i=>{i.paused=!0})}));break;case ve.END_PAUSE:const r=n.time-(Mn.pausedAt||0);Yt(ii(s=>{s.pausedAt=void 0,s.toasts.forEach(i=>{i.pauseDuration+=r,i.paused=!1})}));break}},O_={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ir={id:"",icon:"",unmountDelay:500,duration:3e3,ariaProps:{role:"status","aria-live":"polite"},className:"",style:{},position:"top-right",iconTheme:{}},Vd={position:"top-right",toastOptions:ir,gutter:8,containerStyle:{},containerClassName:""},oi="16px",M_={position:"fixed","z-index":9999,top:oi,bottom:oi,left:oi,right:oi,"pointer-events":"none"},x_=(()=>{let n=0;return()=>String(++n)})(),L_=n=>{q_(e=>({containerClassName:n.containerClassName??e.containerClassName,containerStyle:n.containerStyle??e.containerStyle,gutter:n.gutter??e.gutter,position:n.position??e.position,toastOptions:{...n.toastOptions}}))},U_=(n,e)=>{const r=n.includes("top")?{top:0,"margin-top":`${e}px`}:{bottom:0,"margin-bottom":`${e}px`},s=n.includes("center")?{"justify-content":"center"}:n.includes("right")?{"justify-content":"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:"all 230ms cubic-bezier(.21,1.02,.73,1)",...r,...s}},F_=(n,e)=>{const t=n.getBoundingClientRect();t.height!==e.height&&ft({type:ve.UPDATE_TOAST,toast:{id:e.id,height:t.height}})},$_=(n,e)=>{const{toasts:t}=Mn,r=Xn().gutter||Vd.gutter||8,s=t.filter(l=>(l.position||e)===e&&l.height),i=s.findIndex(l=>l.id===n.id),a=s.filter((l,h)=>h<i&&l.visible).length;return s.slice(0,a).reduce((l,h)=>l+r+(h.height||0),0)},B_=(n,e)=>(n.position||e).includes("top")?1:-1,j_={display:"flex","align-items":"center",color:"#363636",background:"white","box-shadow":"0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05)","max-width":"350px","pointer-events":"auto",padding:"8px 10px","border-radius":"4px","line-height":"1.3","will-change":"transform"},z_={display:"flex","align-items":"center",flex:"1 1 auto",margin:"4px 10px","white-space":"pre-line"},ai={"flex-shrink":0,"min-width":"20px","min-height":"20px",display:"flex","align-items":"center","justify-content":"center","text-align":"center"},Ui=n=>({calcMode:"spline",keyTimes:"0; 1",keySplines:n}),[Xn,q_]=Se(Vd),H_=(n,e="blank",t)=>({...ir,...Xn().toastOptions,...t,type:e,message:n,pauseDuration:0,createdAt:Date.now(),visible:!0,id:t.id||x_(),paused:!1,style:{...ir.style,...Xn().toastOptions?.style,...t.style},duration:t.duration||Xn().toastOptions?.duration||O_[e],position:t.position||Xn().toastOptions?.position||Xn().position||ir.position}),Ss=n=>(e,t={})=>ts(()=>{const r=Mn.toasts.find(i=>i.id===t.id),s=H_(e,n,{...r,duration:void 0,...t});return ft({type:ve.UPSERT_TOAST,toast:s}),s.id}),nt=(n,e)=>Ss("blank")(n,e);st(()=>nt);nt.error=Ss("error");nt.success=Ss("success");nt.loading=Ss("loading");nt.custom=Ss("custom");nt.dismiss=n=>{ft({type:ve.DISMISS_TOAST,toastId:n})};nt.promise=(n,e,t)=>{const r=nt.loading(e.loading,{...t});return n.then(s=>(nt.success(Oi(e.success,s),{id:r,...t}),s)).catch(s=>{nt.error(Oi(e.error,s),{id:r,...t})}),n};nt.remove=n=>{ft({type:ve.REMOVE_TOAST,toastId:n})};var G_=de("<div><style>.sldt-active{z-index:9999;}.sldt-active>*{pointer-events:auto;}");const W_=n=>(Mt(()=>{L_(n)}),Mt(()=>{const e=D_();Ar(()=>{e&&e.forEach(t=>t&&clearTimeout(t))})}),(()=>{var e=G_();return e.firstChild,q(e,z(ka,{get each(){return Mn.toasts},children:t=>z(Y_,{toast:t})}),null),re(t=>{var r={...M_,...n.containerStyle},s=n.containerClassName;return t.e=St(e,r,t.e),s!==t.t&&Y(e,t.t=s),t},{e:void 0,t:void 0}),e})());var ci=de("<div>"),K_=de("<div><div>");const Q_=n=>{let e;return Mt(()=>{if(!e)return;const t=B_(n.toast,n.position);n.toast.visible?e.animate([{transform:`translate3d(0,${t*-200}%,0) scale(.6)`,opacity:.5},{transform:"translate3d(0,0,0) scale(1)",opacity:1}],{duration:350,fill:"forwards",easing:"cubic-bezier(.21,1.02,.73,1)"}):e.animate([{transform:"translate3d(0,0,-1px) scale(1)",opacity:1},{transform:`translate3d(0,${t*-150}%,-1px) scale(.4)`,opacity:0}],{duration:400,fill:"forwards",easing:"cubic-bezier(.06,.71,.55,1)"})}),(()=>{var t=K_(),r=t.firstChild,s=e;return typeof s=="function"?hs(s,t):e=t,q(t,z(cp,{get children(){return[z(ri,{get when(){return n.toast.icon},get children(){var i=ci();return q(i,()=>n.toast.icon),re(a=>St(i,ai,a)),i}}),z(ri,{get when(){return n.toast.type==="loading"},get children(){var i=ci();return q(i,z(iy,Ct(()=>n.toast.iconTheme))),re(a=>St(i,ai,a)),i}}),z(ri,{get when(){return n.toast.type==="success"},get children(){var i=ci();return q(i,z(ty,Ct(()=>n.toast.iconTheme))),re(a=>St(i,ai,a)),i}}),z(ri,{get when(){return n.toast.type==="error"},get children(){var i=ci();return q(i,z(ry,Ct(()=>n.toast.iconTheme))),re(a=>St(i,ai,a)),i}})]}}),r),xt(r,Ct(()=>n.toast.ariaProps),!1,!0),q(r,()=>Oi(n.toast.message,n.toast)),re(i=>{var a=n.toast.className,c={...j_,...n.toast.style},l=z_;return a!==i.e&&Y(t,i.e=a),i.t=St(t,c,i.t),i.a=St(r,l,i.a),i},{e:void 0,t:void 0,a:void 0}),t})()};var X_=de("<div>");const Y_=n=>{const e=()=>{const s=n.toast.position||ir.position,i=$_(n.toast,s);return U_(s,i)},t=at(()=>e());let r;return lc(()=>{r&&F_(r,n.toast)}),(()=>{var s=X_();s.addEventListener("mouseleave",()=>ft({type:ve.END_PAUSE,time:Date.now()})),s.addEventListener("mouseenter",()=>ft({type:ve.START_PAUSE,time:Date.now()}));var i=r;return typeof i=="function"?hs(i,s):r=s,q(s,(()=>{var a=qe(()=>n.toast.type==="custom");return()=>a()?Oi(n.toast.message,n.toast):z(Q_,{get toast(){return n.toast},get position(){return n.toast.position||ir.position}})})()),re(a=>{var c=t(),l=n.toast.visible?"sldt-active":"";return a.e=St(s,c,a.e),l!==a.t&&Y(s,a.t=l),a},{e:void 0,t:void 0}),s})()};var J_=de('<svg><circle cx=16 cy=16 r=0><animate attributeName=opacity values="0; 1; 1"></animate><animate attributeName=r values="0; 17.5; 16"></svg>',!1,!0,!1),Z_=de('<svg><circle cx=16 cy=16 r=12 opacity=0><animate attributeName=opacity values="1; 0"></animate><animate attributeName=r values="12; 26"></svg>',!1,!0,!1);const Dd=n=>{const e={dur:"0.35s",begin:"100ms",fill:"freeze",calcMode:"spline",keyTimes:"0; 0.6; 1",keySplines:"0.25 0.71 0.4 0.88; .59 .22 .87 .63"};return(()=>{var t=J_(),r=t.firstChild,s=r.nextSibling;return xt(r,e,!0,!1),xt(s,e,!0,!1),re(()=>it(t,"fill",n.fill)),t})()},Nd=n=>{const e={dur:"1s",begin:n.begin||"320ms",fill:"freeze",...Ui("0.0 0.0 0.2 1")};return(()=>{var t=Z_(),r=t.firstChild,s=r.nextSibling;return xt(r,e,!0,!1),xt(s,e,!0,!1),re(()=>it(t,"fill",n.fill)),t})()};var ey=de('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem style=overflow:visible><path fill=none stroke-width=4 stroke-dasharray=22 stroke-dashoffset=22 stroke-linecap=round stroke-miterlimit=10 d=M9.8,17.2l3.8,3.6c0.1,0.1,0.3,0.1,0.4,0l9.6-9.7><animate attributeName=stroke-dashoffset values=22;0 dur=0.25s begin=250ms fill=freeze>');const ty=n=>{const e=n.primary||"#34C759";return(()=>{var t=ey(),r=t.firstChild,s=r.firstChild;return q(t,z(Dd,{fill:e}),r),q(t,z(Nd,{fill:e,begin:"350ms"}),r),xt(s,Ct(()=>Ui("0.0, 0.0, 0.58, 1.0")),!0,!1),re(()=>it(r,"stroke",n.secondary||"#FCFCFC")),t})()};var ny=de('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem style=overflow:visible><path fill=none stroke-width=4 stroke-dasharray=9 stroke-dashoffset=9 stroke-linecap=round d=M16,7l0,9><animate attributeName=stroke-dashoffset values=9;0 dur=0.2s begin=250ms fill=freeze></animate></path><circle cx=16 cy=23 r=2.5 opacity=0><animate attributeName=opacity values=0;1 dur=0.25s begin=350ms fill=freeze>');const ry=n=>{const e=n.primary||"#FF3B30";return(()=>{var t=ny(),r=t.firstChild,s=r.firstChild,i=r.nextSibling,a=i.firstChild;return q(t,z(Dd,{fill:e}),r),q(t,z(Nd,{fill:e}),r),xt(s,Ct(()=>Ui("0.0, 0.0, 0.58, 1.0")),!0,!1),xt(a,Ct(()=>Ui("0.0, 0.0, 0.58, 1.0")),!0,!1),re(c=>{var l=n.secondary||"#FFFFFF",h=n.secondary||"#FFFFFF";return l!==c.e&&it(r,"stroke",c.e=l),h!==c.t&&it(i,"fill",c.t=h),c},{e:void 0,t:void 0}),t})()};var sy=de('<svg viewBox="0 0 32 32"width=1.25rem height=1.25rem style=overflow:visible><path fill=none stroke-width=4 stroke-miterlimit=10 d=M16,6c3,0,5.7,1.3,7.5,3.4c1.5,1.8,2.5,4,2.5,6.6c0,5.5-4.5,10-10,10S6,21.6,6,16S10.5,6,16,6z></path><path fill=none stroke-width=4 stroke-linecap=round stroke-miterlimit=10 d=M16,6c3,0,5.7,1.3,7.5,3.4c0.6,0.7,1.1,1.4,1.5,2.2><animateTransform attributeName=transform type=rotate from="0 16 16"to="360 16 16"dur=0.75s repeatCount=indefinite>');const iy=n=>(()=>{var e=sy(),t=e.firstChild,r=t.nextSibling;return re(s=>{var i=n.primary||"#E5E7EB",a=n.secondary||"#4b5563";return i!==s.e&&it(t,"stroke",s.e=i),a!==s.t&&it(r,"stroke",s.t=a),s},{e:void 0,t:void 0}),e})(),oy=()=>z(W_,{position:"bottom-center",get toastOptions(){return{duration:3e3,unmountDelay:500,className:Q`
        width: 12.25rem;
        font-size: 1.25rem;
        color: ${x.primary} !important;
        background: ${x.secondary} !important;
        border: 2px solid ${x.primary};

        & [role='status'] {
          justify-content: center;
        }
      `,iconTheme:{primary:x.primary,secondary:x.secondary}}}}),ay="/ts-battleship/assets/new-game-BkW6tsPr.opus",cy=localStorage.getItem("isMuted")==="true",[mc,ly]=Se(cy);Mt(()=>{const n=mc();localStorage.setItem("isMuted",n.toString())});const rt=n=>mc()?void 0:void new Audio(n).play(),uy=()=>{ly(n=>!n)},hy="modulepreload",dy=function(n){return"/ts-battleship/"+n},Su={},li=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let h=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};var a=h;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),l=c?.nonce||c?.getAttribute("nonce");s=h(t.map(f=>{if(f=dy(f),f in Su)return;Su[f]=!0;const m=f.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const I=document.createElement("link");if(I.rel=m?"stylesheet":hy,m||(I.as="script"),I.crossOrigin="",I.href=f,l&&I.setAttribute("nonce",l),document.head.appendChild(I),m)return new Promise((P,C)=>{I.addEventListener("load",P),I.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(c){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c}return s.then(c=>{for(const l of c||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},fy="Service Worker Register failed.",my="Online Sign In failed.",gy="Connection failed.",py="Opponent left.",ho="Room not found.",_y="Room is full.",yy="Room not available.",da="Not in a room.",Od="Not your turn.",wy="No opponent board.",vy=15,Ey=vy*60*1e3,Ma=["5 Carrier","4 Battleship","3 Destroyer","3 Submarine","2 Patrol Boat"],Ty=[5,4,3,3,2],W=10,Pt=5,Fi=Ty.slice(0,Pt),ps=n=>nt.error(n),gc=(n,e,t,r=0,s=0,i=!1)=>{let a,c;if(t){let l=!1;do c=Math.random()<.5,a={row:~~(Math.random()*W),col:~~(Math.random()*W)},l=n.place(e,a,c);while(!l)}else if(a={row:r,col:s},c=i,!n.place(e,a,c))return!1;return e.isVertical=c,e.coords=a,!0},Iy="/ts-battleship/assets/splash-DqsQgRIg.opus";class or{grid;impacts;shipsPlaced;constructor(){this.grid=Array.from({length:W},()=>Array(W).fill(null)),this.impacts=[],this.shipsPlaced=0}place(e,t,r){if(!this._isPlaceable(e,t,r))return!1;const{row:s,col:i}=t,a=r?1:0;for(let c=0;c<e.length;c++)this.grid[s+c*a][i+c*(1-a)]=e;return!0}fire(e){const{row:t,col:r}=e,s=this.grid[t][r];return this.impacts.some(a=>a.row===t&&a.col===r)?!1:(s?(s.hit(),this.impacts.push(e)):(rt(Iy),this.impacts.push(e)),!0)}hitAdjacent(e){return this._getAdjacent(e).filter(t=>{const{row:r,col:s}=t;return this.grid[r][s]===null?(this.fire(t),!0):!1})}isGameOver(){return this.grid.flat().filter(e=>e!==null).every(e=>e.sunk)}_isPlaceable(e,t,r){const{row:s,col:i}=t,a=r?1:0;for(let c=0;c<e.length;c++){const l=s+c*a,h=i+c*(1-a);if(l<0||l>=W||h<0||h>=W||this.grid[l][h]!==null||this._isAdjacent(l,h))return!1}return!0}_getAdjacent(e){const{row:t,col:r}=e;return[{row:-1,col:0},{row:1,col:0},{row:0,col:-1},{row:0,col:1},{row:-1,col:-1},{row:-1,col:1},{row:1,col:-1},{row:1,col:1}].map(i=>({row:t+i.row,col:r+i.col})).filter(i=>i.row>=0&&i.row<this.grid.length&&i.col>=0&&i.col<this.grid[0].length)}_isAdjacent(e,t){return this._getAdjacent({row:e,col:t}).some(r=>this.grid[r.row][r.col]!==null)}}const Ay=()=>{};var Ru={};const Md=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},by=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},xd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let p=(c&15)<<2|h>>6,I=h&63;l||(I=64,a||(p=64)),r.push(t[f],t[m],t[p],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Md(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):by(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new Sy;const p=i<<2|c>>4;if(r.push(p),h!==64){const I=c<<4&240|h>>2;if(r.push(I),m!==64){const P=h<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Sy extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ry=function(n){const e=Md(n);return xd.encodeByteArray(e,!0)},$i=function(n){return Ry(n).replace(/\./g,"")},Ld=function(n){try{return xd.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Py(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Cy=()=>Py().__FIREBASE_DEFAULTS__,ky=()=>{if(typeof process>"u"||typeof Ru>"u")return;const n=Ru.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Vy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ld(n[1]);return e&&JSON.parse(e)},fo=()=>{try{return Ay()||Cy()||ky()||Vy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ud=n=>fo()?.emulatorHosts?.[n],Dy=n=>{const e=Ud(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Fd=()=>fo()?.config,$d=n=>fo()?.[`_${n}`];class Ny{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Rr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bd(n){return(await fetch(n,{credentials:"include"})).ok}function Oy(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[$i(JSON.stringify(t)),$i(JSON.stringify(a)),""].join(".")}const rs={};function My(){const n={prod:[],emulator:[]};for(const e of Object.keys(rs))rs[e]?n.emulator.push(e):n.prod.push(e);return n}function xy(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Pu=!1;function jd(n,e){if(typeof window>"u"||typeof document>"u"||!Rr(window.location.host)||rs[n]===e||rs[n]||Pu)return;rs[n]=e;function t(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=My().prod.length>0;function a(){const p=document.getElementById(r);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,I){p.setAttribute("width","24"),p.setAttribute("id",I),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function h(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Pu=!0,a()},p}function f(p,I){p.setAttribute("id",I),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=xy(r),I=t("text"),P=document.getElementById(I)||document.createElement("span"),C=t("learnmore"),R=document.getElementById(C)||document.createElement("a"),N=t("preprendIcon"),V=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const O=p.element;c(O),f(R,C);const $=h();l(V,N),O.append(V,P,R,$),document.body.appendChild(O)}i?(P.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function $e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ly(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function Uy(){const n=fo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Fy(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $y(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function By(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jy(){const n=$e();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function zy(){return!Uy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qy(){try{return typeof indexedDB=="object"}catch{return!1}}function Hy(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const Gy="FirebaseError";class zt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Gy,Object.setPrototypeOf(this,zt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rs.prototype.create)}}class Rs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?Wy(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new zt(s,c,r)}}function Wy(n,e){return n.replace(Ky,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Ky=/\{\$([^}]+)}/g;function Qy(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Cu(i)&&Cu(a)){if(!xn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Cu(n){return n!==null&&typeof n=="object"}function Ps(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Xy(n,e){const t=new Yy(n,e);return t.subscribe.bind(t)}class Yy{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Jy(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=fa),s.error===void 0&&(s.error=fa),s.complete===void 0&&(s.complete=fa);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Jy(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fa(){}function Be(n){return n&&n._delegate?n._delegate:n}class Ln{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Nn="[DEFAULT]";class Zy{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Ny;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tw(e))try{this.getOrInitializeService({instanceIdentifier:Nn})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Nn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nn){return this.instances.has(e)}getOptions(e=Nn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ew(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Nn){return this.component?this.component.multipleInstances?e:Nn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ew(n){return n===Nn?void 0:n}function tw(n){return n.instantiationMode==="EAGER"}class nw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Zy(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Z;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Z||(Z={}));const rw={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},sw=Z.INFO,iw={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},ow=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=iw[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pc{constructor(e){this.name=e,this._logLevel=sw,this._logHandler=ow,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...e),this._logHandler(this,Z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...e),this._logHandler(this,Z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...e),this._logHandler(this,Z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...e),this._logHandler(this,Z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...e),this._logHandler(this,Z.ERROR,...e)}}const aw=(n,e)=>e.some(t=>n instanceof t);let ku,Vu;function cw(){return ku||(ku=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lw(){return Vu||(Vu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zd=new WeakMap,xa=new WeakMap,qd=new WeakMap,ma=new WeakMap,_c=new WeakMap;function uw(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(on(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&zd.set(t,n)}).catch(()=>{}),_c.set(e,n),e}function hw(n){if(xa.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});xa.set(n,e)}let La={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return xa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||qd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return on(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function dw(n){La=n(La)}function fw(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ga(this),e,...t);return qd.set(r,e.sort?e.sort():[e]),on(r)}:lw().includes(n)?function(...e){return n.apply(ga(this),e),on(zd.get(this))}:function(...e){return on(n.apply(ga(this),e))}}function mw(n){return typeof n=="function"?fw(n):(n instanceof IDBTransaction&&hw(n),aw(n,cw())?new Proxy(n,La):n)}function on(n){if(n instanceof IDBRequest)return uw(n);if(ma.has(n))return ma.get(n);const e=mw(n);return e!==n&&(ma.set(n,e),_c.set(e,n)),e}const ga=n=>_c.get(n);function gw(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=on(a);return r&&a.addEventListener("upgradeneeded",l=>{r(on(a.result),l.oldVersion,l.newVersion,on(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const pw=["get","getKey","getAll","getAllKeys","count"],_w=["put","add","delete","clear"],pa=new Map;function Du(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(pa.get(e))return pa.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=_w.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pw.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return pa.set(e,i),i}dw(n=>({...n,get:(e,t,r)=>Du(e,t)||n.get(e,t,r),has:(e,t)=>!!Du(e,t)||n.has(e,t)}));class yw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ww(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ww(n){return n.getComponent()?.type==="VERSION"}const Ua="@firebase/app",Nu="0.14.6";const Lt=new pc("@firebase/app"),vw="@firebase/app-compat",Ew="@firebase/analytics-compat",Tw="@firebase/analytics",Iw="@firebase/app-check-compat",Aw="@firebase/app-check",bw="@firebase/auth",Sw="@firebase/auth-compat",Rw="@firebase/database",Pw="@firebase/data-connect",Cw="@firebase/database-compat",kw="@firebase/functions",Vw="@firebase/functions-compat",Dw="@firebase/installations",Nw="@firebase/installations-compat",Ow="@firebase/messaging",Mw="@firebase/messaging-compat",xw="@firebase/performance",Lw="@firebase/performance-compat",Uw="@firebase/remote-config",Fw="@firebase/remote-config-compat",$w="@firebase/storage",Bw="@firebase/storage-compat",jw="@firebase/firestore",zw="@firebase/ai",qw="@firebase/firestore-compat",Hw="firebase",Gw="12.6.0";const Fa="[DEFAULT]",Ww={[Ua]:"fire-core",[vw]:"fire-core-compat",[Tw]:"fire-analytics",[Ew]:"fire-analytics-compat",[Aw]:"fire-app-check",[Iw]:"fire-app-check-compat",[bw]:"fire-auth",[Sw]:"fire-auth-compat",[Rw]:"fire-rtdb",[Pw]:"fire-data-connect",[Cw]:"fire-rtdb-compat",[kw]:"fire-fn",[Vw]:"fire-fn-compat",[Dw]:"fire-iid",[Nw]:"fire-iid-compat",[Ow]:"fire-fcm",[Mw]:"fire-fcm-compat",[xw]:"fire-perf",[Lw]:"fire-perf-compat",[Uw]:"fire-rc",[Fw]:"fire-rc-compat",[$w]:"fire-gcs",[Bw]:"fire-gcs-compat",[jw]:"fire-fst",[qw]:"fire-fst-compat",[zw]:"fire-vertex","fire-js":"fire-js",[Hw]:"fire-js-all"};const Bi=new Map,Kw=new Map,$a=new Map;function Ou(n,e){try{n.container.addComponent(e)}catch(t){Lt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function gr(n){const e=n.name;if($a.has(e))return Lt.debug(`There were multiple attempts to register component ${e}.`),!1;$a.set(e,n);for(const t of Bi.values())Ou(t,n);for(const t of Kw.values())Ou(t,n);return!0}function yc(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ot(n){return n==null?!1:n.settings!==void 0}const Qw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},an=new Rs("app","Firebase",Qw);class Xw{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ln("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw an.create("app-deleted",{appName:this._name})}}const Pr=Gw;function Hd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Fa,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw an.create("bad-app-name",{appName:String(s)});if(t||(t=Fd()),!t)throw an.create("no-options");const i=Bi.get(s);if(i){if(xn(t,i.options)&&xn(r,i.config))return i;throw an.create("duplicate-app",{appName:s})}const a=new nw(s);for(const l of $a.values())a.addComponent(l);const c=new Xw(t,r,a);return Bi.set(s,c),c}function Gd(n=Fa){const e=Bi.get(n);if(!e&&n===Fa&&Fd())return Hd();if(!e)throw an.create("no-app",{appName:n});return e}function cn(n,e,t){let r=Ww[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Lt.warn(a.join(" "));return}gr(new Ln(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Yw="firebase-heartbeat-database",Jw=1,_s="firebase-heartbeat-store";let _a=null;function Wd(){return _a||(_a=gw(Yw,Jw,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_s)}catch(t){console.warn(t)}}}}).catch(n=>{throw an.create("idb-open",{originalErrorMessage:n.message})})),_a}async function Zw(n){try{const t=(await Wd()).transaction(_s),r=await t.objectStore(_s).get(Kd(n));return await t.done,r}catch(e){if(e instanceof zt)Lt.warn(e.message);else{const t=an.create("idb-get",{originalErrorMessage:e?.message});Lt.warn(t.message)}}}async function Mu(n,e){try{const r=(await Wd()).transaction(_s,"readwrite");await r.objectStore(_s).put(e,Kd(n)),await r.done}catch(t){if(t instanceof zt)Lt.warn(t.message);else{const r=an.create("idb-set",{originalErrorMessage:t?.message});Lt.warn(r.message)}}}function Kd(n){return`${n.name}!${n.options.appId}`}const ev=1024,tv=30;class nv{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new sv(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>tv){const s=iv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Lt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xu(),{heartbeatsToSend:t,unsentEntries:r}=rv(this._heartbeatsCache.heartbeats),s=$i(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Lt.warn(e),""}}}function xu(){return new Date().toISOString().substring(0,10)}function rv(n,e=ev){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Lu(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Lu(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class sv{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qy()?Hy().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Zw(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Mu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Mu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Lu(n){return $i(JSON.stringify({version:2,heartbeats:n})).length}function iv(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function ov(n){gr(new Ln("platform-logger",e=>new yw(e),"PRIVATE")),gr(new Ln("heartbeat",e=>new nv(e),"PRIVATE")),cn(Ua,Nu,n),cn(Ua,Nu,"esm2020"),cn("fire-js","")}ov("");var Uu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ln,Qd;(function(){var n;function e(E,y){function _(){}_.prototype=y.prototype,E.F=y.prototype,E.prototype=new _,E.prototype.constructor=E,E.D=function(T,v,A){for(var w=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)w[ye-2]=arguments[ye];return y.prototype[v].apply(T,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,y,_){_||(_=0);const T=Array(16);if(typeof y=="string")for(var v=0;v<16;++v)T[v]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(v=0;v<16;++v)T[v]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=E.g[0],_=E.g[1],v=E.g[2];let A=E.g[3],w;w=y+(A^_&(v^A))+T[0]+3614090360&4294967295,y=_+(w<<7&4294967295|w>>>25),w=A+(v^y&(_^v))+T[1]+3905402710&4294967295,A=y+(w<<12&4294967295|w>>>20),w=v+(_^A&(y^_))+T[2]+606105819&4294967295,v=A+(w<<17&4294967295|w>>>15),w=_+(y^v&(A^y))+T[3]+3250441966&4294967295,_=v+(w<<22&4294967295|w>>>10),w=y+(A^_&(v^A))+T[4]+4118548399&4294967295,y=_+(w<<7&4294967295|w>>>25),w=A+(v^y&(_^v))+T[5]+1200080426&4294967295,A=y+(w<<12&4294967295|w>>>20),w=v+(_^A&(y^_))+T[6]+2821735955&4294967295,v=A+(w<<17&4294967295|w>>>15),w=_+(y^v&(A^y))+T[7]+4249261313&4294967295,_=v+(w<<22&4294967295|w>>>10),w=y+(A^_&(v^A))+T[8]+1770035416&4294967295,y=_+(w<<7&4294967295|w>>>25),w=A+(v^y&(_^v))+T[9]+2336552879&4294967295,A=y+(w<<12&4294967295|w>>>20),w=v+(_^A&(y^_))+T[10]+4294925233&4294967295,v=A+(w<<17&4294967295|w>>>15),w=_+(y^v&(A^y))+T[11]+2304563134&4294967295,_=v+(w<<22&4294967295|w>>>10),w=y+(A^_&(v^A))+T[12]+1804603682&4294967295,y=_+(w<<7&4294967295|w>>>25),w=A+(v^y&(_^v))+T[13]+4254626195&4294967295,A=y+(w<<12&4294967295|w>>>20),w=v+(_^A&(y^_))+T[14]+2792965006&4294967295,v=A+(w<<17&4294967295|w>>>15),w=_+(y^v&(A^y))+T[15]+1236535329&4294967295,_=v+(w<<22&4294967295|w>>>10),w=y+(v^A&(_^v))+T[1]+4129170786&4294967295,y=_+(w<<5&4294967295|w>>>27),w=A+(_^v&(y^_))+T[6]+3225465664&4294967295,A=y+(w<<9&4294967295|w>>>23),w=v+(y^_&(A^y))+T[11]+643717713&4294967295,v=A+(w<<14&4294967295|w>>>18),w=_+(A^y&(v^A))+T[0]+3921069994&4294967295,_=v+(w<<20&4294967295|w>>>12),w=y+(v^A&(_^v))+T[5]+3593408605&4294967295,y=_+(w<<5&4294967295|w>>>27),w=A+(_^v&(y^_))+T[10]+38016083&4294967295,A=y+(w<<9&4294967295|w>>>23),w=v+(y^_&(A^y))+T[15]+3634488961&4294967295,v=A+(w<<14&4294967295|w>>>18),w=_+(A^y&(v^A))+T[4]+3889429448&4294967295,_=v+(w<<20&4294967295|w>>>12),w=y+(v^A&(_^v))+T[9]+568446438&4294967295,y=_+(w<<5&4294967295|w>>>27),w=A+(_^v&(y^_))+T[14]+3275163606&4294967295,A=y+(w<<9&4294967295|w>>>23),w=v+(y^_&(A^y))+T[3]+4107603335&4294967295,v=A+(w<<14&4294967295|w>>>18),w=_+(A^y&(v^A))+T[8]+1163531501&4294967295,_=v+(w<<20&4294967295|w>>>12),w=y+(v^A&(_^v))+T[13]+2850285829&4294967295,y=_+(w<<5&4294967295|w>>>27),w=A+(_^v&(y^_))+T[2]+4243563512&4294967295,A=y+(w<<9&4294967295|w>>>23),w=v+(y^_&(A^y))+T[7]+1735328473&4294967295,v=A+(w<<14&4294967295|w>>>18),w=_+(A^y&(v^A))+T[12]+2368359562&4294967295,_=v+(w<<20&4294967295|w>>>12),w=y+(_^v^A)+T[5]+4294588738&4294967295,y=_+(w<<4&4294967295|w>>>28),w=A+(y^_^v)+T[8]+2272392833&4294967295,A=y+(w<<11&4294967295|w>>>21),w=v+(A^y^_)+T[11]+1839030562&4294967295,v=A+(w<<16&4294967295|w>>>16),w=_+(v^A^y)+T[14]+4259657740&4294967295,_=v+(w<<23&4294967295|w>>>9),w=y+(_^v^A)+T[1]+2763975236&4294967295,y=_+(w<<4&4294967295|w>>>28),w=A+(y^_^v)+T[4]+1272893353&4294967295,A=y+(w<<11&4294967295|w>>>21),w=v+(A^y^_)+T[7]+4139469664&4294967295,v=A+(w<<16&4294967295|w>>>16),w=_+(v^A^y)+T[10]+3200236656&4294967295,_=v+(w<<23&4294967295|w>>>9),w=y+(_^v^A)+T[13]+681279174&4294967295,y=_+(w<<4&4294967295|w>>>28),w=A+(y^_^v)+T[0]+3936430074&4294967295,A=y+(w<<11&4294967295|w>>>21),w=v+(A^y^_)+T[3]+3572445317&4294967295,v=A+(w<<16&4294967295|w>>>16),w=_+(v^A^y)+T[6]+76029189&4294967295,_=v+(w<<23&4294967295|w>>>9),w=y+(_^v^A)+T[9]+3654602809&4294967295,y=_+(w<<4&4294967295|w>>>28),w=A+(y^_^v)+T[12]+3873151461&4294967295,A=y+(w<<11&4294967295|w>>>21),w=v+(A^y^_)+T[15]+530742520&4294967295,v=A+(w<<16&4294967295|w>>>16),w=_+(v^A^y)+T[2]+3299628645&4294967295,_=v+(w<<23&4294967295|w>>>9),w=y+(v^(_|~A))+T[0]+4096336452&4294967295,y=_+(w<<6&4294967295|w>>>26),w=A+(_^(y|~v))+T[7]+1126891415&4294967295,A=y+(w<<10&4294967295|w>>>22),w=v+(y^(A|~_))+T[14]+2878612391&4294967295,v=A+(w<<15&4294967295|w>>>17),w=_+(A^(v|~y))+T[5]+4237533241&4294967295,_=v+(w<<21&4294967295|w>>>11),w=y+(v^(_|~A))+T[12]+1700485571&4294967295,y=_+(w<<6&4294967295|w>>>26),w=A+(_^(y|~v))+T[3]+2399980690&4294967295,A=y+(w<<10&4294967295|w>>>22),w=v+(y^(A|~_))+T[10]+4293915773&4294967295,v=A+(w<<15&4294967295|w>>>17),w=_+(A^(v|~y))+T[1]+2240044497&4294967295,_=v+(w<<21&4294967295|w>>>11),w=y+(v^(_|~A))+T[8]+1873313359&4294967295,y=_+(w<<6&4294967295|w>>>26),w=A+(_^(y|~v))+T[15]+4264355552&4294967295,A=y+(w<<10&4294967295|w>>>22),w=v+(y^(A|~_))+T[6]+2734768916&4294967295,v=A+(w<<15&4294967295|w>>>17),w=_+(A^(v|~y))+T[13]+1309151649&4294967295,_=v+(w<<21&4294967295|w>>>11),w=y+(v^(_|~A))+T[4]+4149444226&4294967295,y=_+(w<<6&4294967295|w>>>26),w=A+(_^(y|~v))+T[11]+3174756917&4294967295,A=y+(w<<10&4294967295|w>>>22),w=v+(y^(A|~_))+T[2]+718787259&4294967295,v=A+(w<<15&4294967295|w>>>17),w=_+(A^(v|~y))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(v+(w<<21&4294967295|w>>>11))&4294967295,E.g[2]=E.g[2]+v&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.v=function(E,y){y===void 0&&(y=E.length);const _=y-this.blockSize,T=this.C;let v=this.h,A=0;for(;A<y;){if(v==0)for(;A<=_;)s(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<y;)if(T[v++]=E.charCodeAt(A++),v==this.blockSize){s(this,T),v=0;break}}else for(;A<y;)if(T[v++]=E[A++],v==this.blockSize){s(this,T),v=0;break}}this.h=v,this.o+=y},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;y=this.o*8;for(var _=E.length-8;_<E.length;++_)E[_]=y&255,y/=256;for(this.v(E),E=Array(16),y=0,_=0;_<4;++_)for(let T=0;T<32;T+=8)E[y++]=this.g[_]>>>T&255;return E};function i(E,y){var _=c;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=y(E)}function a(E,y){this.h=y;const _=[];let T=!0;for(let v=E.length-1;v>=0;v--){const A=E[v]|0;T&&A==y||(_[v]=A,T=!1)}this.g=_}var c={};function l(E){return-128<=E&&E<128?i(E,function(y){return new a([y|0],y<0?-1:0)}):new a([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return R(h(-E));const y=[];let _=1;for(let T=0;E>=_;T++)y[T]=E/_|0,_*=4294967296;return new a(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return R(f(E.substring(1),y));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const _=h(Math.pow(y,8));let T=m;for(let A=0;A<E.length;A+=8){var v=Math.min(8,E.length-A);const w=parseInt(E.substring(A,A+v),y);v<8?(v=h(Math.pow(y,v)),T=T.j(v).add(h(w))):(T=T.j(_),T=T.add(h(w)))}return T}var m=l(0),p=l(1),I=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-R(this).m();let E=0,y=1;for(let _=0;_<this.g.length;_++){const T=this.i(_);E+=(T>=0?T:4294967296+T)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(C(this))return"-"+R(this).toString(E);const y=h(Math.pow(E,6));var _=this;let T="";for(;;){const v=$(_,y).g;_=N(_,v.j(y));let A=((_.g.length>0?_.g[0]:_.h)>>>0).toString(E);if(_=v,P(_))return A+T;for(;A.length<6;)A="0"+A;T=A+T}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(let y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function C(E){return E.h==-1}n.l=function(E){return E=N(this,E),C(E)?-1:P(E)?0:1};function R(E){const y=E.g.length,_=[];for(let T=0;T<y;T++)_[T]=~E.g[T];return new a(_,~E.h).add(p)}n.abs=function(){return C(this)?R(this):this},n.add=function(E){const y=Math.max(this.g.length,E.g.length),_=[];let T=0;for(let v=0;v<=y;v++){let A=T+(this.i(v)&65535)+(E.i(v)&65535),w=(A>>>16)+(this.i(v)>>>16)+(E.i(v)>>>16);T=w>>>16,A&=65535,w&=65535,_[v]=w<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function N(E,y){return E.add(R(y))}n.j=function(E){if(P(this)||P(E))return m;if(C(this))return C(E)?R(this).j(R(E)):R(R(this).j(E));if(C(E))return R(this.j(R(E)));if(this.l(I)<0&&E.l(I)<0)return h(this.m()*E.m());const y=this.g.length+E.g.length,_=[];for(var T=0;T<2*y;T++)_[T]=0;for(T=0;T<this.g.length;T++)for(let v=0;v<E.g.length;v++){const A=this.i(T)>>>16,w=this.i(T)&65535,ye=E.i(v)>>>16,Xe=E.i(v)&65535;_[2*T+2*v]+=w*Xe,V(_,2*T+2*v),_[2*T+2*v+1]+=A*Xe,V(_,2*T+2*v+1),_[2*T+2*v+1]+=w*ye,V(_,2*T+2*v+1),_[2*T+2*v+2]+=A*ye,V(_,2*T+2*v+2)}for(E=0;E<y;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=y;E<2*y;E++)_[E]=0;return new a(_,0)};function V(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function O(E,y){this.g=E,this.h=y}function $(E,y){if(P(y))throw Error("division by zero");if(P(E))return new O(m,m);if(C(E))return y=$(R(E),y),new O(R(y.g),R(y.h));if(C(y))return y=$(E,R(y)),new O(R(y.g),y.h);if(E.g.length>30){if(C(E)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var _=p,T=y;T.l(E)<=0;)_=U(_),T=U(T);var v=B(_,1),A=B(T,1);for(T=B(T,2),_=B(_,2);!P(T);){var w=A.add(T);w.l(E)<=0&&(v=v.add(_),A=w),T=B(T,1),_=B(_,1)}return y=N(E,v.j(y)),new O(v,y)}for(v=m;E.l(y)>=0;){for(_=Math.max(1,Math.floor(E.m()/y.m())),T=Math.ceil(Math.log(_)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),A=h(_),w=A.j(y);C(w)||w.l(E)>0;)_-=T,A=h(_),w=A.j(y);P(A)&&(A=p),v=v.add(A),E=N(E,w)}return new O(v,E)}n.B=function(E){return $(this,E).h},n.and=function(E){const y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)&E.i(T);return new a(_,this.h&E.h)},n.or=function(E){const y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)|E.i(T);return new a(_,this.h|E.h)},n.xor=function(E){const y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)^E.i(T);return new a(_,this.h^E.h)};function U(E){const y=E.g.length+1,_=[];for(let T=0;T<y;T++)_[T]=E.i(T)<<1|E.i(T-1)>>>31;return new a(_,E.h)}function B(E,y){const _=y>>5;y%=32;const T=E.g.length-_,v=[];for(let A=0;A<T;A++)v[A]=y>0?E.i(A+_)>>>y|E.i(A+_+1)<<32-y:E.i(A+_);return new a(v,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Qd=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,ln=a}).apply(typeof Uu<"u"?Uu:typeof self<"u"?self:typeof window<"u"?window:{});var ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Xd,Jr,Yd,wi,Ba,Jd,Zd,ef;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ui=="object"&&ui];for(var u=0;u<o.length;++u){var d=o[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var d=r;o=o.split(".");for(var g=0;g<o.length-1;g++){var b=o[g];if(!(b in d))break e;d=d[b]}o=o[o.length-1],g=d[o],u=u(g),u!=g&&u!=null&&e(d,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var d=[],g;for(g in u)Object.prototype.hasOwnProperty.call(u,g)&&d.push([g,u[g]]);return d}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,d){return o.call.apply(o.bind,arguments)}function h(o,u,d){return h=l,h.apply(null,arguments)}function f(o,u){var d=Array.prototype.slice.call(arguments,1);return function(){var g=d.slice();return g.push.apply(g,arguments),o.apply(this,g)}}function m(o,u){function d(){}d.prototype=u.prototype,o.Z=u.prototype,o.prototype=new d,o.prototype.constructor=o,o.Ob=function(g,b,S){for(var M=Array(arguments.length-2),J=2;J<arguments.length;J++)M[J-2]=arguments[J];return u.prototype[b].apply(g,M)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function I(o){const u=o.length;if(u>0){const d=Array(u);for(let g=0;g<u;g++)d[g]=o[g];return d}return[]}function P(o,u){for(let g=1;g<arguments.length;g++){const b=arguments[g];var d=typeof b;if(d=d!="object"?d:b?Array.isArray(b)?"array":d:"null",d=="array"||d=="object"&&typeof b.length=="number"){d=o.length||0;const S=b.length||0;o.length=d+S;for(let M=0;M<S;M++)o[d+M]=b[M]}else o.push(b)}}class C{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function R(o){a.setTimeout(()=>{throw o},0)}function N(){var o=E;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class V{constructor(){this.h=this.g=null}add(u,d){const g=O.get();g.set(u,d),this.h?this.h.next=g:this.g=g,this.h=g}}var O=new C(()=>new $,o=>o.reset());class ${constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,E=new V,y=()=>{const o=Promise.resolve(void 0);U=()=>{o.then(_)}};function _(){for(var o;o=N();){try{o.h.call(o.g)}catch(d){R(d)}var u=O;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}B=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function v(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}v.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const d=()=>{};a.addEventListener("test",d,u),a.removeEventListener("test",d,u)}catch{}return o})();function w(o){return/^[\s\xa0]*$/.test(o)}function ye(o,u){v.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(ye,v),ye.prototype.init=function(o,u){const d=this.type=o.type,g=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(d=="mouseover"?u=o.fromElement:d=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&ye.Z.h.call(this)},ye.prototype.h=function(){ye.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Xe="closure_listenable_"+(Math.random()*1e6|0),bn=0;function Sn(o,u,d,g,b){this.listener=o,this.proxy=null,this.src=u,this.type=d,this.capture=!!g,this.ha=b,this.key=++bn,this.da=this.fa=!1}function Rn(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function js(o,u,d){for(const g in o)u.call(d,o[g],g,o)}function yg(o,u){for(const d in o)u.call(void 0,o[d],d,o)}function ul(o){const u={};for(const d in o)u[d]=o[d];return u}const hl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dl(o,u){let d,g;for(let b=1;b<arguments.length;b++){g=arguments[b];for(d in g)o[d]=g[d];for(let S=0;S<hl.length;S++)d=hl[S],Object.prototype.hasOwnProperty.call(g,d)&&(o[d]=g[d])}}function zs(o){this.src=o,this.g={},this.h=0}zs.prototype.add=function(o,u,d,g,b){const S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);const M=Uo(o,u,g,b);return M>-1?(u=o[M],d||(u.fa=!1)):(u=new Sn(u,this.src,S,!!g,b),u.fa=d,o.push(u)),u};function Lo(o,u){const d=u.type;if(d in o.g){var g=o.g[d],b=Array.prototype.indexOf.call(g,u,void 0),S;(S=b>=0)&&Array.prototype.splice.call(g,b,1),S&&(Rn(u),o.g[d].length==0&&(delete o.g[d],o.h--))}}function Uo(o,u,d,g){for(let b=0;b<o.length;++b){const S=o[b];if(!S.da&&S.listener==u&&S.capture==!!d&&S.ha==g)return b}return-1}var Fo="closure_lm_"+(Math.random()*1e6|0),$o={};function fl(o,u,d,g,b){if(Array.isArray(u)){for(let S=0;S<u.length;S++)fl(o,u[S],d,g,b);return null}return d=pl(d),o&&o[Xe]?o.J(u,d,c(g)?!!g.capture:!1,b):wg(o,u,d,!1,g,b)}function wg(o,u,d,g,b,S){if(!u)throw Error("Invalid event type");const M=c(b)?!!b.capture:!!b;let J=jo(o);if(J||(o[Fo]=J=new zs(o)),d=J.add(u,d,g,M,S),d.proxy)return d;if(g=vg(),d.proxy=g,g.src=o,g.listener=d,o.addEventListener)A||(b=M),b===void 0&&(b=!1),o.addEventListener(u.toString(),g,b);else if(o.attachEvent)o.attachEvent(gl(u.toString()),g);else if(o.addListener&&o.removeListener)o.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return d}function vg(){function o(d){return u.call(o.src,o.listener,d)}const u=Eg;return o}function ml(o,u,d,g,b){if(Array.isArray(u))for(var S=0;S<u.length;S++)ml(o,u[S],d,g,b);else g=c(g)?!!g.capture:!!g,d=pl(d),o&&o[Xe]?(o=o.i,S=String(u).toString(),S in o.g&&(u=o.g[S],d=Uo(u,d,g,b),d>-1&&(Rn(u[d]),Array.prototype.splice.call(u,d,1),u.length==0&&(delete o.g[S],o.h--)))):o&&(o=jo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Uo(u,d,g,b)),(d=o>-1?u[o]:null)&&Bo(d))}function Bo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Xe])Lo(u.i,o);else{var d=o.type,g=o.proxy;u.removeEventListener?u.removeEventListener(d,g,o.capture):u.detachEvent?u.detachEvent(gl(d),g):u.addListener&&u.removeListener&&u.removeListener(g),(d=jo(u))?(Lo(d,o),d.h==0&&(d.src=null,u[Fo]=null)):Rn(o)}}}function gl(o){return o in $o?$o[o]:$o[o]="on"+o}function Eg(o,u){if(o.da)o=!0;else{u=new ye(u,this);const d=o.listener,g=o.ha||o.src;o.fa&&Bo(o),o=d.call(g,u)}return o}function jo(o){return o=o[Fo],o instanceof zs?o:null}var zo="__closure_events_fn_"+(Math.random()*1e9>>>0);function pl(o){return typeof o=="function"?o:(o[zo]||(o[zo]=function(u){return o.handleEvent(u)}),o[zo])}function Oe(){T.call(this),this.i=new zs(this),this.M=this,this.G=null}m(Oe,T),Oe.prototype[Xe]=!0,Oe.prototype.removeEventListener=function(o,u,d,g){ml(this,o,u,d,g)};function je(o,u){var d,g=o.G;if(g)for(d=[];g;g=g.G)d.push(g);if(o=o.M,g=u.type||u,typeof u=="string")u=new v(u,o);else if(u instanceof v)u.target=u.target||o;else{var b=u;u=new v(g,o),dl(u,b)}b=!0;let S,M;if(d)for(M=d.length-1;M>=0;M--)S=u.g=d[M],b=qs(S,g,!0,u)&&b;if(S=u.g=o,b=qs(S,g,!0,u)&&b,b=qs(S,g,!1,u)&&b,d)for(M=0;M<d.length;M++)S=u.g=d[M],b=qs(S,g,!1,u)&&b}Oe.prototype.N=function(){if(Oe.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const d=o.g[u];for(let g=0;g<d.length;g++)Rn(d[g]);delete o.g[u],o.h--}}this.G=null},Oe.prototype.J=function(o,u,d,g){return this.i.add(String(o),u,!1,d,g)},Oe.prototype.K=function(o,u,d,g){return this.i.add(String(o),u,!0,d,g)};function qs(o,u,d,g){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let S=0;S<u.length;++S){const M=u[S];if(M&&!M.da&&M.capture==d){const J=M.listener,Ae=M.ha||M.src;M.fa&&Lo(o.i,M),b=J.call(Ae,g)!==!1&&b}}return b&&!g.defaultPrevented}function Tg(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function _l(o){o.g=Tg(()=>{o.g=null,o.i&&(o.i=!1,_l(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class Ig extends T{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:_l(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Or(o){T.call(this),this.h=o,this.g={}}m(Or,T);var yl=[];function wl(o){js(o.g,function(u,d){this.g.hasOwnProperty(d)&&Bo(u)},o),o.g={}}Or.prototype.N=function(){Or.Z.N.call(this),wl(this)},Or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qo=a.JSON.stringify,Ag=a.JSON.parse,bg=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function vl(){}function El(){}var Mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ho(){v.call(this,"d")}m(Ho,v);function Go(){v.call(this,"c")}m(Go,v);var Pn={},Tl=null;function Hs(){return Tl=Tl||new Oe}Pn.Ia="serverreachability";function Il(o){v.call(this,Pn.Ia,o)}m(Il,v);function xr(o){const u=Hs();je(u,new Il(u))}Pn.STAT_EVENT="statevent";function Al(o,u){v.call(this,Pn.STAT_EVENT,o),this.stat=u}m(Al,v);function ze(o){const u=Hs();je(u,new Al(u,o))}Pn.Ja="timingevent";function bl(o,u){v.call(this,Pn.Ja,o),this.size=u}m(bl,v);function Lr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Ur(){this.g=!0}Ur.prototype.ua=function(){this.g=!1};function Sg(o,u,d,g,b,S){o.info(function(){if(o.g)if(S){var M="",J=S.split("&");for(let ce=0;ce<J.length;ce++){var Ae=J[ce].split("=");if(Ae.length>1){const Pe=Ae[0];Ae=Ae[1];const pt=Pe.split("_");M=pt.length>=2&&pt[1]=="type"?M+(Pe+"="+Ae+"&"):M+(Pe+"=redacted&")}}}else M=null;else M=S;return"XMLHTTP REQ ("+g+") [attempt "+b+"]: "+u+`
`+d+`
`+M})}function Rg(o,u,d,g,b,S,M){o.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+b+"]: "+u+`
`+d+`
`+S+" "+M})}function Hn(o,u,d,g){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Cg(o,d)+(g?" "+g:"")})}function Pg(o,u){o.info(function(){return"TIMEOUT: "+u})}Ur.prototype.info=function(){};function Cg(o,u){if(!o.g)return u;if(!u)return null;try{const S=JSON.parse(u);if(S){for(o=0;o<S.length;o++)if(Array.isArray(S[o])){var d=S[o];if(!(d.length<2)){var g=d[1];if(Array.isArray(g)&&!(g.length<1)){var b=g[0];if(b!="noop"&&b!="stop"&&b!="close")for(let M=1;M<g.length;M++)g[M]=""}}}}return qo(S)}catch{return u}}var Gs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Sl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rl;function Wo(){}m(Wo,vl),Wo.prototype.g=function(){return new XMLHttpRequest},Rl=new Wo;function Fr(o){return encodeURIComponent(String(o))}function kg(o){var u=1;o=o.split(":");const d=[];for(;u>0&&o.length;)d.push(o.shift()),u--;return o.length&&d.push(o.join(":")),d}function Ht(o,u,d,g){this.j=o,this.i=u,this.l=d,this.S=g||1,this.V=new Or(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pl}function Pl(){this.i=null,this.g="",this.h=!1}var Cl={},Ko={};function Qo(o,u,d){o.M=1,o.A=Ks(gt(u)),o.u=d,o.R=!0,kl(o,null)}function kl(o,u){o.F=Date.now(),Ws(o),o.B=gt(o.A);var d=o.B,g=o.S;Array.isArray(g)||(g=[String(g)]),zl(d.i,"t",g),o.C=0,d=o.j.L,o.h=new Pl,o.g=au(o.j,d?u:null,!o.u),o.P>0&&(o.O=new Ig(h(o.Y,o,o.g),o.P)),u=o.V,d=o.g,g=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(yl[0]=b.toString()),b=yl);for(let S=0;S<b.length;S++){const M=fl(d,b[S],g||u.handleEvent,!1,u.h||u);if(!M)break;u.g[M.key]=M}u=o.J?ul(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),xr(),Sg(o.i,o.v,o.B,o.l,o.S,o.u)}Ht.prototype.ba=function(o){o=o.target;const u=this.O;u&&Kt(o)==3?u.j():this.Y(o)},Ht.prototype.Y=function(o){try{if(o==this.g)e:{const J=Kt(this.g),Ae=this.g.ya(),ce=this.g.ca();if(!(J<3)&&(J!=3||this.g&&(this.h.h||this.g.la()||Xl(this.g)))){this.K||J!=4||Ae==7||(Ae==8||ce<=0?xr(3):xr(2)),Xo(this);var u=this.g.ca();this.X=u;var d=Vg(this);if(this.o=u==200,Rg(this.i,this.v,this.B,this.l,this.S,J,u),this.o){if(this.U&&!this.L){t:{if(this.g){var g,b=this.g;if((g=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(g)){var S=g;break t}}S=null}if(o=S)Hn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Yo(this,o);else{this.o=!1,this.m=3,ze(12),Cn(this),$r(this);break e}}if(this.R){o=!0;let Pe;for(;!this.K&&this.C<d.length;)if(Pe=Dg(this,d),Pe==Ko){J==4&&(this.m=4,ze(14),o=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(Pe==Cl){this.m=4,ze(15),Hn(this.i,this.l,d,"[Invalid Chunk]"),o=!1;break}else Hn(this.i,this.l,Pe,null),Yo(this,Pe);if(Vl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),J!=4||d.length!=0||this.h.h||(this.m=1,ze(16),o=!1),this.o=this.o&&o,!o)Hn(this.i,this.l,d,"[Invalid Chunked Response]"),Cn(this),$r(this);else if(d.length>0&&!this.W){this.W=!0;var M=this.j;M.g==this&&M.aa&&!M.P&&(M.j.info("Great, no buffering proxy detected. Bytes received: "+d.length),ia(M),M.P=!0,ze(11))}}else Hn(this.i,this.l,d,null),Yo(this,d);J==4&&Cn(this),this.o&&!this.K&&(J==4?ru(this.j,this):(this.o=!1,Ws(this)))}else Gg(this.g),u==400&&d.indexOf("Unknown SID")>0?(this.m=3,ze(12)):(this.m=0,ze(13)),Cn(this),$r(this)}}}catch{}finally{}};function Vg(o){if(!Vl(o))return o.g.la();const u=Xl(o.g);if(u==="")return"";let d="";const g=u.length,b=Kt(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return Cn(o),$r(o),"";o.h.i=new a.TextDecoder}for(let S=0;S<g;S++)o.h.h=!0,d+=o.h.i.decode(u[S],{stream:!(b&&S==g-1)});return u.length=0,o.h.g+=d,o.C=0,o.h.g}function Vl(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Dg(o,u){var d=o.C,g=u.indexOf(`
`,d);return g==-1?Ko:(d=Number(u.substring(d,g)),isNaN(d)?Cl:(g+=1,g+d>u.length?Ko:(u=u.slice(g,g+d),o.C=g+d,u)))}Ht.prototype.cancel=function(){this.K=!0,Cn(this)};function Ws(o){o.T=Date.now()+o.H,Dl(o,o.H)}function Dl(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Lr(h(o.aa,o),u)}function Xo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Ht.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Pg(this.i,this.B),this.M!=2&&(xr(),ze(17)),Cn(this),this.m=2,$r(this)):Dl(this,this.T-o)};function $r(o){o.j.I==0||o.K||ru(o.j,o)}function Cn(o){Xo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,wl(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Yo(o,u){try{var d=o.j;if(d.I!=0&&(d.g==o||Jo(d.h,o))){if(!o.L&&Jo(d.h,o)&&d.I==3){try{var g=d.Ba.g.parse(u)}catch{g=null}if(Array.isArray(g)&&g.length==3){var b=g;if(b[0]==0){e:if(!d.v){if(d.g)if(d.g.F+3e3<o.F)Zs(d),Ys(d);else break e;sa(d),ze(18)}}else d.xa=b[1],0<d.xa-d.K&&b[2]<37500&&d.F&&d.A==0&&!d.C&&(d.C=Lr(h(d.Va,d),6e3));Ml(d.h)<=1&&d.ta&&(d.ta=void 0)}else Vn(d,11)}else if((o.L||d.g==o)&&Zs(d),!w(u))for(b=d.Ba.g.parse(u),u=0;u<b.length;u++){let ce=b[u];const Pe=ce[0];if(!(Pe<=d.K))if(d.K=Pe,ce=ce[1],d.I==2)if(ce[0]=="c"){d.M=ce[1],d.ba=ce[2];const pt=ce[3];pt!=null&&(d.ka=pt,d.j.info("VER="+d.ka));const Dn=ce[4];Dn!=null&&(d.za=Dn,d.j.info("SVER="+d.za));const Qt=ce[5];Qt!=null&&typeof Qt=="number"&&Qt>0&&(g=1.5*Qt,d.O=g,d.j.info("backChannelRequestTimeoutMs_="+g)),g=d;const Xt=o.g;if(Xt){const ti=Xt.g?Xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ti){var S=g.h;S.g||ti.indexOf("spdy")==-1&&ti.indexOf("quic")==-1&&ti.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Zo(S,S.h),S.h=null))}if(g.G){const oa=Xt.g?Xt.g.getResponseHeader("X-HTTP-Session-Id"):null;oa&&(g.wa=oa,he(g.J,g.G,oa))}}d.I=3,d.l&&d.l.ra(),d.aa&&(d.T=Date.now()-o.F,d.j.info("Handshake RTT: "+d.T+"ms")),g=d;var M=o;if(g.na=ou(g,g.L?g.ba:null,g.W),M.L){xl(g.h,M);var J=M,Ae=g.O;Ae&&(J.H=Ae),J.D&&(Xo(J),Ws(J)),g.g=M}else tu(g);d.i.length>0&&Js(d)}else ce[0]!="stop"&&ce[0]!="close"||Vn(d,7);else d.I==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?Vn(d,7):ra(d):ce[0]!="noop"&&d.l&&d.l.qa(ce),d.A=0)}}xr(4)}catch{}}var Ng=class{constructor(o,u){this.g=o,this.map=u}};function Nl(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ol(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ml(o){return o.h?1:o.g?o.g.size:0}function Jo(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Zo(o,u){o.g?o.g.add(u):o.h=u}function xl(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Nl.prototype.cancel=function(){if(this.i=Ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Ll(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const d of o.g.values())u=u.concat(d.G);return u}return I(o.i)}var Ul=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Og(o,u){if(o){o=o.split("&");for(let d=0;d<o.length;d++){const g=o[d].indexOf("=");let b,S=null;g>=0?(b=o[d].substring(0,g),S=o[d].substring(g+1)):b=o[d],u(b,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Gt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Gt?(this.l=o.l,Br(this,o.j),this.o=o.o,this.g=o.g,jr(this,o.u),this.h=o.h,ea(this,ql(o.i)),this.m=o.m):o&&(u=String(o).match(Ul))?(this.l=!1,Br(this,u[1]||"",!0),this.o=zr(u[2]||""),this.g=zr(u[3]||"",!0),jr(this,u[4]),this.h=zr(u[5]||"",!0),ea(this,u[6]||"",!0),this.m=zr(u[7]||"")):(this.l=!1,this.i=new Hr(null,this.l))}Gt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(qr(u,Fl,!0),":");var d=this.g;return(d||u=="file")&&(o.push("//"),(u=this.o)&&o.push(qr(u,Fl,!0),"@"),o.push(Fr(d).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.u,d!=null&&o.push(":",String(d))),(d=this.h)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(qr(d,d.charAt(0)=="/"?Lg:xg,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",qr(d,Fg)),o.join("")},Gt.prototype.resolve=function(o){const u=gt(this);let d=!!o.j;d?Br(u,o.j):d=!!o.o,d?u.o=o.o:d=!!o.g,d?u.g=o.g:d=o.u!=null;var g=o.h;if(d)jr(u,o.u);else if(d=!!o.h){if(g.charAt(0)!="/")if(this.g&&!this.h)g="/"+g;else{var b=u.h.lastIndexOf("/");b!=-1&&(g=u.h.slice(0,b+1)+g)}if(b=g,b==".."||b==".")g="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){g=b.lastIndexOf("/",0)==0,b=b.split("/");const S=[];for(let M=0;M<b.length;){const J=b[M++];J=="."?g&&M==b.length&&S.push(""):J==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),g&&M==b.length&&S.push("")):(S.push(J),g=!0)}g=S.join("/")}else g=b}return d?u.h=g:d=o.i.toString()!=="",d?ea(u,ql(o.i)):d=!!o.m,d&&(u.m=o.m),u};function gt(o){return new Gt(o)}function Br(o,u,d){o.j=d?zr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function jr(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function ea(o,u,d){u instanceof Hr?(o.i=u,$g(o.i,o.l)):(d||(u=qr(u,Ug)),o.i=new Hr(u,o.l))}function he(o,u,d){o.i.set(u,d)}function Ks(o){return he(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function zr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function qr(o,u,d){return typeof o=="string"?(o=encodeURI(o).replace(u,Mg),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Mg(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Fl=/[#\/\?@]/g,xg=/[#\?:]/g,Lg=/[#\?]/g,Ug=/[#\?@]/g,Fg=/#/g;function Hr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function kn(o){o.g||(o.g=new Map,o.h=0,o.i&&Og(o.i,function(u,d){o.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}n=Hr.prototype,n.add=function(o,u){kn(this),this.i=null,o=Gn(this,o);let d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(u),this.h+=1,this};function $l(o,u){kn(o),u=Gn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Bl(o,u){return kn(o),u=Gn(o,u),o.g.has(u)}n.forEach=function(o,u){kn(this),this.g.forEach(function(d,g){d.forEach(function(b){o.call(u,b,g,this)},this)},this)};function jl(o,u){kn(o);let d=[];if(typeof u=="string")Bl(o,u)&&(d=d.concat(o.g.get(Gn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)d=d.concat(o[u]);return d}n.set=function(o,u){return kn(this),this.i=null,o=Gn(this,o),Bl(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=jl(this,o),o.length>0?String(o[0]):u):u};function zl(o,u,d){$l(o,u),d.length>0&&(o.i=null,o.g.set(Gn(o,u),I(d)),o.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let g=0;g<u.length;g++){var d=u[g];const b=Fr(d);d=jl(this,d);for(let S=0;S<d.length;S++){let M=b;d[S]!==""&&(M+="="+Fr(d[S])),o.push(M)}}return this.i=o.join("&")};function ql(o){const u=new Hr;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function Gn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function $g(o,u){u&&!o.j&&(kn(o),o.i=null,o.g.forEach(function(d,g){const b=g.toLowerCase();g!=b&&($l(this,g),zl(this,b,d))},o)),o.j=u}function Bg(o,u){const d=new Ur;if(a.Image){const g=new Image;g.onload=f(Wt,d,"TestLoadImage: loaded",!0,u,g),g.onerror=f(Wt,d,"TestLoadImage: error",!1,u,g),g.onabort=f(Wt,d,"TestLoadImage: abort",!1,u,g),g.ontimeout=f(Wt,d,"TestLoadImage: timeout",!1,u,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=o}else u(!1)}function jg(o,u){const d=new Ur,g=new AbortController,b=setTimeout(()=>{g.abort(),Wt(d,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:g.signal}).then(S=>{clearTimeout(b),S.ok?Wt(d,"TestPingServer: ok",!0,u):Wt(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Wt(d,"TestPingServer: error",!1,u)})}function Wt(o,u,d,g,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),g(d)}catch{}}function zg(){this.g=new bg}function ta(o){this.i=o.Sb||null,this.h=o.ab||!1}m(ta,vl),ta.prototype.g=function(){return new Qs(this.i,this.h)};function Qs(o,u){Oe.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Qs,Oe),n=Qs.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,Wr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Gr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Wr(this)),this.g&&(this.readyState=3,Wr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hl(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hl(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Gr(this):Wr(this),this.readyState==3&&Hl(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,Gr(this))},n.Na=function(o){this.g&&(this.response=o,Gr(this))},n.ga=function(){this.g&&Gr(this)};function Gr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Wr(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=u.next();return o.join(`\r
`)};function Wr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Gl(o){let u="";return js(o,function(d,g){u+=g,u+=":",u+=d,u+=`\r
`}),u}function na(o,u,d){e:{for(g in d){var g=!1;break e}g=!0}g||(d=Gl(d),typeof o=="string"?d!=null&&Fr(d):he(o,u,d))}function ge(o){Oe.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ge,Oe);var qg=/^https?$/i,Hg=["POST","PUT"];n=ge.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,d,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rl.g(),this.g.onreadystatechange=p(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){Wl(this,S);return}if(o=d||"",d=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var b in g)d.set(b,g[b]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const S of g.keys())d.set(S,g.get(S));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Hg,u,void 0)>=0)||g||b||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[S,M]of d)this.g.setRequestHeader(S,M);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(S){Wl(this,S)}};function Wl(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Kl(o),Xs(o)}function Kl(o){o.A||(o.A=!0,je(o,"complete"),je(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,je(this,"complete"),je(this,"abort"),Xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xs(this,!0)),ge.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ql(this):this.Xa())},n.Xa=function(){Ql(this)};function Ql(o){if(o.h&&typeof i<"u"){if(o.v&&Kt(o)==4)setTimeout(o.Ca.bind(o),0);else if(je(o,"readystatechange"),Kt(o)==4){o.h=!1;try{const S=o.ca();e:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var g;if(g=S===0){let M=String(o.D).match(Ul)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),g=!qg.test(M?M.toLowerCase():"")}d=g}if(d)je(o,"complete"),je(o,"success");else{o.o=6;try{var b=Kt(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Kl(o)}}finally{Xs(o)}}}}function Xs(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const d=o.g;o.g=null,u||je(o,"ready");try{d.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Kt(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Kt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Ag(u)}};function Xl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Gg(o){const u={};o=(o.g&&Kt(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<o.length;g++){if(w(o[g]))continue;var d=kg(o[g]);const b=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const S=u[b]||[];u[b]=S,S.push(d)}yg(u,function(g){return g.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kr(o,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||u}function Yl(o){this.za=0,this.i=[],this.j=new Ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Kr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Kr("baseRetryDelayMs",5e3,o),this.Za=Kr("retryDelaySeedMs",1e4,o),this.Ta=Kr("forwardChannelMaxRetries",2,o),this.va=Kr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Nl(o&&o.concurrentRequestLimit),this.Ba=new zg,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Yl.prototype,n.ka=8,n.I=1,n.connect=function(o,u,d,g){ze(0),this.W=o,this.H=u||{},d&&g!==void 0&&(this.H.OSID=d,this.H.OAID=g),this.F=this.X,this.J=ou(this,null,this.W),Js(this)};function ra(o){if(Jl(o),o.I==3){var u=o.V++,d=gt(o.J);if(he(d,"SID",o.M),he(d,"RID",u),he(d,"TYPE","terminate"),Qr(o,d),u=new Ht(o,o.j,u),u.M=2,u.A=Ks(gt(d)),d=!1,a.navigator&&a.navigator.sendBeacon)try{d=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!d&&a.Image&&(new Image().src=u.A,d=!0),d||(u.g=au(u.j,null),u.g.ea(u.A)),u.F=Date.now(),Ws(u)}iu(o)}function Ys(o){o.g&&(ia(o),o.g.cancel(),o.g=null)}function Jl(o){Ys(o),o.v&&(a.clearTimeout(o.v),o.v=null),Zs(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Js(o){if(!Ol(o.h)&&!o.m){o.m=!0;var u=o.Ea;U||y(),B||(U(),B=!0),E.add(u,o),o.D=0}}function Wg(o,u){return Ml(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Lr(h(o.Ea,o,u),su(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Ht(this,this.j,o);let S=this.o;if(this.U&&(S?(S=ul(S),dl(S,this.U)):S=this.U),this.u!==null||this.R||(b.J=S,S=null),this.S)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var g=this.i[d];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(u+=g,u>4096){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=eu(this,b,u),d=gt(this.J),he(d,"RID",o),he(d,"CVER",22),this.G&&he(d,"X-HTTP-Session-Id",this.G),Qr(this,d),S&&(this.R?u="headers="+Fr(Gl(S))+"&"+u:this.u&&na(d,this.u,S)),Zo(this.h,b),this.Ra&&he(d,"TYPE","init"),this.S?(he(d,"$req",u),he(d,"SID","null"),b.U=!0,Qo(b,d,null)):Qo(b,d,u),this.I=2}}else this.I==3&&(o?Zl(this,o):this.i.length==0||Ol(this.h)||Zl(this))};function Zl(o,u){var d;u?d=u.l:d=o.V++;const g=gt(o.J);he(g,"SID",o.M),he(g,"RID",d),he(g,"AID",o.K),Qr(o,g),o.u&&o.o&&na(g,o.u,o.o),d=new Ht(o,o.j,d,o.D+1),o.u===null&&(d.J=o.o),u&&(o.i=u.G.concat(o.i)),u=eu(o,d,1e3),d.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Zo(o.h,d),Qo(d,g,u)}function Qr(o,u){o.H&&js(o.H,function(d,g){he(u,g,d)}),o.l&&js({},function(d,g){he(u,g,d)})}function eu(o,u,d){d=Math.min(o.i.length,d);const g=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let J=-1;for(;;){const Ae=["count="+d];J==-1?d>0?(J=b[0].g,Ae.push("ofs="+J)):J=0:Ae.push("ofs="+J);let ce=!0;for(let Pe=0;Pe<d;Pe++){var S=b[Pe].g;const pt=b[Pe].map;if(S-=J,S<0)J=Math.max(0,b[Pe].g-100),ce=!1;else try{S="req"+S+"_"||"";try{var M=pt instanceof Map?pt:Object.entries(pt);for(const[Dn,Qt]of M){let Xt=Qt;c(Qt)&&(Xt=qo(Qt)),Ae.push(S+Dn+"="+encodeURIComponent(Xt))}}catch(Dn){throw Ae.push(S+"type="+encodeURIComponent("_badmap")),Dn}}catch{g&&g(pt)}}if(ce){M=Ae.join("&");break e}}M=void 0}return o=o.i.splice(0,d),u.G=o,M}function tu(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;U||y(),B||(U(),B=!0),E.add(u,o),o.A=0}}function sa(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Lr(h(o.Da,o),su(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,nu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Lr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ze(10),Ys(this),nu(this))};function ia(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function nu(o){o.g=new Ht(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=gt(o.na);he(u,"RID","rpc"),he(u,"SID",o.M),he(u,"AID",o.K),he(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&he(u,"TO",o.ia),he(u,"TYPE","xmlhttp"),Qr(o,u),o.u&&o.o&&na(u,o.u,o.o),o.O&&(o.g.H=o.O);var d=o.g;o=o.ba,d.M=1,d.A=Ks(gt(u)),d.u=null,d.R=!0,kl(d,o)}n.Va=function(){this.C!=null&&(this.C=null,Ys(this),sa(this),ze(19))};function Zs(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function ru(o,u){var d=null;if(o.g==u){Zs(o),ia(o),o.g=null;var g=2}else if(Jo(o.h,u))d=u.G,xl(o.h,u),g=1;else return;if(o.I!=0){if(u.o)if(g==1){d=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;g=Hs(),je(g,new bl(g,d)),Js(o)}else tu(o);else if(b=u.m,b==3||b==0&&u.X>0||!(g==1&&Wg(o,u)||g==2&&sa(o)))switch(d&&d.length>0&&(u=o.h,u.i=u.i.concat(d)),b){case 1:Vn(o,5);break;case 4:Vn(o,10);break;case 3:Vn(o,6);break;default:Vn(o,2)}}}function su(o,u){let d=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(d*=2),d*u}function Vn(o,u){if(o.j.info("Error code "+u),u==2){var d=h(o.bb,o),g=o.Ua;const b=!g;g=new Gt(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Br(g,"https"),Ks(g),b?Bg(g.toString(),d):jg(g.toString(),d)}else ze(2);o.I=0,o.l&&o.l.pa(u),iu(o),Jl(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function iu(o){if(o.I=0,o.ja=[],o.l){const u=Ll(o.h);(u.length!=0||o.i.length!=0)&&(P(o.ja,u),P(o.ja,o.i),o.h.i.length=0,I(o.i),o.i.length=0),o.l.oa()}}function ou(o,u,d){var g=d instanceof Gt?gt(d):new Gt(d);if(g.g!="")u&&(g.g=u+"."+g.g),jr(g,g.u);else{var b=a.location;g=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const S=new Gt(null);g&&Br(S,g),u&&(S.g=u),b&&jr(S,b),d&&(S.h=d),g=S}return d=o.G,u=o.wa,d&&u&&he(g,d,u),he(g,"VER",o.ka),Qr(o,g),g}function au(o,u,d){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new ge(new ta({ab:d})):new ge(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cu(){}n=cu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ei(){}ei.prototype.g=function(o,u){return new Ye(o,u)};function Ye(o,u){Oe.call(this),this.g=new Yl(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!w(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!w(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Wn(this)}m(Ye,Oe),Ye.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ye.prototype.close=function(){ra(this.g)},Ye.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.v&&(d={},d.__data__=qo(o),o=d);u.i.push(new Ng(u.Ya++,o)),u.I==3&&Js(u)},Ye.prototype.N=function(){this.g.l=null,delete this.j,ra(this.g),delete this.g,Ye.Z.N.call(this)};function lu(o){Ho.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const d in u){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(lu,Ho);function uu(){Go.call(this),this.status=1}m(uu,Go);function Wn(o){this.g=o}m(Wn,cu),Wn.prototype.ra=function(){je(this.g,"a")},Wn.prototype.qa=function(o){je(this.g,new lu(o))},Wn.prototype.pa=function(o){je(this.g,new uu)},Wn.prototype.oa=function(){je(this.g,"b")},ei.prototype.createWebChannel=ei.prototype.g,Ye.prototype.send=Ye.prototype.o,Ye.prototype.open=Ye.prototype.m,Ye.prototype.close=Ye.prototype.close,ef=function(){return new ei},Zd=function(){return Hs()},Jd=Pn,Ba={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Gs.NO_ERROR=0,Gs.TIMEOUT=8,Gs.HTTP_ERROR=6,wi=Gs,Sl.COMPLETE="complete",Yd=Sl,El.EventType=Mr,Mr.OPEN="a",Mr.CLOSE="b",Mr.ERROR="c",Mr.MESSAGE="d",Oe.prototype.listen=Oe.prototype.J,Jr=El,ge.prototype.listenOnce=ge.prototype.K,ge.prototype.getLastError=ge.prototype.Ha,ge.prototype.getLastErrorCode=ge.prototype.ya,ge.prototype.getStatus=ge.prototype.ca,ge.prototype.getResponseJson=ge.prototype.La,ge.prototype.getResponseText=ge.prototype.la,ge.prototype.send=ge.prototype.ea,ge.prototype.setWithCredentials=ge.prototype.Fa,Xd=ge}).apply(typeof ui<"u"?ui:typeof self<"u"?self:typeof window<"u"?window:{});const Fu="@firebase/firestore",$u="4.9.2";class Le{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Le.UNAUTHENTICATED=new Le(null),Le.GOOGLE_CREDENTIALS=new Le("google-credentials-uid"),Le.FIRST_PARTY=new Le("first-party-uid"),Le.MOCK_USER=new Le("mock-user");let Cr="12.3.0";const Un=new pc("@firebase/firestore");function Yn(){return Un.logLevel}function F(n,...e){if(Un.logLevel<=Z.DEBUG){const t=e.map(wc);Un.debug(`Firestore (${Cr}): ${n}`,...t)}}function Ut(n,...e){if(Un.logLevel<=Z.ERROR){const t=e.map(wc);Un.error(`Firestore (${Cr}): ${n}`,...t)}}function Fn(n,...e){if(Un.logLevel<=Z.WARN){const t=e.map(wc);Un.warn(`Firestore (${Cr}): ${n}`,...t)}}function wc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function H(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,tf(n,r,t)}function tf(n,e,t){let r=`FIRESTORE (${Cr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ut(r),new Error(r)}function oe(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||tf(e,s,r)}function X(n,e){return n}const k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends zt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Nt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class nf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Le.UNAUTHENTICATED)))}shutdown(){}}class av{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class cv{constructor(e){this.t=e,this.currentUser=Le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){oe(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Nt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Nt,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Nt)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new nf(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new Le(e)}}class lv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Le.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new lv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Le.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Bu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ot(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){oe(this.o===void 0,3512);const r=i=>{i.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,F("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Bu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Bu(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function dv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class mo{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=dv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function ee(n,e){return n<e?-1:n>e?1:0}function ja(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return ya(s)===ya(i)?ee(s,i):ya(s)?1:-1}return ee(n.length,e.length)}const fv=55296,mv=57343;function ya(n){const e=n.charCodeAt(0);return e>=fv&&e<=mv}function pr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const ju="__name__";class _t{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&H(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return _t.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _t?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=_t.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return ee(e.length,t.length)}static compareSegments(e,t){const r=_t.isNumericId(e),s=_t.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?_t.extractNumericId(e).compare(_t.extractNumericId(t)):ja(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ln.fromString(e.substring(4,e.length-2))}}class ue extends _t{construct(e,t,r){return new ue(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new L(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ue(t)}static emptyPath(){return new ue([])}}const gv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ke extends _t{construct(e,t,r){return new ke(e,t,r)}static isValidIdentifier(e){return gv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ke.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ju}static keyField(){return new ke([ju])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new L(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new L(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new L(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ke(t)}static emptyPath(){return new ke([])}}class j{constructor(e){this.path=e}static fromPath(e){return new j(ue.fromString(e))}static fromName(e){return new j(ue.fromString(e).popFirst(5))}static empty(){return new j(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ue.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new j(new ue(e.slice()))}}function sf(n,e,t){if(!t)throw new L(k.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function of(n,e,t,r){if(e===!0&&r===!0)throw new L(k.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zu(n){if(!j.isDocumentKey(n))throw new L(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function qu(n){if(j.isDocumentKey(n))throw new L(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function af(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function go(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H(12329,{type:typeof n})}function We(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=go(n);throw new L(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ie(n,e){const t={typeString:n};return e&&(t.value=e),t}function Cs(n,e){if(!af(n))throw new L(k.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new L(k.INVALID_ARGUMENT,t);return!0}const Hu=-62135596800,Gu=1e6;class le{static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Gu);return new le(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Hu)throw new L(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Gu}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cs(e,le._jsonSchema))return new le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}le._jsonSchemaVersion="firestore/timestamp/1.0",le._jsonSchema={type:Ie("string",le._jsonSchemaVersion),seconds:Ie("number"),nanoseconds:Ie("number")};class K{static fromTimestamp(e){return new K(e)}static min(){return new K(new le(0,0))}static max(){return new K(new le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ys=-1;function pv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=K.fromTimestamp(r===1e9?new le(t+1,0):new le(t,r));return new fn(s,j.empty(),e)}function _v(n){return new fn(n.readTime,n.key,ys)}class fn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fn(K.min(),j.empty(),ys)}static max(){return new fn(K.max(),j.empty(),ys)}}function yv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}const wv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function kr(n){if(n.code!==k.FAILED_PRECONDITION||n.message!==wv)throw n;F("LocalStore","Unexpectedly lost primary lease")}class D{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new D(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof D?t:D.resolve(t)}catch(t){return D.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):D.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):D.reject(t)}static resolve(e){return new D(((t,r)=>{t(e)}))}static reject(e){return new D(((t,r)=>{r(e)}))}static waitFor(e){return new D(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=D.resolve(!1);for(const r of e)t=t.next((s=>s?D.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new D(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((f=>{a[h]=f,++c,c===i&&r(a)}),(f=>s(f)))}}))}static doWhile(e,t){return new D(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function Ev(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vr(n){return n.name==="IndexedDbTransactionError"}class po{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}po.ce=-1;const vc=-1;function _o(n){return n==null}function ji(n){return n===0&&1/n==-1/0}function Tv(n){return typeof n=="number"&&Number.isInteger(n)&&!ji(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const cf="";function Iv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Wu(e)),e=Av(n.get(t),e);return Wu(e)}function Av(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case cf:t+="";break;default:t+=i}}return t}function Wu(n){return n+cf+""}function Ku(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function En(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lf(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class me{constructor(e,t){this.comparator=e,this.root=t||De.EMPTY}insert(e,t){return new me(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,De.BLACK,null,null))}remove(e){return new me(this.comparator,this.root.remove(e,this.comparator).copy(null,null,De.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hi(this.root,e,this.comparator,!1)}getReverseIterator(){return new hi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hi(this.root,e,this.comparator,!0)}}class hi{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class De{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??De.RED,this.left=s??De.EMPTY,this.right=i??De.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new De(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return De.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return De.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,De.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,De.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw H(43730,{key:this.key,value:this.value});if(this.right.isRed())throw H(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw H(27949);return e+(this.isRed()?0:1)}}De.EMPTY=null,De.RED=!0,De.BLACK=!1;De.EMPTY=new class{constructor(){this.size=0}get key(){throw H(57766)}get value(){throw H(16141)}get color(){throw H(16727)}get left(){throw H(29726)}get right(){throw H(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new De(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Qu(this.data.getIterator())}getIteratorFrom(e){return new Qu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class Qu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ze{constructor(e){this.fields=e,e.sort(ke.comparator)}static empty(){return new Ze([])}unionWith(e){let t=new Re(ke.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ze(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class uf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ve{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new uf("Invalid base64 string: "+i):i}})(e);return new Ve(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ve(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ve.EMPTY_BYTE_STRING=new Ve("");const bv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mn(n){if(oe(!!n,39018),typeof n=="string"){let e=0;const t=bv.exec(n);if(oe(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_e(n.seconds),nanos:_e(n.nanos)}}function _e(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gn(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}const hf="server_timestamp",df="__type__",ff="__previous_value__",mf="__local_write_time__";function Ec(n){return(n?.mapValue?.fields||{})[df]?.stringValue===hf}function yo(n){const e=n.mapValue.fields[ff];return Ec(e)?yo(e):e}function ws(n){const e=mn(n.mapValue.fields[mf].timestampValue);return new le(e.seconds,e.nanos)}class Sv{constructor(e,t,r,s,i,a,c,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=f}}const zi="(default)";class _r{constructor(e,t){this.projectId=e,this.database=t||zi}static empty(){return new _r("","")}get isDefaultDatabase(){return this.database===zi}isEqual(e){return e instanceof _r&&e.projectId===this.projectId&&e.database===this.database}}const gf="__type__",Rv="__max__",di={mapValue:{}},pf="__vector__",qi="value";function pn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ec(n)?4:Cv(n)?9007199254740991:Pv(n)?10:11:H(28295,{value:n})}function bt(n,e){if(n===e)return!0;const t=pn(n);if(t!==pn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ws(n).isEqual(ws(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=mn(s.timestampValue),c=mn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return gn(s.bytesValue).isEqual(gn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return _e(s.geoPointValue.latitude)===_e(i.geoPointValue.latitude)&&_e(s.geoPointValue.longitude)===_e(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return _e(s.integerValue)===_e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=_e(s.doubleValue),c=_e(i.doubleValue);return a===c?ji(a)===ji(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return pr(n.arrayValue.values||[],e.arrayValue.values||[],bt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Ku(a)!==Ku(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!bt(a[l],c[l])))return!1;return!0})(n,e);default:return H(52216,{left:n})}}function vs(n,e){return(n.values||[]).find((t=>bt(t,e)))!==void 0}function yr(n,e){if(n===e)return 0;const t=pn(n),r=pn(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=_e(i.integerValue||i.doubleValue),l=_e(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Xu(n.timestampValue,e.timestampValue);case 4:return Xu(ws(n),ws(e));case 5:return ja(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=gn(i),l=gn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const f=ee(c[h],l[h]);if(f!==0)return f}return ee(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=ee(_e(i.latitude),_e(a.latitude));return c!==0?c:ee(_e(i.longitude),_e(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Yu(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[qi]?.arrayValue,f=l[qi]?.arrayValue,m=ee(h?.values?.length||0,f?.values?.length||0);return m!==0?m:Yu(h,f)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===di.mapValue&&a===di.mapValue)return 0;if(i===di.mapValue)return 1;if(a===di.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},f=Object.keys(h);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const p=ja(l[m],f[m]);if(p!==0)return p;const I=yr(c[l[m]],h[f[m]]);if(I!==0)return I}return ee(l.length,f.length)})(n.mapValue,e.mapValue);default:throw H(23264,{he:t})}}function Xu(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);const t=mn(n),r=mn(e),s=ee(t.seconds,r.seconds);return s!==0?s:ee(t.nanos,r.nanos)}function Yu(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=yr(t[s],r[s]);if(i)return i}return ee(t.length,r.length)}function wr(n){return za(n)}function za(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=mn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return gn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return j.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=za(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${za(t.fields[a])}`;return s+"}"})(n.mapValue):H(61005,{value:n})}function vi(n){switch(pn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=yo(n);return e?16+vi(e):16;case 5:return 2*n.stringValue.length;case 6:return gn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+vi(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return En(r.fields,((i,a)=>{s+=i.length+vi(a)})),s})(n.mapValue);default:throw H(13486,{value:n})}}function Ju(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function qa(n){return!!n&&"integerValue"in n}function Tc(n){return!!n&&"arrayValue"in n}function Zu(n){return!!n&&"nullValue"in n}function eh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ei(n){return!!n&&"mapValue"in n}function Pv(n){return(n?.mapValue?.fields||{})[gf]?.stringValue===pf}function ss(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return En(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ss(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ss(n.arrayValue.values[t]);return e}return{...n}}function Cv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Rv}class Ge{constructor(e){this.value=e}static empty(){return new Ge({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ei(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ss(t)}setAll(e){let t=ke.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=ss(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Ei(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return bt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Ei(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){En(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new Ge(ss(this.value))}}function _f(n){const e=[];return En(n.fields,((t,r)=>{const s=new ke([t]);if(Ei(r)){const i=_f(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ze(e)}class Ue{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ue(e,0,K.min(),K.min(),K.min(),Ge.empty(),0)}static newFoundDocument(e,t,r,s){return new Ue(e,1,t,K.min(),r,s,0)}static newNoDocument(e,t){return new Ue(e,2,t,K.min(),K.min(),Ge.empty(),0)}static newUnknownDocument(e,t){return new Ue(e,3,t,K.min(),K.min(),Ge.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ge.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ge.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ue&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ue(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Hi{constructor(e,t){this.position=e,this.inclusive=t}}function th(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=j.comparator(j.fromName(a.referenceValue),t.key):r=yr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function nh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!bt(n.position[t],e.position[t]))return!1;return!0}class Gi{constructor(e,t="asc"){this.field=e,this.dir=t}}function kv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class yf{}class Te extends yf{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Dv(e,t,r):t==="array-contains"?new Mv(e,r):t==="in"?new xv(e,r):t==="not-in"?new Lv(e,r):t==="array-contains-any"?new Uv(e,r):new Te(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Nv(e,r):new Ov(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(yr(t,this.value)):t!==null&&pn(this.value)===pn(t)&&this.matchesComparison(yr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends yf{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new mt(e,t)}matches(e){return wf(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function wf(n){return n.op==="and"}function vf(n){return Vv(n)&&wf(n)}function Vv(n){for(const e of n.filters)if(e instanceof mt)return!1;return!0}function Ha(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+wr(n.value);if(vf(n))return n.filters.map((e=>Ha(e))).join(",");{const e=n.filters.map((t=>Ha(t))).join(",");return`${n.op}(${e})`}}function Ef(n,e){return n instanceof Te?(function(r,s){return s instanceof Te&&r.op===s.op&&r.field.isEqual(s.field)&&bt(r.value,s.value)})(n,e):n instanceof mt?(function(r,s){return s instanceof mt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&Ef(a,s.filters[c])),!0):!1})(n,e):void H(19439)}function Tf(n){return n instanceof Te?(function(t){return`${t.field.canonicalString()} ${t.op} ${wr(t.value)}`})(n):n instanceof mt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Tf).join(" ,")+"}"})(n):"Filter"}class Dv extends Te{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){const t=j.comparator(e.key,this.key);return this.matchesComparison(t)}}class Nv extends Te{constructor(e,t){super(e,"in",t),this.keys=If("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Ov extends Te{constructor(e,t){super(e,"not-in",t),this.keys=If("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function If(n,e){return(e.arrayValue?.values||[]).map((t=>j.fromName(t.referenceValue)))}class Mv extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Tc(t)&&vs(t.arrayValue,this.value)}}class xv extends Te{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&vs(this.value.arrayValue,t)}}class Lv extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(vs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vs(this.value.arrayValue,t)}}class Uv extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Tc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>vs(this.value.arrayValue,r)))}}class Fv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function rh(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Fv(n,e,t,r,s,i,a)}function Ic(n){const e=X(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Ha(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),_o(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>wr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>wr(r))).join(",")),e.Te=t}return e.Te}function Ac(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!kv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ef(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!nh(n.startAt,e.startAt)&&nh(n.endAt,e.endAt)}function Ga(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ks{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function $v(n,e,t,r,s,i,a,c){return new ks(n,e,t,r,s,i,a,c)}function wo(n){return new ks(n)}function sh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Af(n){return n.collectionGroup!==null}function is(n){const e=X(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Re(ke.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Gi(i,r))})),t.has(ke.keyField().canonicalString())||e.Ie.push(new Gi(ke.keyField(),r))}return e.Ie}function Et(n){const e=X(n);return e.Ee||(e.Ee=Bv(e,is(n))),e.Ee}function Bv(n,e){if(n.limitType==="F")return rh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Gi(s.field,i)}));const t=n.endAt?new Hi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Hi(n.startAt.position,n.startAt.inclusive):null;return rh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Wa(n,e){const t=n.filters.concat([e]);return new ks(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ka(n,e,t){return new ks(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vo(n,e){return Ac(Et(n),Et(e))&&n.limitType===e.limitType}function bf(n){return`${Ic(Et(n))}|lt:${n.limitType}`}function Jn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Tf(s))).join(", ")}]`),_o(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>wr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>wr(s))).join(",")),`Target(${r})`})(Et(n))}; limitType=${n.limitType})`}function Eo(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):j.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of is(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=th(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,is(r),s)||r.endAt&&!(function(a,c,l){const h=th(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,is(r),s))})(n,e)}function jv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Sf(n){return(e,t)=>{let r=!1;for(const s of is(n)){const i=zv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function zv(n,e,t){const r=n.field.isKeyField()?j.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?yr(l,h):H(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H(19790,{direction:n.dir})}}class zn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){En(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return lf(this.inner)}size(){return this.innerSize}}const qv=new me(j.comparator);function Ft(){return qv}const Rf=new me(j.comparator);function Zr(...n){let e=Rf;for(const t of n)e=e.insert(t.key,t);return e}function Pf(n){let e=Rf;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function On(){return os()}function Cf(){return os()}function os(){return new zn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Hv=new me(j.comparator),Gv=new Re(j.comparator);function te(...n){let e=Gv;for(const t of n)e=e.add(t);return e}const Wv=new Re(ee);function Kv(){return Wv}function bc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ji(e)?"-0":e}}function kf(n){return{integerValue:""+n}}function Qv(n,e){return Tv(e)?kf(e):bc(n,e)}class To{constructor(){this._=void 0}}function Xv(n,e,t){return n instanceof Wi?(function(s,i){const a={fields:{[df]:{stringValue:hf},[mf]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ec(i)&&(i=yo(i)),i&&(a.fields[ff]=i),{mapValue:a}})(t,e):n instanceof Es?Df(n,e):n instanceof Ts?Nf(n,e):(function(s,i){const a=Vf(s,i),c=ih(a)+ih(s.Ae);return qa(a)&&qa(s.Ae)?kf(c):bc(s.serializer,c)})(n,e)}function Yv(n,e,t){return n instanceof Es?Df(n,e):n instanceof Ts?Nf(n,e):t}function Vf(n,e){return n instanceof Ki?(function(r){return qa(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Wi extends To{}class Es extends To{constructor(e){super(),this.elements=e}}function Df(n,e){const t=Of(e);for(const r of n.elements)t.some((s=>bt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Ts extends To{constructor(e){super(),this.elements=e}}function Nf(n,e){let t=Of(e);for(const r of n.elements)t=t.filter((s=>!bt(s,r)));return{arrayValue:{values:t}}}class Ki extends To{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ih(n){return _e(n.integerValue||n.doubleValue)}function Of(n){return Tc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Jv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Es&&s instanceof Es||r instanceof Ts&&s instanceof Ts?pr(r.elements,s.elements,bt):r instanceof Ki&&s instanceof Ki?bt(r.Ae,s.Ae):r instanceof Wi&&s instanceof Wi})(n.transform,e.transform)}class Zv{constructor(e,t){this.version=e,this.transformResults=t}}class lt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lt}static exists(e){return new lt(void 0,e)}static updateTime(e){return new lt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ti(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Io{}function Mf(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Sc(n.key,lt.none()):new Vs(n.key,n.data,lt.none());{const t=n.data,r=Ge.empty();let s=new Re(ke.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Tn(n.key,r,new Ze(s.toArray()),lt.none())}}function e1(n,e,t){n instanceof Vs?(function(s,i,a){const c=s.value.clone(),l=ah(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Tn?(function(s,i,a){if(!Ti(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=ah(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(xf(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function as(n,e,t,r){return n instanceof Vs?(function(i,a,c,l){if(!Ti(i.precondition,a))return c;const h=i.value.clone(),f=ch(i.fieldTransforms,l,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Tn?(function(i,a,c,l){if(!Ti(i.precondition,a))return c;const h=ch(i.fieldTransforms,l,a),f=a.data;return f.setAll(xf(i)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return Ti(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function t1(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Vf(r.transform,s||null);i!=null&&(t===null&&(t=Ge.empty()),t.set(r.field,i))}return t||null}function oh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&pr(r,s,((i,a)=>Jv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Vs extends Io{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Tn extends Io{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function xf(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function ah(n,e,t){const r=new Map;oe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Yv(a,c,t[s]))}return r}function ch(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Xv(i,a,e))}return r}class Sc extends Io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class n1 extends Io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class r1{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&e1(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=as(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=as(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Cf();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Mf(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(K.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),te())}isEqual(e){return this.batchId===e.batchId&&pr(this.mutations,e.mutations,((t,r)=>oh(t,r)))&&pr(this.baseMutations,e.baseMutations,((t,r)=>oh(t,r)))}}class Rc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return Hv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Rc(e,t,r,s)}}class s1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class i1{constructor(e,t){this.count=e,this.unchangedNames=t}}var we,ne;function o1(n){switch(n){case k.OK:return H(64938);case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0;default:return H(15467,{code:n})}}function Lf(n){if(n===void 0)return Ut("GRPC error has no .code"),k.UNKNOWN;switch(n){case we.OK:return k.OK;case we.CANCELLED:return k.CANCELLED;case we.UNKNOWN:return k.UNKNOWN;case we.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case we.INTERNAL:return k.INTERNAL;case we.UNAVAILABLE:return k.UNAVAILABLE;case we.UNAUTHENTICATED:return k.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case we.NOT_FOUND:return k.NOT_FOUND;case we.ALREADY_EXISTS:return k.ALREADY_EXISTS;case we.PERMISSION_DENIED:return k.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case we.ABORTED:return k.ABORTED;case we.OUT_OF_RANGE:return k.OUT_OF_RANGE;case we.UNIMPLEMENTED:return k.UNIMPLEMENTED;case we.DATA_LOSS:return k.DATA_LOSS;default:return H(39323,{code:n})}}(ne=we||(we={}))[ne.OK=0]="OK",ne[ne.CANCELLED=1]="CANCELLED",ne[ne.UNKNOWN=2]="UNKNOWN",ne[ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ne[ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ne[ne.NOT_FOUND=5]="NOT_FOUND",ne[ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",ne[ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",ne[ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",ne[ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ne[ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ne[ne.ABORTED=10]="ABORTED",ne[ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",ne[ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",ne[ne.INTERNAL=13]="INTERNAL",ne[ne.UNAVAILABLE=14]="UNAVAILABLE",ne[ne.DATA_LOSS=15]="DATA_LOSS";function a1(){return new TextEncoder}const c1=new ln([4294967295,4294967295],0);function lh(n){const e=a1().encode(n),t=new Qd;return t.update(e),new Uint8Array(t.digest())}function uh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ln([t,r],0),new ln([s,i],0)]}class Pc{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new es(`Invalid padding: ${t}`);if(r<0)throw new es(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new es(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new es(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ln.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(ln.fromNumber(r)));return s.compare(c1)===1&&(s=new ln([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=lh(e),[r,s]=uh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Pc(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=lh(e),[r,s]=uh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class es extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ao{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ds.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ao(K.min(),s,new me(ee),Ft(),te())}}class Ds{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ds(r,t,te(),te(),te())}}class Ii{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Uf{constructor(e,t){this.targetId=e,this.Ce=t}}class Ff{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class hh{constructor(){this.ve=0,this.Fe=dh(),this.Me=Ve.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=te(),t=te(),r=te();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:H(38017,{changeType:i})}})),new Ds(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=dh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class l1{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ft(),this.Je=fi(),this.He=fi(),this.Ye=new me(ee)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:H(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Ga(i))if(r===0){const a=new j(i.path);this.et(t,a,Ue.newNoDocument(a,K.min()))}else oe(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=gn(r).toUint8Array()}catch(l){if(l instanceof uf)return Fn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Pc(a,s,i)}catch(l){return Fn(l instanceof es?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Ga(c.target)){const l=new j(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Ue.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=te();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Ao(e,t,this.Ye,this.je,r);return this.je=Ft(),this.Je=fi(),this.He=fi(),this.Ye=new me(ee),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new hh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Re(ee),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Re(ee),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new hh),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fi(){return new me(j.comparator)}function dh(){return new me(j.comparator)}const u1={asc:"ASCENDING",desc:"DESCENDING"},h1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},d1={and:"AND",or:"OR"};class f1{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qa(n,e){return n.useProto3Json||_o(e)?e:{value:e}}function Qi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $f(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function m1(n,e){return Qi(n,e.toTimestamp())}function Tt(n){return oe(!!n,49232),K.fromTimestamp((function(t){const r=mn(t);return new le(r.seconds,r.nanos)})(n))}function Cc(n,e){return Xa(n,e).canonicalString()}function Xa(n,e){const t=(function(s){return new ue(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Bf(n){const e=ue.fromString(n);return oe(Gf(e),10190,{key:e.toString()}),e}function Ya(n,e){return Cc(n.databaseId,e.path)}function wa(n,e){const t=Bf(e);if(t.get(1)!==n.databaseId.projectId)throw new L(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(zf(t))}function jf(n,e){return Cc(n.databaseId,e)}function g1(n){const e=Bf(n);return e.length===4?ue.emptyPath():zf(e)}function Ja(n){return new ue(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function zf(n){return oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function fh(n,e,t){return{name:Ya(n,e),fields:t.value.mapValue.fields}}function p1(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:H(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,f){return h.useProto3Json?(oe(f===void 0||typeof f=="string",58123),Ve.fromBase64String(f||"")):(oe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ve.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const f=h.code===void 0?k.UNKNOWN:Lf(h.code);return new L(f,h.message||"")})(a);t=new Ff(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wa(n,r.document.name),i=Tt(r.document.updateTime),a=r.document.createTime?Tt(r.document.createTime):K.min(),c=new Ge({mapValue:{fields:r.document.fields}}),l=Ue.newFoundDocument(s,i,a,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new Ii(h,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wa(n,r.document),i=r.readTime?Tt(r.readTime):K.min(),a=Ue.newNoDocument(s,i),c=r.removedTargetIds||[];t=new Ii([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wa(n,r.document),i=r.removedTargetIds||[];t=new Ii([],i,s,null)}else{if(!("filter"in e))return H(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new i1(s,i),c=r.targetId;t=new Uf(c,a)}}return t}function _1(n,e){let t;if(e instanceof Vs)t={update:fh(n,e.key,e.value)};else if(e instanceof Sc)t={delete:Ya(n,e.key)};else if(e instanceof Tn)t={update:fh(n,e.key,e.data),updateMask:S1(e.fieldMask)};else{if(!(e instanceof n1))return H(16599,{Vt:e.type});t={verify:Ya(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Wi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Es)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ts)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ki)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw H(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:m1(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:H(27497)})(n,e.precondition)),t}function y1(n,e){return n&&n.length>0?(oe(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?Tt(s.updateTime):Tt(i);return a.isEqual(K.min())&&(a=Tt(i)),new Zv(a,s.transformResults||[])})(t,e)))):[]}function w1(n,e){return{documents:[jf(n,e.path)]}}function v1(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=jf(n,s);const i=(function(h){if(h.length!==0)return Hf(mt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((f=>(function(p){return{field:Zn(p.field),direction:I1(p.dir)}})(f)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Qa(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function E1(n){let e=g1(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){oe(r===1,65062);const f=t.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=(function(m){const p=qf(m);return p instanceof mt&&vf(p)?p.getFilters():[p]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((p=>(function(P){return new Gi(er(P.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(p)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let p;return p=typeof m=="object"?m.value:m,_o(p)?null:p})(t.limit));let l=null;t.startAt&&(l=(function(m){const p=!!m.before,I=m.values||[];return new Hi(I,p)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const p=!m.before,I=m.values||[];return new Hi(I,p)})(t.endAt)),$v(e,s,a,i,c,"F",l,h)}function T1(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function qf(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=er(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=er(t.unaryFilter.field);return Te.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=er(t.unaryFilter.field);return Te.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=er(t.unaryFilter.field);return Te.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return H(61313);default:return H(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Te.create(er(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return H(58110);default:return H(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mt.create(t.compositeFilter.filters.map((r=>qf(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return H(1026)}})(t.compositeFilter.op))})(n):H(30097,{filter:n})}function I1(n){return u1[n]}function A1(n){return h1[n]}function b1(n){return d1[n]}function Zn(n){return{fieldPath:n.canonicalString()}}function er(n){return ke.fromServerFormat(n.fieldPath)}function Hf(n){return n instanceof Te?(function(t){if(t.op==="=="){if(eh(t.value))return{unaryFilter:{field:Zn(t.field),op:"IS_NAN"}};if(Zu(t.value))return{unaryFilter:{field:Zn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(eh(t.value))return{unaryFilter:{field:Zn(t.field),op:"IS_NOT_NAN"}};if(Zu(t.value))return{unaryFilter:{field:Zn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zn(t.field),op:A1(t.op),value:t.value}}})(n):n instanceof mt?(function(t){const r=t.getFilters().map((s=>Hf(s)));return r.length===1?r[0]:{compositeFilter:{op:b1(t.op),filters:r}}})(n):H(54877,{filter:n})}function S1(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Gf(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class sn{constructor(e,t,r,s,i=K.min(),a=K.min(),c=Ve.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new sn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new sn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class R1{constructor(e){this.yt=e}}function P1(n){const e=E1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ka(e,e.limit,"L"):e}class C1{constructor(){this.Cn=new k1}addToCollectionParentIndex(e,t){return this.Cn.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(fn.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}}class k1{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Re(ue.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Re(ue.comparator)).toArray()}}const mh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wf=41943040;class He{static withCacheSize(e){return new He(e,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}He.DEFAULT_COLLECTION_PERCENTILE=10,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,He.DEFAULT=new He(Wf,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),He.DISABLED=new He(-1,0,0);class vr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vr(0)}static cr(){return new vr(-1)}}const gh="LruGarbageCollector",V1=1048576;function ph([n,e],[t,r]){const s=ee(n,t);return s===0?ee(e,r):s}class D1{constructor(e){this.Ir=e,this.buffer=new Re(ph),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ph(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class N1{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){F(gh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vr(t)?F(gh,"Ignoring IndexedDB error during garbage collection: ",t):await kr(t)}await this.Vr(3e5)}))}}class O1{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return D.resolve(po.ce);const r=new D1(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(mh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mh):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),Yn()<=Z.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-f}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function M1(n,e){return new O1(n,e)}class x1{constructor(){this.changes=new zn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class L1{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class U1{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&as(r.mutation,s,Ze.empty(),le.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,te()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=te()){const s=On();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=Zr();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=On();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,te())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Ft();const a=os(),c=(function(){return os()})();return t.forEach(((l,h)=>{const f=r.get(h.key);s.has(h.key)&&(f===void 0||f.mutation instanceof Tn)?i=i.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),as(f.mutation,h,f.mutation.getFieldMask(),le.now())):a.set(h.key,Ze.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,f)=>a.set(h,f))),t.forEach(((h,f)=>c.set(h,new L1(f,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=os();let s=new me(((a,c)=>a-c)),i=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let f=r.get(l)||Ze.empty();f=c.applyToLocalView(h,f),r.set(l,f);const m=(s.get(c.batchId)||te()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,f=l.value,m=Cf();f.forEach((p=>{if(!i.has(p)){const I=Mf(t.get(p),r.get(p));I!==null&&m.set(p,I),i=i.add(p)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return D.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return j.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Af(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):D.resolve(On());let c=ys,l=i;return a.next((h=>D.forEach(h,((f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?D.resolve():this.remoteDocumentCache.getEntry(e,f).next((p=>{l=l.insert(f,p)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,te()))).next((f=>({batchId:c,changes:Pf(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next((r=>{let s=Zr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=Zr();return this.indexManager.getCollectionParents(e,i).next((c=>D.forEach(c,(l=>{const h=(function(m,p){return new ks(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((f=>{f.forEach(((m,p)=>{a=a.insert(m,p)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Ue.newInvalidDocument(f)))}));let c=Zr();return a.forEach(((l,h)=>{const f=i.get(l);f!==void 0&&as(f.mutation,h,Ze.empty(),le.now()),Eo(t,h)&&(c=c.insert(l,h))})),c}))}}class F1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return D.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Tt(s.createTime)}})(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:P1(s.bundledQuery),readTime:Tt(s.readTime)}})(t)),D.resolve()}}class $1{constructor(){this.overlays=new me(j.comparator),this.qr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){const r=On();return D.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),D.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){const s=On(),i=t.length+1,a=new j(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return D.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new me(((h,f)=>h-f));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=i.get(h.largestBatchId);f===null&&(f=On(),i=i.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=On(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,f)=>c.set(h,f))),!(c.size()>=s)););return D.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new s1(t,r));let i=this.qr.get(t);i===void 0&&(i=te(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class B1{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}}class kc{constructor(){this.Qr=new Re(Ce.$r),this.Ur=new Re(Ce.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ce(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ce(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new j(new ue([])),r=new Ce(t,e),s=new Ce(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new j(new ue([])),r=new Ce(t,e),s=new Ce(t,e+1);let i=te();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Ce(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ce{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return j.comparator(e.key,t.key)||ee(e.Yr,t.Yr)}static Kr(e,t){return ee(e.Yr,t.Yr)||j.comparator(e.key,t.key)}}class j1{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Re(Ce.$r)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new r1(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ce(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return D.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?vc:this.tr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ce(t,0),s=new Ce(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),D.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ee);return t.forEach((s=>{const i=new Ce(s,0),a=new Ce(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),D.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;j.isDocumentKey(i)||(i=i.child(""));const a=new Ce(new j(i),0);let c=new Re(ee);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),D.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return D.forEach(t.mutations,(s=>{const i=new Ce(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ce(t,0),s=this.Zr.firstAfterOrEqual(r);return D.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class z1{constructor(e){this.ri=e,this.docs=(function(){return new me(j.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():Ue.newInvalidDocument(t))}getEntries(e,t){let r=Ft();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ue.newInvalidDocument(s))})),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ft();const a=t.path,c=new j(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:f}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||yv(_v(f),r)<=0||(s.has(f.key)||Eo(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return D.resolve(i)}getAllFromCollectionGroup(e,t,r,s){H(9500)}ii(e,t){return D.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new q1(this)}getSize(e){return D.resolve(this.size)}}class q1 extends x1{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),D.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class H1{constructor(e){this.persistence=e,this.si=new zn((t=>Ic(t)),Ac),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.oi=0,this._i=new kc,this.targetCount=0,this.ai=vr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),D.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Pr(t),D.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),D.waitFor(i).next((()=>s))}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),D.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),D.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this._i.containsKey(t))}}class Kf{constructor(e,t){this.ui={},this.overlays={},this.ci=new po(0),this.li=!1,this.li=!0,this.hi=new B1,this.referenceDelegate=e(this),this.Pi=new H1(this),this.indexManager=new C1,this.remoteDocumentCache=(function(s){return new z1(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new R1(t),this.Ii=new F1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $1,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new j1(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);const s=new G1(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return D.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class G1 extends vv{constructor(e){super(),this.currentSequenceNumber=e}}class Vc{constructor(e){this.persistence=e,this.Ri=new kc,this.Vi=null}static mi(e){return new Vc(e)}get fi(){if(this.Vi)return this.Vi;throw H(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),D.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.fi,(r=>{const s=j.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,K.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return D.or([()=>D.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Xi{constructor(e,t){this.persistence=e,this.pi=new zn((r=>Iv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=M1(this,t)}static mi(e,t){return new Xi(e,t)}Ei(){}di(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return D.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?D.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,K.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vi(e.data.value)),t}br(e,t,r){return D.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return D.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Dc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=te(),s=te();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Dc(e,t.fromCache,r,s)}}class W1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class K1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return zy()?8:Ev($e())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new W1;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(Yn()<=Z.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),D.resolve()):(Yn()<=Z.DEBUG&&F("QueryEngine","Query:",Jn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Yn()<=Z.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Et(t))):D.resolve())}ys(e,t){if(sh(t))return D.resolve(null);let r=Et(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Ka(t,null,"F"),r=Et(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=te(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,Ka(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return sh(t)||s.isEqual(K.min())?D.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?D.resolve(null):(Yn()<=Z.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Jn(t)),this.vs(e,a,t,pv(s,ys)).next((c=>c)))}))}Ds(e,t){let r=new Re(Sf(e));return t.forEach(((s,i)=>{Eo(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return Yn()<=Z.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Jn(t)),this.ps.getDocumentsMatchingQuery(e,t,fn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Nc="LocalStore",Q1=3e8;class X1{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new me(ee),this.xs=new zn((i=>Ic(i)),Ac),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Y1(n,e,t,r){return new X1(n,e,t,r)}async function Qf(n,e){const t=X(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=te();for(const h of s){a.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}for(const h of i){c.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function J1(n,e){const t=X(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,f){const m=h.batch,p=m.keys();let I=D.resolve();return p.forEach((P=>{I=I.next((()=>f.getEntry(l,P))).next((C=>{const R=h.docVersions.get(P);oe(R!==null,48541),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))}))})),I.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=te();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Xf(n){const e=X(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Z1(n,e){const t=X(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((f,m)=>{const p=s.get(m);if(!p)return;c.push(t.Pi.removeMatchingKeys(i,f.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,f.addedDocuments,m))));let I=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?I=I.withResumeToken(Ve.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):f.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(f.resumeToken,r)),s=s.insert(m,I),(function(C,R,N){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Q1?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0})(p,I,f)&&c.push(t.Pi.updateTargetData(i,I))}));let l=Ft(),h=te();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))})),c.push(eE(i,a,e.documentUpdates).next((f=>{l=f.ks,h=f.qs}))),!r.isEqual(K.min())){const f=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(f)}return D.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function eE(n,e,t){let r=te(),s=te();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Ft();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(K.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):F(Nc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function tE(n,e){const t=X(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=vc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function nE(n,e){const t=X(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,D.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new sn(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Za(n,e,t){const r=X(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Vr(a))throw a;F(Nc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function _h(n,e,t){const r=X(n);let s=K.min(),i=te();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,f){const m=X(l),p=m.xs.get(f);return p!==void 0?D.resolve(m.Ms.get(p)):m.Pi.getTargetData(h,f)})(r,a,Et(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:K.min(),t?i:te()))).next((c=>(rE(r,jv(e),c),{documents:c,Qs:i})))))}function rE(n,e,t){let r=n.Os.get(e)||K.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class yh{constructor(){this.activeTargetIds=Kv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sE{constructor(){this.Mo=new yh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class iE{Oo(e){}shutdown(){}}const wh="ConnectivityMonitor";class vh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){F(wh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){F(wh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let mi=null;function ec(){return mi===null?mi=(function(){return 268435456+Math.round(2147483648*Math.random())})():mi++,"0x"+mi.toString(16)}const va="RestConnection",oE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aE{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===zi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=ec(),c=this.zo(e,t.toUriEncodedString());F(va,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),f=Rr(h);return this.Jo(e,c,l,r,f).then((m=>(F(va,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw Fn(va,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Cr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=oE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class cE{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Me="WebChannelConnection";class lE extends aE{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=ec();return new Promise(((c,l)=>{const h=new Xd;h.setWithCredentials(!0),h.listenOnce(Yd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case wi.NO_ERROR:const m=h.getResponseJson();F(Me,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case wi.TIMEOUT:F(Me,`RPC '${e}' ${a} timed out`),l(new L(k.DEADLINE_EXCEEDED,"Request time out"));break;case wi.HTTP_ERROR:const p=h.getStatus();if(F(Me,`RPC '${e}' ${a} failed with status:`,p,"response text:",h.getResponseText()),p>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const P=I?.error;if(P&&P.status&&P.message){const C=(function(N){const V=N.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf(V)>=0?V:k.UNKNOWN})(P.status);l(new L(C,P.message))}else l(new L(k.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new L(k.UNAVAILABLE,"Connection failed."));break;default:H(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{F(Me,`RPC '${e}' ${a} completed.`)}}));const f=JSON.stringify(s);F(Me,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",f,r,15)}))}T_(e,t,r){const s=ec(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ef(),c=Zd(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const f=i.join("");F(Me,`Creating RPC '${e}' stream ${s}: ${f}`,l);const m=a.createWebChannel(f,l);this.I_(m);let p=!1,I=!1;const P=new cE({Yo:R=>{I?F(Me,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(p||(F(Me,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),F(Me,`RPC '${e}' stream ${s} sending:`,R),m.send(R))},Zo:()=>m.close()}),C=(R,N,V)=>{R.listen(N,(O=>{try{V(O)}catch($){setTimeout((()=>{throw $}),0)}}))};return C(m,Jr.EventType.OPEN,(()=>{I||(F(Me,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),C(m,Jr.EventType.CLOSE,(()=>{I||(I=!0,F(Me,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(m))})),C(m,Jr.EventType.ERROR,(R=>{I||(I=!0,Fn(Me,`RPC '${e}' stream ${s} transport errored. Name:`,R.name,"Message:",R.message),P.a_(new L(k.UNAVAILABLE,"The operation could not be completed")))})),C(m,Jr.EventType.MESSAGE,(R=>{if(!I){const N=R.data[0];oe(!!N,16349);const V=N,O=V?.error||V[0]?.error;if(O){F(Me,`RPC '${e}' stream ${s} received error:`,O);const $=O.status;let U=(function(y){const _=we[y];if(_!==void 0)return Lf(_)})($),B=O.message;U===void 0&&(U=k.INTERNAL,B="Unknown error status: "+$+" with message "+O.message),I=!0,P.a_(new L(U,B)),m.close()}else F(Me,`RPC '${e}' stream ${s} received:`,N),P.u_(N)}})),C(c,Jd.STAT_EVENT,(R=>{R.stat===Ba.PROXY?F(Me,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Ba.NOPROXY&&F(Me,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Ea(){return typeof document<"u"?document:null}function bo(n){return new f1(n,!0)}class Yf{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&F("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Eh="PersistentStream";class Jf{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Yf(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===k.RESOURCE_EXHAUSTED?(Ut(t.toString()),Ut("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new L(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return F(Eh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(F(Eh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uE extends Jf{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=p1(this.serializer,e),r=(function(i){if(!("targetChange"in i))return K.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Tt(a.readTime):K.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ja(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=Ga(l)?{documents:w1(i,l)}:{query:v1(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=$f(i,a.resumeToken);const h=Qa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(K.min())>0){c.readTime=Qi(i,a.snapshotVersion.toTimestamp());const h=Qa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=T1(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ja(this.serializer),t.removeTarget=e,this.q_(t)}}class hE extends Jf{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=y1(e.writeResults,e.commitTime),r=Tt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ja(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>_1(this.serializer,r)))};this.q_(t)}}class dE{}class fE extends dE{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new L(k.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Xa(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new L(k.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Xa(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(k.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class mE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ut(t),this.aa=!1):F("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const $n="RemoteStore";class gE{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{qn(this)&&(F($n,"Restarting streams for network reachability change."),await(async function(l){const h=X(l);h.Ea.add(4),await Ns(h),h.Ra.set("Unknown"),h.Ea.delete(4),await So(h)})(this))}))})),this.Ra=new mE(r,s)}}async function So(n){if(qn(n))for(const e of n.da)await e(!0)}async function Ns(n){for(const e of n.da)await e(!1)}function Zf(n,e){const t=X(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Lc(t)?xc(t):Dr(t).O_()&&Mc(t,e))}function Oc(n,e){const t=X(n),r=Dr(t);t.Ia.delete(e),r.O_()&&em(t,e),t.Ia.size===0&&(r.O_()?r.L_():qn(t)&&t.Ra.set("Unknown"))}function Mc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Dr(n).Y_(e)}function em(n,e){n.Va.Ue(e),Dr(n).Z_(e)}function xc(n){n.Va=new l1({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Dr(n).start(),n.Ra.ua()}function Lc(n){return qn(n)&&!Dr(n).x_()&&n.Ia.size>0}function qn(n){return X(n).Ea.size===0}function tm(n){n.Va=void 0}async function pE(n){n.Ra.set("Online")}async function _E(n){n.Ia.forEach(((e,t)=>{Mc(n,e)}))}async function yE(n,e){tm(n),Lc(n)?(n.Ra.ha(e),xc(n)):n.Ra.set("Unknown")}async function wE(n,e,t){if(n.Ra.set("Online"),e instanceof Ff&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){F($n,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Yi(n,r)}else if(e instanceof Ii?n.Va.Ze(e):e instanceof Uf?n.Va.st(e):n.Va.tt(e),!t.isEqual(K.min()))try{const r=await Xf(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const f=i.Ia.get(h);f&&i.Ia.set(h,f.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const f=i.Ia.get(l);if(!f)return;i.Ia.set(l,f.withResumeToken(Ve.EMPTY_BYTE_STRING,f.snapshotVersion)),em(i,l);const m=new sn(f.target,l,h,f.sequenceNumber);Mc(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){F($n,"Failed to raise snapshot:",r),await Yi(n,r)}}async function Yi(n,e,t){if(!Vr(e))throw e;n.Ea.add(1),await Ns(n),n.Ra.set("Offline"),t||(t=()=>Xf(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{F($n,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await So(n)}))}function nm(n,e){return e().catch((t=>Yi(n,t,e)))}async function Ro(n){const e=X(n),t=_n(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vc;for(;vE(e);)try{const s=await tE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,EE(e,s)}catch(s){await Yi(e,s)}rm(e)&&sm(e)}function vE(n){return qn(n)&&n.Ta.length<10}function EE(n,e){n.Ta.push(e);const t=_n(n);t.O_()&&t.X_&&t.ea(e.mutations)}function rm(n){return qn(n)&&!_n(n).x_()&&n.Ta.length>0}function sm(n){_n(n).start()}async function TE(n){_n(n).ra()}async function IE(n){const e=_n(n);for(const t of n.Ta)e.ea(t.mutations)}async function AE(n,e,t){const r=n.Ta.shift(),s=Rc.from(r,e,t);await nm(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Ro(n)}async function bE(n,e){e&&_n(n).X_&&await(async function(r,s){if((function(a){return o1(a)&&a!==k.ABORTED})(s.code)){const i=r.Ta.shift();_n(r).B_(),await nm(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Ro(r)}})(n,e),rm(n)&&sm(n)}async function Th(n,e){const t=X(n);t.asyncQueue.verifyOperationInProgress(),F($n,"RemoteStore received new credentials");const r=qn(t);t.Ea.add(3),await Ns(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await So(t)}async function SE(n,e){const t=X(n);e?(t.Ea.delete(2),await So(t)):e||(t.Ea.add(2),await Ns(t),t.Ra.set("Unknown"))}function Dr(n){return n.ma||(n.ma=(function(t,r,s){const i=X(t);return i.sa(),new uE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:pE.bind(null,n),t_:_E.bind(null,n),r_:yE.bind(null,n),H_:wE.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Lc(n)?xc(n):n.Ra.set("Unknown")):(await n.ma.stop(),tm(n))}))),n.ma}function _n(n){return n.fa||(n.fa=(function(t,r,s){const i=X(t);return i.sa(),new hE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:TE.bind(null,n),r_:bE.bind(null,n),ta:IE.bind(null,n),na:AE.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Ro(n)):(await n.fa.stop(),n.Ta.length>0&&(F($n,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Uc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Nt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new Uc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fc(n,e){if(Ut("AsyncQueue",`${e}: ${n}`),Vr(n))return new L(k.UNAVAILABLE,`${e}: ${n}`);throw n}class ar{static emptySet(e){return new ar(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=Zr(),this.sortedSet=new me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ar)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ar;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Ih{constructor(){this.ga=new me(j.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):H(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Er{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Er(e,t,ar.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class RE{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class PE{constructor(){this.queries=Ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=X(t),i=s.queries;s.queries=Ah(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new L(k.ABORTED,"Firestore shutting down"))}}function Ah(){return new zn((n=>bf(n)),vo)}async function $c(n,e){const t=X(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new RE,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Fc(a,`Initialization of query '${Jn(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&jc(t)}async function Bc(n,e){const t=X(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function CE(n,e){const t=X(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&jc(t)}function kE(n,e,t){const r=X(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function jc(n){n.Ca.forEach((e=>{e.next()}))}var tc,bh;(bh=tc||(tc={})).Ma="default",bh.Cache="cache";class zc{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Er(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Er.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tc.Cache}}class im{constructor(e){this.key=e}}class om{constructor(e){this.key=e}}class VE{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=te(),this.mutatedKeys=te(),this.eu=Sf(e),this.tu=new ar(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Ih,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((f,m)=>{const p=s.get(f),I=Eo(this.query,m)?m:null,P=!!p&&this.mutatedKeys.has(p.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let R=!1;p&&I?p.data.isEqual(I.data)?P!==C&&(r.track({type:3,doc:I}),R=!0):this.su(p,I)||(r.track({type:2,doc:I}),R=!0,(l&&this.eu(I,l)>0||h&&this.eu(I,h)<0)&&(c=!0)):!p&&I?(r.track({type:0,doc:I}),R=!0):p&&!I&&(r.track({type:1,doc:p}),R=!0,(l||h)&&(c=!0)),R&&(I?(a=a.add(I),i=C?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((f,m)=>(function(I,P){const C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H(20277,{Rt:R})}};return C(I)-C(P)})(f.type,m.type)||this.eu(f.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new Er(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ih,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=te(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new om(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new im(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=te();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Er.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const qc="SyncEngine";class DE{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class NE{constructor(e){this.key=e,this.hu=!1}}class OE{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new zn((c=>bf(c)),vo),this.Iu=new Map,this.Eu=new Set,this.du=new me(j.comparator),this.Au=new Map,this.Ru=new kc,this.Vu={},this.mu=new Map,this.fu=vr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ME(n,e,t=!0){const r=dm(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await am(r,e,t,!0),s}async function xE(n,e){const t=dm(n);await am(t,e,!0,!1)}async function am(n,e,t,r){const s=await nE(n.localStore,Et(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await LE(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&Zf(n.remoteStore,s),c}async function LE(n,e,t,r,s){n.pu=(m,p,I)=>(async function(C,R,N,V){let O=R.view.ru(N);O.Cs&&(O=await _h(C.localStore,R.query,!1).then((({documents:E})=>R.view.ru(E,O))));const $=V&&V.targetChanges.get(R.targetId),U=V&&V.targetMismatches.get(R.targetId)!=null,B=R.view.applyChanges(O,C.isPrimaryClient,$,U);return Rh(C,R.targetId,B.au),B.snapshot})(n,m,p,I);const i=await _h(n.localStore,e,!0),a=new VE(e,i.Qs),c=a.ru(i.documents),l=Ds.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Rh(n,t,h.au);const f=new DE(e,t,a);return n.Tu.set(e,f),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function UE(n,e,t){const r=X(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!vo(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Za(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Oc(r.remoteStore,s.targetId),nc(r,s.targetId)})).catch(kr)):(nc(r,s.targetId),await Za(r.localStore,s.targetId,!0))}async function FE(n,e){const t=X(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Oc(t.remoteStore,r.targetId))}async function $E(n,e,t){const r=WE(n);try{const s=await(function(a,c){const l=X(a),h=le.now(),f=c.reduce(((I,P)=>I.add(P.key)),te());let m,p;return l.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let P=Ft(),C=te();return l.Ns.getEntries(I,f).next((R=>{P=R,P.forEach(((N,V)=>{V.isValidDocument()||(C=C.add(N))}))})).next((()=>l.localDocuments.getOverlayedDocuments(I,P))).next((R=>{m=R;const N=[];for(const V of c){const O=t1(V,m.get(V.key).overlayedDocument);O!=null&&N.push(new Tn(V.key,O,_f(O.value.mapValue),lt.exists(!0)))}return l.mutationQueue.addMutationBatch(I,h,N,c)})).next((R=>{p=R;const N=R.applyToLocalDocumentSet(m,C);return l.documentOverlayCache.saveOverlays(I,R.batchId,N)}))})).then((()=>({batchId:p.batchId,changes:Pf(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new me(ee)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Os(r,s.changes),await Ro(r.remoteStore)}catch(s){const i=Fc(s,"Failed to persist write");t.reject(i)}}async function cm(n,e){const t=X(n);try{const r=await Z1(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?oe(a.hu,14607):s.removedDocuments.size>0&&(oe(a.hu,42227),a.hu=!1))})),await Os(t,r,e)}catch(r){await kr(r)}}function Sh(n,e,t){const r=X(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=X(a);l.onlineState=c;let h=!1;l.queries.forEach(((f,m)=>{for(const p of m.Sa)p.va(c)&&(h=!0)})),h&&jc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function BE(n,e,t){const r=X(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new me(j.comparator);a=a.insert(i,Ue.newNoDocument(i,K.min()));const c=te().add(i),l=new Ao(K.min(),new Map,new me(ee),a,c);await cm(r,l),r.du=r.du.remove(i),r.Au.delete(e),Hc(r)}else await Za(r.localStore,e,!1).then((()=>nc(r,e,t))).catch(kr)}async function jE(n,e){const t=X(n),r=e.batch.batchId;try{const s=await J1(t.localStore,e);um(t,r,null),lm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Os(t,s)}catch(s){await kr(s)}}async function zE(n,e,t){const r=X(n);try{const s=await(function(a,c){const l=X(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(oe(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,f,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>l.localDocuments.getDocuments(h,f)))}))})(r.localStore,e);um(r,e,t),lm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Os(r,s)}catch(s){await kr(s)}}function lm(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function um(n,e,t){const r=X(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function nc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||hm(n,r)}))}function hm(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Oc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Hc(n))}function Rh(n,e,t){for(const r of t)r instanceof im?(n.Ru.addReference(r.key,e),qE(n,r)):r instanceof om?(F(qc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||hm(n,r.key)):H(19791,{wu:r})}function qE(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(F(qc,"New document in limbo: "+t),n.Eu.add(r),Hc(n))}function Hc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new j(ue.fromString(e)),r=n.fu.next();n.Au.set(r,new NE(t)),n.du=n.du.insert(t,r),Zf(n.remoteStore,new sn(Et(wo(t.path)),r,"TargetPurposeLimboResolution",po.ce))}}async function Os(n,e,t){const r=X(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(h){s.push(h);const f=Dc.As(l.targetId,h);i.push(f)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const f=X(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>D.forEach(h,(p=>D.forEach(p.Es,(I=>f.persistence.referenceDelegate.addReference(m,p.targetId,I))).next((()=>D.forEach(p.ds,(I=>f.persistence.referenceDelegate.removeReference(m,p.targetId,I)))))))))}catch(m){if(!Vr(m))throw m;F(Nc,"Failed to update sequence numbers: "+m)}for(const m of h){const p=m.targetId;if(!m.fromCache){const I=f.Ms.get(p),P=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(P);f.Ms=f.Ms.insert(p,C)}}})(r.localStore,i))}async function HE(n,e){const t=X(n);if(!t.currentUser.isEqual(e)){F(qc,"User change. New user:",e.toKey());const r=await Qf(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new L(k.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Os(t,r.Ls)}}function GE(n,e){const t=X(n),r=t.Au.get(e);if(r&&r.hu)return te().add(r.key);{let s=te();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function dm(n){const e=X(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=cm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BE.bind(null,e),e.Pu.H_=CE.bind(null,e.eventManager),e.Pu.yu=kE.bind(null,e.eventManager),e}function WE(n){const e=X(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zE.bind(null,e),e}class Ji{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Y1(this.persistence,new K1,e.initialUser,this.serializer)}Cu(e){return new Kf(Vc.mi,this.serializer)}Du(e){return new sE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ji.provider={build:()=>new Ji};class KE extends Ji{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){oe(this.persistence.referenceDelegate instanceof Xi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new N1(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?He.withCacheSize(this.cacheSizeBytes):He.DEFAULT;return new Kf((r=>Xi.mi(r,t)),this.serializer)}}class rc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Sh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=HE.bind(null,this.syncEngine),await SE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new PE})()}createDatastore(e){const t=bo(e.databaseInfo.databaseId),r=(function(i){return new lE(i)})(e.databaseInfo);return(function(i,a,c,l){return new fE(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new gE(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Sh(this.syncEngine,t,0)),(function(){return vh.v()?new vh:new iE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,f){const m=new OE(s,i,a,c,l,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=X(t);F($n,"RemoteStore shutting down."),r.Ea.add(5),await Ns(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}rc.provider={build:()=>new rc};class Gc{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ut("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const yn="FirestoreClient";class QE{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Le.UNAUTHENTICATED,this.clientId=mo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{F(yn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(F(yn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Nt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Fc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ta(n,e){n.asyncQueue.verifyOperationInProgress(),F(yn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await Qf(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ph(n,e){n.asyncQueue.verifyOperationInProgress();const t=await XE(n);F(yn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Th(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Th(e.remoteStore,s))),n._onlineComponents=e}async function XE(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F(yn,"Using user provided OfflineComponentProvider");try{await Ta(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===k.FAILED_PRECONDITION||s.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Fn("Error using user provided cache. Falling back to memory cache: "+t),await Ta(n,new Ji)}}else F(yn,"Using default OfflineComponentProvider"),await Ta(n,new KE(void 0));return n._offlineComponents}async function fm(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(F(yn,"Using user provided OnlineComponentProvider"),await Ph(n,n._uninitializedComponentsProvider._online)):(F(yn,"Using default OnlineComponentProvider"),await Ph(n,new rc))),n._onlineComponents}function YE(n){return fm(n).then((e=>e.syncEngine))}async function Zi(n){const e=await fm(n),t=e.eventManager;return t.onListen=ME.bind(null,e.syncEngine),t.onUnlisten=UE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FE.bind(null,e.syncEngine),t}function JE(n,e,t={}){const r=new Nt;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,c,l,h){const f=new Gc({next:p=>{f.Nu(),a.enqueueAndForget((()=>Bc(i,m)));const I=p.docs.has(c);!I&&p.fromCache?h.reject(new L(k.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&p.fromCache&&l&&l.source==="server"?h.reject(new L(k.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(p)},error:p=>h.reject(p)}),m=new zc(wo(c.path),f,{includeMetadataChanges:!0,qa:!0});return $c(i,m)})(await Zi(n),n.asyncQueue,e,t,r))),r.promise}function ZE(n,e,t={}){const r=new Nt;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,c,l,h){const f=new Gc({next:p=>{f.Nu(),a.enqueueAndForget((()=>Bc(i,m))),p.fromCache&&l.source==="server"?h.reject(new L(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(p)},error:p=>h.reject(p)}),m=new zc(c,f,{includeMetadataChanges:!0,qa:!0});return $c(i,m)})(await Zi(n),n.asyncQueue,e,t,r))),r.promise}function mm(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Ch=new Map;const gm="firestore.googleapis.com",kh=!0;class Vh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gm,this.ssl=kh}else this.host=e.host,this.ssl=e.ssl??kh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Wf;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<V1)throw new L(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}of("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mm(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Po{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new rf;switch(r.type){case"firstParty":return new uv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Ch.get(t);r&&(F("ComponentProvider","Removing Datastore"),Ch.delete(t),r.terminate())})(this),Promise.resolve()}}function pm(n,e,t,r={}){n=We(n,Po);const s=Rr(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(Bd(`https://${c}`),jd("Firestore",!0)),i.host!==gm&&i.host!==c&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!xn(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Le.MOCK_USER;else{h=Oy(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new L(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Le(m)}n._authCredentials=new av(new nf(h,f))}}class In{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new In(this.firestore,e,this._query)}}class fe{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ot(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fe(this.firestore,e,this._key)}toJSON(){return{type:fe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Cs(t,fe._jsonSchema))return new fe(e,r||null,new j(ue.fromString(t.referencePath)))}}fe._jsonSchemaVersion="firestore/documentReference/1.0",fe._jsonSchema={type:Ie("string",fe._jsonSchemaVersion),referencePath:Ie("string")};class Ot extends In{constructor(e,t,r){super(e,t,wo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fe(this.firestore,null,new j(e))}withConverter(e){return new Ot(this.firestore,e,this._path)}}function Wc(n,e,...t){if(n=Be(n),sf("collection","path",e),n instanceof Po){const r=ue.fromString(e,...t);return qu(r),new Ot(n,null,r)}{if(!(n instanceof fe||n instanceof Ot))throw new L(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ue.fromString(e,...t));return qu(r),new Ot(n.firestore,null,r)}}function An(n,e,...t){if(n=Be(n),arguments.length===1&&(e=mo.newId()),sf("doc","path",e),n instanceof Po){const r=ue.fromString(e,...t);return zu(r),new fe(n,null,new j(r))}{if(!(n instanceof fe||n instanceof Ot))throw new L(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ue.fromString(e,...t));return zu(r),new fe(n.firestore,n instanceof Ot?n.converter:null,new j(r))}}const Dh="AsyncQueue";class Nh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Yf(this,"async_queue_retry"),this._c=()=>{const r=Ea();r&&F(Dh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Ea();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ea();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Nt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vr(e))throw e;F(Dh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ut("INTERNAL UNHANDLED ERROR: ",Oh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Uc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&H(47125,{Pc:Oh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Oh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Mh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class $t extends Po{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Nh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nh(e),this._firestoreClient=void 0,await e}}}function _m(n,e){const t=typeof n=="object"?n:Gd(),r=typeof n=="string"?n:zi,s=yc(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Dy("firestore");i&&pm(s,...i)}return s}function Ms(n){if(n._terminated)throw new L(k.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||eT(n),n._firestoreClient}function eT(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new Sv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,mm(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new QE(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class Je{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Je(Ve.fromBase64String(e))}catch(t){throw new L(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Je(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Je._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cs(e,Je._jsonSchema))return Je.fromBase64String(e.bytes)}}Je._jsonSchemaVersion="firestore/bytes/1.0",Je._jsonSchema={type:Ie("string",Je._jsonSchemaVersion),bytes:Ie("string")};class xs{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ke(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Co{constructor(e){this._methodName=e}}class ut{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ut._jsonSchemaVersion}}static fromJSON(e){if(Cs(e,ut._jsonSchema))return new ut(e.latitude,e.longitude)}}ut._jsonSchemaVersion="firestore/geoPoint/1.0",ut._jsonSchema={type:Ie("string",ut._jsonSchemaVersion),latitude:Ie("number"),longitude:Ie("number")};class ht{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ht._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cs(e,ht._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ht(e.vectorValues);throw new L(k.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ht._jsonSchemaVersion="firestore/vectorValue/1.0",ht._jsonSchema={type:Ie("string",ht._jsonSchemaVersion),vectorValues:Ie("object")};const tT=/^__.*__$/;class nT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Tn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vs(e,this.data,t,this.fieldTransforms)}}class ym{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Tn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H(40011,{Ac:n})}}class Kc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Kc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return eo(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(wm(this.Ac)&&tT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||bo(e)}Cc(e,t,r,s=!1){return new Kc({Ac:e,methodName:t,Dc:r,path:ke.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qc(n){const e=n._freezeSettings(),t=bo(n._databaseId);return new rT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sT(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Xc("Data must be an object, but it was:",a,r);const c=vm(r,a);let l,h;if(i.merge)l=new Ze(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const p=sc(e,m,t);if(!a.contains(p))throw new L(k.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Tm(f,p)||f.push(p)}l=new Ze(f),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new nT(new Ge(c),l,h)}class ko extends Co{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ko}}function iT(n,e,t,r){const s=n.Cc(1,e,t);Xc("Data must be an object, but it was:",s,r);const i=[],a=Ge.empty();En(r,((l,h)=>{const f=Yc(e,l,t);h=Be(h);const m=s.yc(f);if(h instanceof ko)i.push(f);else{const p=Ls(h,m);p!=null&&(i.push(f),a.set(f,p))}}));const c=new Ze(i);return new ym(a,c,s.fieldTransforms)}function oT(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[sc(e,r,t)],l=[s];if(i.length%2!=0)throw new L(k.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)c.push(sc(e,i[p])),l.push(i[p+1]);const h=[],f=Ge.empty();for(let p=c.length-1;p>=0;--p)if(!Tm(h,c[p])){const I=c[p];let P=l[p];P=Be(P);const C=a.yc(I);if(P instanceof ko)h.push(I);else{const R=Ls(P,C);R!=null&&(h.push(I),f.set(I,R))}}const m=new Ze(h);return new ym(f,m,a.fieldTransforms)}function aT(n,e,t,r=!1){return Ls(t,n.Cc(r?4:3,e))}function Ls(n,e){if(Em(n=Be(n)))return Xc("Unsupported field value:",e,n),vm(n,e);if(n instanceof Co)return(function(r,s){if(!wm(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=Ls(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=Be(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Qv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=le.fromDate(r);return{timestampValue:Qi(s.serializer,i)}}if(r instanceof le){const i=new le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Qi(s.serializer,i)}}if(r instanceof ut)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Je)return{bytesValue:$f(s.serializer,r._byteString)};if(r instanceof fe){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Cc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ht)return(function(a,c){return{mapValue:{fields:{[gf]:{stringValue:pf},[qi]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return bc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${go(r)}`)})(n,e)}function vm(n,e){const t={};return lf(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):En(n,((r,s)=>{const i=Ls(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Em(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof le||n instanceof ut||n instanceof Je||n instanceof fe||n instanceof Co||n instanceof ht)}function Xc(n,e,t){if(!Em(t)||!af(t)){const r=go(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function sc(n,e,t){if((e=Be(e))instanceof xs)return e._internalPath;if(typeof e=="string")return Yc(n,e);throw eo("Field path arguments must be of type string or ",n,!1,void 0,t)}const cT=new RegExp("[~\\*/\\[\\]]");function Yc(n,e,t){if(e.search(cT)>=0)throw eo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xs(...e.split("."))._internalPath}catch{throw eo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function eo(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new L(k.INVALID_ARGUMENT,c+n+l)}function Tm(n,e){return n.some((t=>t.isEqual(e)))}class Im{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Jc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lT extends Im{data(){return super.data()}}function Jc(n,e){return typeof e=="string"?Yc(n,e):e instanceof xs?e._internalPath:e._delegate._internalPath}function Am(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Zc{}class bm extends Zc{}function Sm(n,e,...t){let r=[];e instanceof Zc&&r.push(e),r=r.concat(t),(function(i){const a=i.filter((l=>l instanceof Vo)).length,c=i.filter((l=>l instanceof Us)).length;if(a>1||a>0&&c>0)throw new L(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Us extends bm{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Us(e,t,r)}_apply(e){const t=this._parse(e);return Pm(e._query,t),new In(e.firestore,e.converter,Wa(e._query,t))}_parse(e){const t=Qc(e.firestore);return(function(i,a,c,l,h,f,m){let p;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new L(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Lh(m,f);const P=[];for(const C of m)P.push(xh(l,i,C));p={arrayValue:{values:P}}}else p=xh(l,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Lh(m,f),p=aT(c,a,m,f==="in"||f==="not-in");return Te.create(h,f,p)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Rm(n,e,t){const r=e,s=Jc("where",n);return Us._create(s,r,t)}class Vo extends Zc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vo(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:mt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,i){let a=s;const c=i.getFlattenedFilters();for(const l of c)Pm(a,l),a=Wa(a,l)})(e._query,t),new In(e.firestore,e.converter,Wa(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function xh(n,e,t){if(typeof(t=Be(t))=="string"){if(t==="")throw new L(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Af(e)&&t.indexOf("/")!==-1)throw new L(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ue.fromString(t));if(!j.isDocumentKey(r))throw new L(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ju(n,new j(r))}if(t instanceof fe)return Ju(n,t._key);throw new L(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${go(t)}.`)}function Lh(n,e){if(!Array.isArray(n)||n.length===0)throw new L(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Pm(n,e){const t=(function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new L(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Cm{convertValue(e,t="none"){switch(pn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return En(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[qi].arrayValue?.values?.map((r=>_e(r.doubleValue)));return new ht(t)}convertGeoPoint(e){return new ut(_e(e.latitude),_e(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=yo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ws(e));default:return null}}convertTimestamp(e){const t=mn(e);return new le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ue.fromString(e);oe(Gf(r),9688,{name:e});const s=new _r(r.get(1),r.get(3)),i=new j(r.popFirst(5));return s.isEqual(t)||Ut(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function uT(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class tr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class un extends Im{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new cs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Jc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(k.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=un._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}un._jsonSchemaVersion="firestore/documentSnapshot/1.0",un._jsonSchema={type:Ie("string",un._jsonSchemaVersion),bundleSource:Ie("string","DocumentSnapshot"),bundleName:Ie("string"),bundle:Ie("string")};class cs extends un{data(e={}){return super.data(e)}}class hn{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new tr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new cs(this._firestore,this._userDataWriter,r.key,r,new tr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new cs(s._firestore,s._userDataWriter,c.doc.key,c.doc,new tr(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new cs(s._firestore,s._userDataWriter,c.doc.key,c.doc,new tr(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:hT(c.type),doc:l,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(k.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=mo.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function hT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H(61501,{type:n})}}function Tr(n){n=We(n,fe);const e=We(n.firestore,$t);return JE(Ms(e),n._key).then((t=>Om(e,n,t)))}hn._jsonSchemaVersion="firestore/querySnapshot/1.0",hn._jsonSchema={type:Ie("string",hn._jsonSchemaVersion),bundleSource:Ie("string","QuerySnapshot"),bundleName:Ie("string"),bundle:Ie("string")};class el extends Cm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Je(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new fe(this.firestore,null,t)}}function km(n){n=We(n,In);const e=We(n.firestore,$t),t=Ms(e),r=new el(e);return Am(n._query),ZE(t,n._query).then((s=>new hn(e,r,n,s)))}function Vm(n,e,t){n=We(n,fe);const r=We(n.firestore,$t),s=uT(n.converter,e);return Do(r,[sT(Qc(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,lt.none())])}function Ir(n,e,t,...r){n=We(n,fe);const s=We(n.firestore,$t),i=Qc(s);let a;return a=typeof(e=Be(e))=="string"||e instanceof xs?oT(i,"updateDoc",n._key,e,t,r):iT(i,"updateDoc",n._key,e),Do(s,[a.toMutation(n._key,lt.exists(!0))])}function Dm(n){return Do(We(n.firestore,$t),[new Sc(n._key,lt.none())])}function Nm(n,...e){n=Be(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Mh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Mh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof fe)a=We(n.firestore,$t),c=wo(n._key.path),i={next:l=>{e[r]&&e[r](Om(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=We(n,In);a=We(l.firestore,$t),c=l._query;const h=new el(a);i={next:f=>{e[r]&&e[r](new hn(a,h,l,f))},error:e[r+1],complete:e[r+2]},Am(n._query)}return(function(h,f,m,p){const I=new Gc(p),P=new zc(f,I,m);return h.asyncQueue.enqueueAndForget((async()=>$c(await Zi(h),P))),()=>{I.Nu(),h.asyncQueue.enqueueAndForget((async()=>Bc(await Zi(h),P)))}})(Ms(a),c,s,i)}function Do(n,e){return(function(r,s){const i=new Nt;return r.asyncQueue.enqueueAndForget((async()=>$E(await YE(r),s,i))),i.promise})(Ms(n),e)}function Om(n,e,t){const r=t.docs.get(e._key),s=new el(n);return new un(n,s,e._key,r,new tr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Cr=s})(Pr),gr(new Ln("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new $t(new cv(r.getProvider("auth-internal")),new hv(a,r.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _r(h.options.projectId,f)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),cn(Fu,$u,e),cn(Fu,$u,"esm2020")})();const Uh=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Cm,Bytes:Je,CollectionReference:Ot,DocumentReference:fe,DocumentSnapshot:un,FieldPath:xs,FieldValue:Co,Firestore:$t,FirestoreError:L,GeoPoint:ut,Query:In,QueryCompositeFilterConstraint:Vo,QueryConstraint:bm,QueryDocumentSnapshot:cs,QueryFieldFilterConstraint:Us,QuerySnapshot:hn,SnapshotMetadata:tr,Timestamp:le,VectorValue:ht,_AutoId:mo,_ByteString:Ve,_DatabaseId:_r,_DocumentKey:j,_EmptyAuthCredentialsProvider:rf,_FieldPath:ke,_cast:We,_logWarn:Fn,_validateIsNotUsedTogether:of,collection:Wc,connectFirestoreEmulator:pm,deleteDoc:Dm,doc:An,ensureFirestoreConfigured:Ms,executeWrite:Do,getDoc:Tr,getDocs:km,getFirestore:_m,onSnapshot:Nm,query:Sm,setDoc:Vm,updateDoc:Ir,where:Rm},Symbol.toStringTag,{value:"Module"}));var dT="firebase",fT="12.6.0";cn(dT,fT,"app");function Mm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mT=Mm,xm=new Rs("auth","Firebase",Mm());const to=new pc("@firebase/auth");function gT(n,...e){to.logLevel<=Z.WARN&&to.warn(`Auth (${Pr}): ${n}`,...e)}function Ai(n,...e){to.logLevel<=Z.ERROR&&to.error(`Auth (${Pr}): ${n}`,...e)}function Bt(n,...e){throw tl(n,...e)}function It(n,...e){return tl(n,...e)}function Lm(n,e,t){const r={...mT(),[e]:t};return new Rs("auth","Firebase",r).create(e,{appName:n.name})}function dn(n){return Lm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tl(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xm.create(n,...e)}function G(n,e,...t){if(!n)throw tl(e,...t)}function kt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ai(e),new Error(e)}function jt(n,e){n||kt(e)}function ic(){return typeof self<"u"&&self.location?.href||""}function pT(){return Fh()==="http:"||Fh()==="https:"}function Fh(){return typeof self<"u"&&self.location?.protocol||null}function _T(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pT()||$y()||"connection"in navigator)?navigator.onLine:!0}function yT(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Fs{constructor(e,t){this.shortDelay=e,this.longDelay=t,jt(t>e,"Short delay should be less than long delay!"),this.isMobile=Ly()||By()}get(){return _T()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function nl(n,e){jt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Um{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;kt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;kt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;kt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const vT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ET=new Fs(3e4,6e4);function No(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Nr(n,e,t,r,s={}){return Fm(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Ps({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return Fy()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Rr(n.emulatorConfig.host)&&(h.credentials="include"),Um.fetch()(await Bm(n,n.config.apiHost,t,c),h)})}async function Fm(n,e,t){n._canInitEmulator=!1;const r={...wT,...e};try{const s=new TT(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw gi(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw gi(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw gi(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw gi(n,"user-disabled",a);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Lm(n,f,h);Bt(n,f)}}catch(s){if(s instanceof zt)throw s;Bt(n,"network-request-failed",{message:String(s)})}}async function $m(n,e,t,r,s={}){const i=await Nr(n,e,t,r,s);return"mfaPendingCredential"in i&&Bt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Bm(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?nl(n.config,s):`${n.config.apiScheme}://${s}`;return vT.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class TT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(It(this.auth,"network-request-failed")),ET.get())})}}function gi(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=It(n,e,r);return s.customData._tokenResponse=t,s}async function IT(n,e){return Nr(n,"POST","/v1/accounts:delete",e)}async function no(n,e){return Nr(n,"POST","/v1/accounts:lookup",e)}function ls(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function AT(n,e=!1){const t=Be(n),r=await t.getIdToken(e),s=rl(r);G(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:ls(Ia(s.auth_time)),issuedAtTime:ls(Ia(s.iat)),expirationTime:ls(Ia(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Ia(n){return Number(n)*1e3}function rl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ai("JWT malformed, contained fewer than 3 sections"),null;try{const s=Ld(t);return s?JSON.parse(s):(Ai("Failed to decode base64 JWT payload"),null)}catch(s){return Ai("Caught error parsing JWT payload as JSON",s?.toString()),null}}function $h(n){const e=rl(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Is(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof zt&&bT(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function bT({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class ST{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class oc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ls(this.lastLoginAt),this.creationTime=ls(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ro(n){const e=n.auth,t=await n.getIdToken(),r=await Is(n,no(e,{idToken:t}));G(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?jm(s.providerUserInfo):[],a=PT(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new oc(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function RT(n){const e=Be(n);await ro(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PT(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function jm(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function CT(n,e){const t=await Fm(n,{},async()=>{const r=Ps({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Bm(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&Rr(n.emulatorConfig.host)&&(l.credentials="include"),Um.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kT(n,e){return Nr(n,"POST","/v2/accounts:revokeToken",No(n,e))}class cr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$h(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");const t=$h(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await CT(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new cr;return r&&(G(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(G(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(G(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cr,this.toJSON())}_performRefresh(){return kt("not implemented")}}function Jt(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ct{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ST(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new oc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Is(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return AT(this,e)}reload(){return RT(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ct({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ro(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ot(this.auth.app))return Promise.reject(dn(this.auth));const e=await this.getIdToken();return await Is(this,IT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:I,providerData:P,stsTokenManager:C}=t;G(m&&C,e,"internal-error");const R=cr.fromJSON(this.name,C);G(typeof m=="string",e,"internal-error"),Jt(r,e.name),Jt(s,e.name),G(typeof p=="boolean",e,"internal-error"),G(typeof I=="boolean",e,"internal-error"),Jt(i,e.name),Jt(a,e.name),Jt(c,e.name),Jt(l,e.name),Jt(h,e.name),Jt(f,e.name);const N=new ct({uid:m,auth:e,email:s,emailVerified:p,displayName:r,isAnonymous:I,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:R,createdAt:h,lastLoginAt:f});return P&&Array.isArray(P)&&(N.providerData=P.map(V=>({...V}))),l&&(N._redirectEventId=l),N}static async _fromIdTokenResponse(e,t,r=!1){const s=new cr;s.updateFromServerResponse(t);const i=new ct({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ro(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];G(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jm(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new cr;c.updateFromIdToken(r);const l=new ct({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new oc(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Bh=new Map;function Vt(n){jt(n instanceof Function,"Expected a class definition");let e=Bh.get(n);return e?(jt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Bh.set(n,e),e)}class zm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zm.type="NONE";const jh=zm;function bi(n,e,t){return`firebase:${n}:${e}:${t}`}class lr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=bi(this.userKey,s.apiKey,i),this.fullPersistenceKey=bi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await no(this.auth,{idToken:e}).catch(()=>{});return t?ct._fromGetAccountInfoResponse(this.auth,t,e):null}return ct._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new lr(Vt(jh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Vt(jh);const a=bi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const f=await h._get(a);if(f){let m;if(typeof f=="string"){const p=await no(e,{idToken:f}).catch(()=>{});if(!p)break;m=await ct._fromGetAccountInfoResponse(e,p,f)}else m=ct._fromJSON(e,f);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new lr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new lr(i,e,r))}}function zh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Qm(e))return"Blackberry";if(Xm(e))return"Webos";if(Hm(e))return"Safari";if((e.includes("chrome/")||Gm(e))&&!e.includes("edge/"))return"Chrome";if(Km(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function qm(n=$e()){return/firefox\//i.test(n)}function Hm(n=$e()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Gm(n=$e()){return/crios\//i.test(n)}function Wm(n=$e()){return/iemobile/i.test(n)}function Km(n=$e()){return/android/i.test(n)}function Qm(n=$e()){return/blackberry/i.test(n)}function Xm(n=$e()){return/webos/i.test(n)}function sl(n=$e()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function VT(n=$e()){return sl(n)&&!!window.navigator?.standalone}function DT(){return jy()&&document.documentMode===10}function Ym(n=$e()){return sl(n)||Km(n)||Xm(n)||Qm(n)||/windows phone/i.test(n)||Wm(n)}function Jm(n,e=[]){let t;switch(n){case"Browser":t=zh($e());break;case"Worker":t=`${zh($e())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pr}/${r}`}class NT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function OT(n,e={}){return Nr(n,"GET","/v2/passwordPolicy",No(n,e))}const MT=6;class xT{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??MT,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class LT{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qh(this),this.idTokenSubscription=new qh(this),this.beforeStateQueue=new NT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await lr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await no(this,{idToken:e}),r=await ct._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ot(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ro(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ot(this.app))return Promise.reject(dn(this));const t=e?Be(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ot(this.app)?Promise.reject(dn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ot(this.app)?Promise.reject(dn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OT(this),t=new xT(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Rs("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await kT(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vt(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=await lr.create(this,[Vt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Jm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ot(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&gT(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Oo(n){return Be(n)}class qh{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xy(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let il={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UT(n){il=n}function FT(n){return il.loadJS(n)}function $T(){return il.gapiScript}function BT(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function jT(n,e){const t=yc(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(xn(i,e??{}))return s;Bt(s,"already-initialized")}return t.initialize({options:e})}function zT(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Vt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function qT(n,e,t){const r=Oo(n);G(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Zm(e),{host:a,port:c}=HT(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},f=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){G(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),G(xn(h,r.config.emulator)&&xn(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Rr(a)?(Bd(`${i}//${a}${l}`),jd("Auth",!0)):GT()}function Zm(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HT(n){const e=Zm(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Hh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Hh(a)}}}function Hh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function GT(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class eg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return kt("not implemented")}_getIdTokenResponse(e){return kt("not implemented")}_linkToIdToken(e,t){return kt("not implemented")}_getReauthenticationResolver(e){return kt("not implemented")}}async function ur(n,e){return $m(n,"POST","/v1/accounts:signInWithIdp",No(n,e))}const WT="http://localhost";class Bn extends eg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Bn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Bt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Bn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ur(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ur(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ur(e,t)}buildRequest(){const e={requestUri:WT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ps(t)}return e}}class tg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $s extends tg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zt extends $s{constructor(){super("facebook.com")}static credential(e){return Bn._fromParams({providerId:Zt.PROVIDER_ID,signInMethod:Zt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zt.credentialFromTaggedObject(e)}static credentialFromError(e){return Zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zt.credential(e.oauthAccessToken)}catch{return null}}}Zt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zt.PROVIDER_ID="facebook.com";class en extends $s{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Bn._fromParams({providerId:en.PROVIDER_ID,signInMethod:en.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return en.credentialFromTaggedObject(e)}static credentialFromError(e){return en.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return en.credential(t,r)}catch{return null}}}en.GOOGLE_SIGN_IN_METHOD="google.com";en.PROVIDER_ID="google.com";class tn extends $s{constructor(){super("github.com")}static credential(e){return Bn._fromParams({providerId:tn.PROVIDER_ID,signInMethod:tn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tn.credentialFromTaggedObject(e)}static credentialFromError(e){return tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tn.credential(e.oauthAccessToken)}catch{return null}}}tn.GITHUB_SIGN_IN_METHOD="github.com";tn.PROVIDER_ID="github.com";class nn extends $s{constructor(){super("twitter.com")}static credential(e,t){return Bn._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return nn.credentialFromTaggedObject(e)}static credentialFromError(e){return nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return nn.credential(t,r)}catch{return null}}}nn.TWITTER_SIGN_IN_METHOD="twitter.com";nn.PROVIDER_ID="twitter.com";async function KT(n,e){return $m(n,"POST","/v1/accounts:signUp",No(n,e))}class wn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ct._fromIdTokenResponse(e,r,s),a=Gh(r);return new wn({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Gh(r);return new wn({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Gh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function QT(n){if(ot(n.app))return Promise.reject(dn(n));const e=Oo(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new wn({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await KT(e,{returnSecureToken:!0}),r=await wn._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class so extends zt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,so.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new so(e,t,r,s)}}function ng(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?so._fromErrorAndOperation(n,i,e,r):i})}async function XT(n,e,t=!1){const r=await Is(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wn._forOperation(n,"link",r)}async function YT(n,e,t=!1){const{auth:r}=n;if(ot(r.app))return Promise.reject(dn(r));const s="reauthenticate";try{const i=await Is(n,ng(r,s,e,n),t);G(i.idToken,r,"internal-error");const a=rl(i.idToken);G(a,r,"internal-error");const{sub:c}=a;return G(n.uid===c,r,"user-mismatch"),wn._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Bt(r,"user-mismatch"),i}}async function JT(n,e,t=!1){if(ot(n.app))return Promise.reject(dn(n));const r="signIn",s=await ng(n,r,e),i=await wn._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function ZT(n,e,t,r){return Be(n).onIdTokenChanged(e,t,r)}function e0(n,e,t){return Be(n).beforeAuthStateChanged(e,t)}const io="__sak";class rg{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(io,"1"),this.storage.removeItem(io),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const t0=1e3,n0=10;class sg extends rg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ym(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);DT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,n0):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},t0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}sg.type="LOCAL";const r0=sg;class ig extends rg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ig.type="SESSION";const og=ig;function s0(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Mo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Mo(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await s0(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mo.receivers=[];function ol(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class i0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=ol("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===h)switch(p.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(p.data.response);break;default:clearTimeout(f),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function At(){return window}function o0(n){At().location.href=n}function ag(){return typeof At().WorkerGlobalScope<"u"&&typeof At().importScripts=="function"}async function a0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function c0(){return navigator?.serviceWorker?.controller||null}function l0(){return ag()?self:null}const cg="firebaseLocalStorageDb",u0=1,oo="firebaseLocalStorage",lg="fbase_key";class Bs{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function xo(n,e){return n.transaction([oo],e?"readwrite":"readonly").objectStore(oo)}function h0(){const n=indexedDB.deleteDatabase(cg);return new Bs(n).toPromise()}function ac(){const n=indexedDB.open(cg,u0);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(oo,{keyPath:lg})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(oo)?e(r):(r.close(),await h0(),e(await ac()))})})}async function Wh(n,e,t){const r=xo(n,!0).put({[lg]:e,value:t});return new Bs(r).toPromise()}async function d0(n,e){const t=xo(n,!1).get(e),r=await new Bs(t).toPromise();return r===void 0?null:r.value}function Kh(n,e){const t=xo(n,!0).delete(e);return new Bs(t).toPromise()}const f0=800,m0=3;class ug{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ac(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>m0)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ag()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mo._getInstance(l0()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await a0(),!this.activeServiceWorker)return;this.sender=new i0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||c0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ac();return await Wh(e,io,"1"),await Kh(e,io),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Wh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>d0(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Kh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=xo(s,!1).getAll();return new Bs(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ug.type="LOCAL";const g0=ug;new Fs(3e4,6e4);function p0(n,e){return e?Vt(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class al extends eg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ur(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ur(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ur(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _0(n){return JT(n.auth,new al(n),n.bypassAuthState)}function y0(n){const{auth:e,user:t}=n;return G(t,e,"internal-error"),YT(t,new al(n),n.bypassAuthState)}async function w0(n){const{auth:e,user:t}=n;return G(t,e,"internal-error"),XT(t,new al(n),n.bypassAuthState)}class hg{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _0;case"linkViaPopup":case"linkViaRedirect":return w0;case"reauthViaPopup":case"reauthViaRedirect":return y0;default:Bt(this.auth,"internal-error")}}resolve(e){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const v0=new Fs(2e3,1e4);class nr extends hg{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,nr.currentPopupAction&&nr.currentPopupAction.cancel(),nr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return G(e,this.auth,"internal-error"),e}async onExecution(){jt(this.filter.length===1,"Popup operations only handle one event");const e=ol();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(It(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(It(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nr.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(It(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,v0.get())};e()}}nr.currentPopupAction=null;const E0="pendingRedirect",Si=new Map;class T0 extends hg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Si.get(this.auth._key());if(!e){try{const r=await I0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Si.set(this.auth._key(),e)}return this.bypassAuthState||Si.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function I0(n,e){const t=S0(e),r=b0(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function A0(n,e){Si.set(n._key(),e)}function b0(n){return Vt(n._redirectPersistence)}function S0(n){return bi(E0,n.config.apiKey,n.name)}async function R0(n,e,t=!1){if(ot(n.app))return Promise.reject(dn(n));const r=Oo(n),s=p0(r,e),a=await new T0(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const P0=600*1e3;class C0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!k0(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!dg(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(It(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=P0&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qh(e))}saveEventToCache(e){this.cachedEventUids.add(Qh(e)),this.lastProcessedEventTime=Date.now()}}function Qh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dg({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function k0(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dg(n);default:return!1}}async function V0(n,e={}){return Nr(n,"GET","/v1/projects",e)}const D0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,N0=/^https?/;async function O0(n){if(n.config.emulator)return;const{authorizedDomains:e}=await V0(n);for(const t of e)try{if(M0(t))return}catch{}Bt(n,"unauthorized-domain")}function M0(n){const e=ic(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!N0.test(t))return!1;if(D0.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const x0=new Fs(3e4,6e4);function Xh(){const n=At().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function L0(n){return new Promise((e,t)=>{function r(){Xh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xh(),t(It(n,"network-request-failed"))},timeout:x0.get()})}if(At().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(At().gapi?.load)r();else{const s=BT("iframefcb");return At()[s]=()=>{gapi.load?r():t(It(n,"network-request-failed"))},FT(`${$T()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw Ri=null,e})}let Ri=null;function U0(n){return Ri=Ri||L0(n),Ri}const F0=new Fs(5e3,15e3),$0="__/auth/iframe",B0="emulator/auth/iframe",j0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q0(n){const e=n.config;G(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?nl(e,B0):`https://${n.config.authDomain}/${$0}`,r={apiKey:e.apiKey,appName:n.name,v:Pr},s=z0.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ps(r).slice(1)}`}async function H0(n){const e=await U0(n),t=At().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:q0(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:j0,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=It(n,"network-request-failed"),c=At().setTimeout(()=>{i(a)},F0.get());function l(){At().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const G0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W0=500,K0=600,Q0="_blank",X0="http://localhost";class Yh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Y0(n,e,t,r=W0,s=K0){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...G0,width:r.toString(),height:s.toString(),top:i,left:a},h=$e().toLowerCase();t&&(c=Gm(h)?Q0:t),qm(h)&&(e=e||X0,l.scrollbars="yes");const f=Object.entries(l).reduce((p,[I,P])=>`${p}${I}=${P},`,"");if(VT(h)&&c!=="_self")return J0(e||"",c),new Yh(null);const m=window.open(e||"",c,f);G(m,n,"popup-blocked");try{m.focus()}catch{}return new Yh(m)}function J0(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Z0="__/auth/handler",eI="emulator/auth/handler",tI=encodeURIComponent("fac");async function Jh(n,e,t,r,s,i){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pr,eventId:s};if(e instanceof tg){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Qy(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof $s){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const l=await n._getAppCheckToken(),h=l?`#${tI}=${encodeURIComponent(l)}`:"";return`${nI(n)}?${Ps(c).slice(1)}${h}`}function nI({config:n}){return n.emulator?nl(n,eI):`https://${n.authDomain}/${Z0}`}const Aa="webStorageSupport";class rI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=og,this._completeRedirectFn=R0,this._overrideRedirectResult=A0}async _openPopup(e,t,r,s){jt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Jh(e,t,r,ic(),s);return Y0(e,i,ol())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Jh(e,t,r,ic(),s);return o0(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(jt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await H0(e),r=new C0(e);return t.register("authEvent",s=>(G(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Aa,{type:Aa},s=>{const i=s?.[0]?.[Aa];i!==void 0&&t(!!i),Bt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=O0(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ym()||Hm()||sl()}}const sI=rI;var Zh="@firebase/auth",ed="1.11.1";class iI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function oI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aI(n){gr(new Ln("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;G(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Jm(n)},h=new LT(r,s,i,l);return zT(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),gr(new Ln("auth-internal",e=>{const t=Oo(e.getProvider("auth").getImmediate());return(r=>new iI(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),cn(Zh,ed,oI(n)),cn(Zh,ed,"esm2020")}const cI=300,lI=$d("authIdTokenMaxAge")||cI;let td=null;const uI=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>lI)return;const s=t?.token;td!==s&&(td=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function hI(n=Gd()){const e=yc(n,"auth");if(e.isInitialized())return e.getImmediate();const t=jT(n,{popupRedirectResolver:sI,persistence:[g0,r0,og]}),r=$d("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=uI(i.toString());e0(t,a,()=>a(t.currentUser)),ZT(t,c=>a(c))}}const s=Ud("auth");return s&&qT(t,`http://${s}`),t}function dI(){return document.getElementsByTagName("head")?.[0]??document}UT({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=It("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",dI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aI("Browser");const fI={apiKey:"AIzaSyDRnPBNannDq8yhV516dDkHZ1uDIyeGBoE",authDomain:"ts-battleship.firebaseapp.com",projectId:"ts-battleship",storageBucket:"ts-battleship.firebasestorage.app",messagingSenderId:"970504775187",appId:"1:970504775187:web:6815bc1d3203e3dd4c41e6"},cl=Hd(fI),fg=hI(cl),qt=_m(cl),mg=async()=>{try{return(await QT(fg)).user.uid}catch(n){throw n instanceof Error&&console.error(n.message,n),new Error(my)}},nd=Object.freeze(Object.defineProperty({__proto__:null,app:cl,auth:fg,firestore:qt,signInAnonymous:mg},Symbol.toStringTag,{value:"Module"})),mI=async n=>{const e=Wc(qt,"rooms"),t=An(e),r=t.id,s=new Date(Date.now()+Ey),i=le.fromDate(s);return await Vm(t,{player1:{uid:n,ready:!1},status:"waiting",moves:{[n]:[]},sunkShipsCount:{[n]:0},expireAt:i}),r},gI=async(n,e)=>{const t=An(qt,"rooms",n),r=await Tr(t);if(!r.exists())throw new Error(ho);const s=r.data();if(s.player2)throw new Error(_y);if(s.status!=="waiting")throw new Error(yy);return await Ir(t,{player2:{uid:e,ready:!1},[`moves.${e}`]:[],[`sunkShipsCount.${e}`]:0}),!0},pI=async n=>{const e=Wc(qt,"rooms"),t=Sm(e,Rm("status","==","waiting")),r=await km(t);for(const s of r.docs){const i=s.data(),a=s.id;if(!i.player2&&i.player1.uid!==n)try{return await gI(a,n),a}catch(c){c instanceof Error&&ps(c.message)}}return await mI(n)},_I=async(n,e,t)=>{const r=An(qt,"rooms",n),s=await Tr(r);if(!s.exists())throw new Error(ho);const c=s.data().player1.uid===e?"player1":"player2";await Ir(r,{[`${c}.ready`]:!0,[`${c}.board`]:t.flat()});const h=(await Tr(r)).data();h.player1.ready&&h.player2?.ready&&await Ir(r,{status:"playing",currentTurn:h.player1.uid})},yI=async(n,e,t,r,s)=>{const i=An(qt,"rooms",n),a=await Tr(i);if(!a.exists())throw new Error(ho);const c=a.data();if(c.currentTurn!==e)throw new Error(Od);const l=s[t][r],h=l>0&&l<=5;let f=!1,m;if(h){const N=l,V=c.moves?.[e]??[],O=[];for(let U=r;U<W&&s[t][U]===N;U++)O.push({row:t,col:U});for(let U=r-1;U>=0&&s[t][U]===N;U--)O.push({row:t,col:U});if(O.length!==N){O.length=0;for(let U=t;U<W&&s[U][r]===N;U++)O.push({row:U,col:r});for(let U=t-1;U>=0&&s[U][r]===N;U--)O.push({row:U,col:r})}O.every(U=>V.some(B=>B.row===U.row&&B.col===U.col&&B.hit)||U.row===t&&U.col===r)&&O.length===N&&(f=!0,m=N)}const p=c.moves?.[e]??[],I={row:t,col:r,hit:h};f&&m&&(I.sunk=!0,I.sunkShipLength=m),p.push(I);const P=c.sunkShipsCount??{};P[e]||(P[e]=0),f&&P[e]++;const R=c.player1.uid===e?c.player2.uid:c.player1.uid;return await Ir(i,{[`moves.${e}`]:p,sunkShipsCount:P,currentTurn:R}),{row:t,col:r,hit:h,sunk:f}},gg=async(n,e)=>{const t=An(qt,"rooms",n);await Ir(t,{status:"finished",winner:e})},wI=(n,e)=>{const t=An(qt,"rooms",n);return Nm(t,r=>{r.exists()?e({...r.data(),id:n}):e(null)})},vI=async(n,e)=>{const t=An(qt,"rooms",n),r=await Tr(t);if(!r.exists())return;const s=r.data(),i=s.player1.uid===e;if(s.status==="waiting"||s.status==="ready")await Dm(t);else if(s.status!=="finished"){const a=i?s.player2.uid:s.player1.uid;await gg(n,a)}},EI="/ts-battleship/assets/ship-hit-Bt31znFL.opus",TI="/ts-battleship/assets/ship-sunk-D8oNHZWC.opus";class ll{length;sunk;coords;isVertical;_hits;constructor(e=2){this.length=e,this.sunk=!1,this.coords={row:0,col:0},this.isVertical=!1,this._hits=0}hit(){this.sunk||(this._hits++,this._isSunk())}_isSunk(){this._hits===this.length?(this.sunk=!0,rt(TI)):rt(EI)}}class wt{playerVictorious;playerBoard;opponentBoard;isCurrPlayerTurn;roomId;playerId;opponentId;isPlayer1;roomStatus;_unsubscribe;_onRoomUpdateCallbacks;_pendingRoomUpdate;_processedOpponentMoves;_processedPlayerMoves;constructor(e){this.playerVictorious=0,this.playerBoard=new or,this.opponentBoard=new or,this.isCurrPlayerTurn=!1,this.roomId=null,this.playerId=e,this.opponentId=null,this.roomStatus="waiting",this.isPlayer1=!1,this._unsubscribe=null,this._onRoomUpdateCallbacks=[],this._pendingRoomUpdate=null,this._processedOpponentMoves=new Set,this._processedPlayerMoves=new Set}get computerBoard(){return this.opponentBoard}async joinMatchmaking(){try{this.roomId=await pI(this.playerId),this._setupRoomSubscription();const{getDoc:e,doc:t}=await li(async()=>{const{getDoc:a,doc:c}=await Promise.resolve().then(()=>Uh);return{getDoc:a,doc:c}},void 0),{firestore:r}=await li(async()=>{const{firestore:a}=await Promise.resolve().then(()=>nd);return{firestore:a}},void 0),s=t(r,"rooms",this.roomId),i=await e(s);if(i.exists()){const a={...i.data(),id:this.roomId};this._onRoomUpdateCallbacks.length>0?this._onRoomUpdateCallbacks.forEach(c=>{c(a)}):this._pendingRoomUpdate=a}}catch(e){throw e instanceof Error&&console.error(e.message,e),new Error(gy)}}setRoomUpdateCallback(e){this._onRoomUpdateCallbacks.push(e),this._pendingRoomUpdate&&(this._onRoomUpdateCallbacks.forEach(t=>{t(this._pendingRoomUpdate)}),this._pendingRoomUpdate=null)}async submitBoard(){if(!this.roomId)throw new Error(da);const e=this._serializeBoard(this.playerBoard);await _I(this.roomId,this.playerId,e)}async takeTurn(e){if(!this.roomId)throw new Error(da);if(!this.isCurrPlayerTurn)throw new Error(Od);const t=`${e.row.toString()}-${e.col.toString()}`;if(this._processedPlayerMoves.has(t))return!1;try{const r=await this._getOpponentBoardFromRoom(),s=await yI(this.roomId,this.playerId,e.row,e.col,r);if(this.opponentBoard.fire(e),this._processedPlayerMoves.add(t),s.sunk){const i=this._findSunkShipDetails(e,r);i&&(this._markSunkShipVisuals(i.shipCells),this._markAdjacentMisses(i.shipCells)),await this._checkVictory()}else s.hit&&(this.opponentBoard.grid[e.row][e.col]=1,await this._checkVictory());return s.hit}catch(r){return r instanceof Error&&(ps(r.message),console.error(r.message,r)),!1}}async cleanup(){this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null),this.roomId&&(await vI(this.roomId,this.playerId),this.roomId=null),this._processedOpponentMoves.clear(),this._processedPlayerMoves.clear()}randomPlace(){this.playerBoard=new or;for(const e of Fi){const t=new ll(e);gc(this.playerBoard,t,!0)}}_findSunkShipDetails(e,t){const r=t[e.row][e.col],s=[];for(let i=0;i<W;i++)for(let a=0;a<W;a++)if(t[i][a]===r){const c=`${i.toString()}-${a.toString()}`;this._processedPlayerMoves.has(c)&&s.push({row:i,col:a})}return{shipCells:s,length:r}}_markSunkShipVisuals(e){e.forEach(t=>{this.opponentBoard.grid[t.row][t.col]=2;const r=document.getElementById("p2-"+(t.row*W+t.col).toString());r&&(r.style.backgroundColor=x.shipSunk,r.style.cursor="default")})}_markAdjacentMisses(e){e.forEach(t=>{this.opponentBoard.hitAdjacent({row:t.row,col:t.col}).forEach(s=>{const i=document.getElementById("p2-"+(s.row*W+s.col).toString());i&&(i.style.backgroundColor=x.emptyHit,i.style.cursor="default")})})}_serializeBoard(e){return e.grid.map(t=>t.map(r=>r===null?0:r.length))}_deserializeBoard(e){const t=[];for(let r=0;r<W;r++)t.push(e.slice(r*W,(r+1)*W));return t}_setupRoomSubscription(){this.roomId&&(this._unsubscribe=wI(this.roomId,e=>{if(this._onRoomUpdateCallbacks.length>0?this._onRoomUpdateCallbacks.forEach(r=>{r(e)}):this._pendingRoomUpdate=e,!e){this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null);return}this.roomStatus=e.status,this.isPlayer1=e.player1.uid===this.playerId,e.player2&&(this.opponentId=this.isPlayer1?e.player2.uid:e.player1.uid),e.currentTurn&&(this.isCurrPlayerTurn=e.currentTurn===this.playerId),this.opponentId&&(e.moves?.[this.opponentId]??[]).forEach(s=>{const i=`${s.row.toString()}-${s.col.toString()}`;this._processedOpponentMoves.has(i)||(this.playerBoard.fire({row:s.row,col:s.col}),this._processedOpponentMoves.add(i))}),(e.moves?.[this.playerId]??[]).forEach(r=>{const s=`${r.row.toString()}-${r.col.toString()}`;this._processedPlayerMoves.has(s)||(this.opponentBoard.fire({row:r.row,col:r.col}),r.sunk?this.opponentBoard.grid[r.row][r.col]=2:r.hit&&(this.opponentBoard.grid[r.row][r.col]=1),this._processedPlayerMoves.add(s))}),e.winner&&(this.playerVictorious=e.winner===this.playerId?1:2),this._onRoomUpdateCallbacks.length>0?this._onRoomUpdateCallbacks.forEach(r=>{r(e)}):this._pendingRoomUpdate=e}))}async _getOpponentBoardFromRoom(){if(!this.roomId)throw new Error(da);const{getDoc:e,doc:t}=await li(async()=>{const{getDoc:l,doc:h}=await Promise.resolve().then(()=>Uh);return{getDoc:l,doc:h}},void 0),{firestore:r}=await li(async()=>{const{firestore:l}=await Promise.resolve().then(()=>nd);return{firestore:l}},void 0),s=t(r,"rooms",this.roomId),i=await e(s);if(!i.exists())throw new Error(ho);const a=i.data(),c=this.isPlayer1?a.player2:a.player1;if(!c?.board)throw new Error(wy);return this._deserializeBoard(c.board)}async _checkVictory(){if(!this.roomId)return;const e=await this._getOpponentBoardFromRoom();let t=!0;for(let r=0;r<W;r++){for(let s=0;s<W;s++){const i=e[r][s];if(i>0&&i<=5){const a=`${r.toString()}-${s.toString()}`;if(!this._processedPlayerMoves.has(a)){t=!1;break}}}if(!t)break}t&&(await gg(this.roomId,this.playerId),this.playerVictorious=1)}}class tt{playerVictorious;playerBoard;computerBoard;isCurrPlayerOne;_targetMode;_targetQueue;_hitHistory;_currentDirection;_remainingShipLengths;_useParity;_parityOffset;constructor(e=!1){this.playerVictorious=0,this.playerBoard=new or,this.computerBoard=new or,e&&this._randomPlace(this.playerBoard),this._randomPlace(this.computerBoard),this.isCurrPlayerOne=!0,this._targetMode=!1,this._targetQueue=[],this._hitHistory=[],this._currentDirection=null,this._remainingShipLengths=[5,4,3,3,2],this._useParity=!0,this._parityOffset=Math.random()<.5?0:1}takeTurn(e){return(this.isCurrPlayerOne?this.computerBoard:this.playerBoard).fire(e)?(this._checkVictory(),this.isCurrPlayerOne=!this.isCurrPlayerOne,!0):!1}computerTurn(){return this._targetMode?this._smartTarget():this._hitWithHeatmap()}_generateHeatmap(){const e=Array.from({length:W},()=>Array(W).fill(0)),t=r=>Math.pow(r,1.5);for(const r of this._remainingShipLengths){const s=t(r);for(let i=0;i<W;i++)for(let a=0;a<=W-r;a++)if(this._canPlaceShip(i,a,r,!1))for(let c=0;c<r;c++)e[i][a+c]+=s;for(let i=0;i<=W-r;i++)for(let a=0;a<W;a++)if(this._canPlaceShip(i,a,r,!0))for(let c=0;c<r;c++)e[i+c][a]+=s}return e}_canPlaceShip(e,t,r,s){for(let i=0;i<r;i++){const a=s?e+i:e,c=s?t:t+i;if(this.playerBoard.impacts.some(h=>h.row===a&&h.col===c)&&this.playerBoard.grid[a][c]===null)return!1}return!0}_matchesParity(e){return(e.row+e.col)%2===this._parityOffset}_hitWithHeatmap(){const e=this._generateHeatmap();let t=-1;const r=[];Math.min(...this._remainingShipLengths)>2&&(this._useParity=!1);for(let c=0;c<W;c++)for(let l=0;l<W;l++){const h={row:c,col:l};this._useParity&&!this._matchesParity(h)||this._isValidTarget(h)&&(e[c][l]>t?(t=e[c][l],r.length=0,r.push(h)):e[c][l]===t&&r.push(h))}if(r.length===0&&this._useParity)return this._useParity=!1,this._hitWithHeatmap();const i=r[~~(Math.random()*r.length)]||this._getRandomValidTarget();this.takeTurn(i);const a=this.playerBoard.grid[i.row][i.col];return a!==null&&!a.sunk&&(this._targetMode=!0,this._useParity=!1,this._hitHistory.push(i),this._addCardinalDirections(i)),i}_getRandomValidTarget(){let e;do e={row:~~(Math.random()*W),col:~~(Math.random()*W)};while(!this._isValidTarget(e));return e}_smartTarget(){let e=null;for(;this._targetQueue.length>0;){const r=this._targetQueue.shift();if(this._isValidTarget(r)){e=r;break}}if(e===null){if(this._currentDirection!==null&&this._hitHistory.length>0)for(this._reverseDirection();this._targetQueue.length>0;){const r=this._targetQueue.shift();if(this._isValidTarget(r)){e=r;break}}if(e===null)return this._resetTargetMode(),this._hitWithHeatmap()}const t=this.playerBoard.grid[e.row][e.col];if(this.takeTurn(e),t!==null)if(this._hitHistory.push(e),t.sunk){const r=t.length,s=this._remainingShipLengths.indexOf(r);s>-1&&this._remainingShipLengths.splice(s,1),this._resetTargetMode()}else this._updateTargetStrategy(e);else this._currentDirection!==null&&this._hitHistory.length>0&&this._reverseDirection();return e}_updateTargetStrategy(e){if(this._hitHistory.length===1)this._addCardinalDirections(e);else if(this._hitHistory.length===2){const t=this._hitHistory[0],r=this._hitHistory[1];t.row===r.row?this._currentDirection={row:0,col:r.col>t.col?1:-1}:this._currentDirection={row:r.row>t.row?1:-1,col:0},this._targetQueue=[],this._continueInDirection(e)}else this._continueInDirection(e)}_addCardinalDirections(e){const t=[{row:-1,col:0},{row:1,col:0},{row:0,col:-1},{row:0,col:1}];this._targetQueue=t.map(r=>({row:e.row+r.row,col:e.col+r.col})).filter(r=>this._isValidTarget(r))}_continueInDirection(e){if(this._currentDirection===null)return;const t={row:e.row+this._currentDirection.row,col:e.col+this._currentDirection.col};this._isValidTarget(t)&&this._targetQueue.unshift(t)}_reverseDirection(){if(this._currentDirection===null||this._hitHistory.length===0)return;this._currentDirection={row:-this._currentDirection.row,col:-this._currentDirection.col};let t={...this._hitHistory[0]};for(this._targetQueue=[];t={row:t.row+this._currentDirection.row,col:t.col+this._currentDirection.col},!!this._isValidTarget(t);)this._targetQueue.push({...t})}_isValidTarget(e){const{row:t,col:r}=e;return t<0||t>=W||r<0||r>=W?!1:!this.playerBoard.impacts.some(s=>s.row===t&&s.col===r)}_resetTargetMode(){if(this._targetMode=!1,this._targetQueue=[],this._hitHistory=[],this._currentDirection=null,this._remainingShipLengths.length>0){const e=Math.min(...this._remainingShipLengths);this._useParity=e===2}}_randomPlace(e,t=!0){for(const r of Fi){const s=new ll(r);gc(e,s,t)}}_checkVictory(){if(this.playerBoard.isGameOver())return this.playerVictorious=2,!0;if(this.computerBoard.isGameOver())return this.playerVictorious=1,!0}}var II=de("<button type=button>New Game");const pg=n=>{const e=async()=>{n.game&&n.game instanceof wt&&await n.game.cleanup(),rt(ay),n.setGameMode(null),n.setGame(new tt),n.setIsControlUp(!0),n.overlay&&(n.overlay.style.display="none")};return(()=>{var t=II();return t.$$click=()=>{e()},re(()=>Y(t,Q`
        border: 0;
        border-radius: 0.125rem;
        cursor: pointer;
        font-size: 1.5rem;
        font-weight: 500;
        padding: 0.75rem;
        min-width: 7.625rem;
        background: ${x.secondary};
        color: ${x.grid};
        outline: 2px solid ${x.grid};
        transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1);

        &:active {
          background: ${x.hover};
        }

        ${ae.mouse} {
          &:hover {
            background: ${x.hover};
          }
        }
      `)),t})()};jn(["click"]);const AI="/ts-battleship/assets/clear-h0itgkGd.opus",_g="/ts-battleship/assets/deploy-FO-e3dUx.opus",rd="/ts-battleship/assets/start-DyMj29pa.opus";var bI=de("<button type=button>");const ba=n=>(()=>{var e=bI();return e.$$click=()=>{n.handleAction()},q(e,()=>n.icon),re(t=>{var r=n.title,s=n.isDisabled,i=Q`
      border: 0;
      border-radius: 0.125rem;
      cursor: pointer;
      font-size: 1.375rem;
      font-weight: 500;
      line-height: 1rem;
      padding: 0.5rem;
      background: ${x.secondary};
      color: ${x.grid};
      outline: 2px solid ${x.grid};
      transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1);

      &:active {
        background: ${x.hover};
      }

      ${ae.mouse} {
        &:hover {
          background: ${x.hover};
        }
      }

      &:disabled {
        cursor: not-allowed;
        background: ${x.hover};
      }

      ${ae.md} {
        font-size: 1.5rem;
        padding: 0.75rem;
      }

      ${ae.lg} {
        font-size: 1.625rem;
      }
    `;return r!==t.e&&it(e,"title",t.e=r),s!==t.t&&(e.disabled=t.t=s),i!==t.a&&Y(e,t.a=i),t},{e:void 0,t:void 0,a:void 0}),e})();jn(["click"]);const SI="/ts-battleship/assets/error-DXaqR_CU.opus";var RI=de("<div><section>"),PI=de("<button type=button>");const cc=n=>{const[e,t]=Se(!1),r=()=>{if(!n.isPlayerBoard||!n.isPlacing)return;const h="p1-",f=n.game.playerBoard;for(let m=0;m<W;m++)for(let p=0;p<W;p++){const I=document.getElementById(h+(m*W+p).toString());I&&(I.style.backgroundColor="",f.grid[m][p]?(I.style.backgroundColor=x.ship,I.dataset.shipPlaced="true",I.style.cursor="default"):(delete I.dataset.shipPlaced,I.style.cursor="pointer"),delete I.dataset.shipHover)}};Mt(hu(()=>n.placementRefreshTrigger?.(),()=>{r()},{defer:!0})),Mt(hu(()=>n.boardUpdateTrigger?.(),()=>{n.game instanceof wt&&(n.isPlayerBoard?(n.game.playerBoard.impacts.forEach(h=>{a(h.row,h.col)}),n.setIsOpponentTurn?.(h=>!h)):(n.game.opponentBoard.impacts.forEach(h=>{a(h.row,h.col)}),n.setIsOpponentTurn?.(h=>!h)))},{defer:!0})),lc(()=>{if(n.game instanceof wt&&n.setIsOpponentTurn?.(n.game.isPlayer1),n.isPlayerBoard&&!(n.game instanceof wt)){const h=f=>{const m=f,{row:p,col:I}=m.detail;n.setIsOpponentTurn?.(!1),a(p,I)};document.addEventListener("computerAttack",h),Ar(()=>{document.removeEventListener("computerAttack",h)})}});const s=(h,f)=>{if(n.game.playerBoard.shipsPlaced>=Pt)return;const m=Fi[n.game.playerBoard.shipsPlaced],p=new ll(m);if(gc(n.game.playerBoard,p,!1,h,f,n.isVertical)){const I=n.isPlayerBoard?"p1-":"p2-",P=n.game.playerBoard.grid[h][f];if(rt(_g),P)for(let C=0;C<P.length;C++){const R=P.isVertical?P.coords.row+C:h,N=P.isVertical?f:P.coords.col+C,V=document.getElementById(I+(R*W+N).toString());V&&(V.style.backgroundColor=x.ship,V.style.cursor="default")}n.game.playerBoard.shipsPlaced++,n.game.playerBoard.shipsPlaced>=Pt&&(n.startButton&&(n.startButton.disabled=!1),n.setIsDoneSetup&&n.setIsDoneSetup(!0)),n.shipInfo&&(n.shipInfo.innerText=n.game.playerBoard.shipsPlaced>=Pt?"Battle ready!":Ma[n.game.playerBoard.shipsPlaced])}else rt(SI)},i=(h,f)=>{if(n.game.playerVictorious||n.game instanceof wt&&!n.game.isCurrPlayerTurn||n.game instanceof tt&&e())return;n.game.takeTurn({row:h,col:f})&&(a(h,f),document.dispatchEvent(new Event("attack")),n.game instanceof tt&&n.setIsOpponentTurn?.(!0),!n.game.playerVictorious&&n.game instanceof tt&&(t(!0),setTimeout(()=>{const I=n.game.computerTurn();document.dispatchEvent(new CustomEvent("computerAttack",{detail:I})),document.dispatchEvent(new Event("attack")),t(!1)},1500)))},a=(h,f)=>{const m=n.isPlayerBoard?"p1-":"p2-",p=n.isPlayerBoard?n.game.playerBoard:n.game.computerBoard,I=document.getElementById(m+(h*W+f).toString());if(!I)return;const P=p.impacts.some(R=>R.row===h&&R.col===f),C=p.grid[h][f];if(!(!P&&!(n.game instanceof tt&&!n.isPlayerBoard)))if(!C)I.style.backgroundColor=x.emptyHit,I.style.cursor="default";else if(typeof C=="object")if(C.sunk)for(let R=0;R<C.length;R++){const N=C.isVertical?C.coords.row+R:h,V=C.isVertical?f:C.coords.col+R,O=document.getElementById(m+(N*W+V).toString());O&&(O.style.backgroundColor=x.shipSunk,O.style.cursor="default",p.hitAdjacent({row:N,col:V}).forEach(U=>{const B=document.getElementById(m+(U.row*W+U.col).toString());B&&(B.style.backgroundColor=x.emptyHit,B.style.cursor="default")}))}else I.style.backgroundColor=x.shipHit,I.style.cursor="default";else C===1?(I.style.backgroundColor=x.shipHit,I.style.cursor="default"):C===2&&(I.style.backgroundColor=x.shipSunk,I.style.cursor="default")},c=(h,f,m)=>{if(!n.isPlacing||!n.isPlayerBoard||n.game.playerBoard.shipsPlaced>=Pt)return;const p=Fi[n.game.playerBoard.shipsPlaced],I="p1-";let P=!0;const C=[],R=[];for(let V=0;V<p;V++){const O=n.isVertical?h+V:h,$=n.isVertical?f:f+V;R.push({row:O,col:$})}for(const V of R){if(V.row>=W||V.col>=W){P=!1;break}if(n.game.playerBoard.grid[V.row][V.col]){P=!1;break}for(let O=V.row-1;O<=V.row+1;O++){for(let $=V.col-1;$<=V.col+1;$++)if(!(O===V.row&&$===V.col||O<0||O>=W||$<0||$>=W||R.some(B=>B.row===O&&B.col===$))&&n.game.playerBoard.grid[O][$]){P=!1;break}if(!P)break}if(!P)break}for(const V of R)if(V.row<W&&V.col<W){const O=I+(V.row*W+V.col).toString(),$=document.getElementById(O);$&&C.push($)}const N=P?"valid":"invalid";C.forEach(V=>{m?V.dataset.shipHover=N:delete V.dataset.shipHover})},l=Q`
    position: relative;
    padding: 3px;
    margin: -3px;
    border-radius: 0.125rem;
    overflow: hidden;
    isolation: isolate;

    &:before {
      content: '';
      position: absolute;
      top: -100%;
      left: -100%;
      width: 300%;
      height: 300%;
      z-index: -1;

      background: conic-gradient(
        ${x.secondary} 0% 16%,
        transparent 16% 44%,
        transparent 44% 72%,
        transparent 72% 100%
      );

      animation: spin 1.5s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(1turn);
      }
    }
  `;return(()=>{var h=RI(),f=h.firstChild;return q(f,z(ka,{get each(){return n.game.playerBoard.grid},children:(m,p)=>z(ka,{each:m,children:(I,P)=>(()=>{var C=PI();return C.addEventListener("mouseleave",()=>{c(p(),P(),!1)}),C.addEventListener("mouseenter",()=>{c(p(),P(),!0)}),C.$$click=()=>{n.isPlacing&&n.game.playerBoard.shipsPlaced<Pt&&s(p(),P()),n.isPlayerBoard||i(p(),P())},re(R=>{var N=`${n.isPlayerBoard?"p1-":"p2-"}${(p()*W+P()).toString()}`,V=Q`
                    background: ${I&&n.isPlayerBoard?x.ship:x.secondary};
                    border: 1px solid ${x.grid};
                    padding: ${n.isPlacing?"14.5px":"15.5px"};
                    text-align: center;
                    cursor: ${(!n.isPlayerBoard||n.isPlacing&&!I)&&"pointer"};

                    &[data-ship-hover='valid'] {
                      background: ${x.hover};
                    }

                    &[data-ship-hover='invalid'] {
                      background: ${x.outOfBounds};
                    }

                    ${ae.mouse} {
                      &:hover {
                        background: ${!n.isPlayerBoard&&x.hover};
                      }
                    }

                    ${ae.sm} {
                      padding: ${n.isPlacing?"16.5px":"13.5px"};
                    }

                    ${ae.md} {
                      padding: ${n.isPlacing?"18.5px":"16.5px"};
                    }

                    ${ae.lg} {
                      padding: 1.25rem;
                    }
                  `;return N!==R.e&&it(C,"id",R.e=N),V!==R.t&&Y(C,R.t=V),R},{e:void 0,t:void 0}),C})()})})),re(m=>{var p=n.isOpponentTurn?l:"",I=Q`
          font-size: 2.5rem;
          font-weight: 600;
          display: grid;
          border: 1px solid ${x.grid};
          grid-template-columns: repeat(${W}, 1fr);
          grid-template-rows: repeat(${W}, 1fr);
          max-width: 26.375rem;
          min-width: 19.5rem;
          position: relative;
          aspect-ratio: 1;
        `;return p!==m.e&&Y(h,m.e=p),I!==m.t&&Y(f,m.t=I),m},{e:void 0,t:void 0}),h})()};jn(["click"]);var CI=de("<div id=controls><section><div><button type=button></button><h1>New Game</h1></div><span> Player</span><div id=panel><span id=ship-selection><span id=ship-info></span></span><span>"),kI=de("<div>"),VI=de("<button type=button id=start-button>Start");const DI=n=>{const[e,t]=Se(!1),[r,s]=Se(!1),[i,a]=Se([]),[c,l]=Se([]),[h,f]=Se(!1),[m,p]=Se(0);lc(()=>{a(document.getElementById("ship-info")),l(document.getElementById("start-button")),n.gameMode==="pvp"&&n.game instanceof wt&&n.game.setRoomUpdateCallback(C=>{C?.status==="playing"&&st(h)&&(f(!1),n.setIsControlUp(!1),rt(rd))})});const I=async()=>{if(n.gameMode==="pvp"){const P=n.game;try{f(!0),await P.submitBoard()}catch(C){C instanceof Error&&(ps(C.message),console.error(C.message,C)),f(!1);return}}else n.setIsControlUp(!1),rt(rd)};return(()=>{var P=CI(),C=P.firstChild,R=C.firstChild,N=R.firstChild,V=N.nextSibling,O=R.nextSibling,$=O.firstChild,U=O.nextSibling,B=U.firstChild,E=B.firstChild,y=B.nextSibling;return N.$$click=()=>{n.game instanceof wt&&n.game.cleanup(),n.setGameMode(null)},q(N,z(bd,{size:"2rem"})),q(O,z(Oa,{}),$),q(C,z(cc,{isPlayerBoard:!0,isPlacing:!0,get isVertical(){return r()},get game(){return n.game},get shipInfo(){return i()},get startButton(){return c()},setIsDoneSetup:t,placementRefreshTrigger:m}),U),q(B,z(p_,{}),E),q(E,()=>Ma[0]),q(y,z(ba,{handleAction:()=>{s(_=>!_)},get isDisabled(){return h()},get icon(){return qe(()=>!!r())()?z(m_,{}):z(g_,{})},title:"Rotate"}),null),q(y,z(ba,{handleAction:()=>{if(n.gameMode==="pve")n.setGame(new tt(!0)),n.game.playerBoard.shipsPlaced=Pt;else{const _=n.game;_.randomPlace(),_.playerBoard.shipsPlaced=Pt}rt(_g),t(!0),i().innerText="Battle ready!",n.gameMode==="pvp"&&p(_=>_+1)},get isDisabled(){return h()},get icon(){return z(y_,{})},title:"Randomize"}),null),q(y,z(ba,{handleAction:()=>{if(n.gameMode==="pve")n.setGame(new tt);else{const _=n.game;_.playerBoard=new or,_.playerBoard.shipsPlaced=0}rt(AI),t(!1),i().innerText=Ma[0],c().disabled=!0,n.gameMode==="pvp"&&p(_=>_+1)},get isDisabled(){return h()},get icon(){return z(w_,{})},title:"Clear"}),null),q(C,(()=>{var _=qe(()=>!!h());return()=>_()?(()=>{var T=kI();return q(T,z(Id,{get class(){return Q`
                animation: spin 1.5s linear infinite;

                @keyframes spin {
                  to {
                    transform: rotate(360deg);
                  }
                }
              `}}),null),q(T,()=>Qn.waitingForSetup,null),re(()=>Y(T,Q`
              display: flex;
              justify-content: center;
              align-items: center;
              padding: 1rem;
              font-size: 1.5rem;
              height: 3.25rem;
              line-height: 1;
              gap: 0.5rem;
              text-align: center;
            `)),T})():(()=>{var T=VI();return T.$$click=()=>{I()},re(v=>{var A=!e(),w=Q`
              border: 0;
              border-radius: 0.125rem;
              cursor: pointer;
              font-size: 1.5rem;
              font-weight: 500;
              min-width: 7.625rem;
              height: 3.25rem;
              padding: 0.5rem;
              background: ${x.secondary};
              color: ${x.grid};
              outline: 2px solid ${x.grid};
              transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1);

              &:active {
                background: ${x.hover};
              }

              ${ae.mouse} {
                &:hover {
                  background: ${x.hover};
                }
              }

              &:disabled {
                cursor: not-allowed;
                background: ${x.hover};
              }

              ${ae.md} {
                padding: 0.75rem;
              }
            `;return A!==v.e&&(T.disabled=v.e=A),w!==v.t&&Y(T,v.t=w),v},{e:void 0,t:void 0}),T})()})(),null),re(_=>{var T=Q`
        display: flex;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
      `,v=Q`
          display: inherit;
          flex-direction: column;
          padding: 1rem;
          margin: 1rem;
          gap: 0.75rem;
          width: 23.75rem;
          min-width: fit-content;
          max-width: 98%;
          line-height: 1rem;
          background: ${x.primary};
          border: 2px solid ${x.secondary};
          border-radius: 0.125rem;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        `,A=Q`
            display: inherit;
          `,w=Q`
              z-index: 1;
              border: none;
              cursor: pointer;
              background: transparent;
              display: inherit;
              align-items: center;
              color: ${x.secondary};
              width: 3rem;
              height: 3.5rem;
              padding: 0.125rem 0 0;
              font-size: 1.625rem;

              &:active {
                color: ${x.hover};
              }

              ${ae.mouse} {
                &:hover {
                  color: ${x.hover};
                }
              }
            `,ye=Q`
              flex-grow: 1;
              text-align: center;
              margin-left: -2rem;
            `,Xe=Q`
            font-size: 1.75rem;

            svg {
              font-size: 1.25rem;
            }
          `,bn=Q`
            display: inherit;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
          `,Sn=Q`
              font-size: 1.5rem;

              svg {
                vertical-align: middle;
                font-size: 1.375rem;
                padding-right: 0.375rem;
              }

              ${ae.md} {
                font-size: 1.625rem;

                svg {
                  font-size: 1.5rem;
                }
              }

              ${ae.lg} {
                font-size: 1.75rem;

                svg {
                  font-size: 1.75rem;
                }
              }
            `,Rn=Q`
              display: inherit;
              gap: 0.5rem;
            `;return T!==_.e&&Y(P,_.e=T),v!==_.t&&Y(C,_.t=v),A!==_.a&&Y(R,_.a=A),w!==_.o&&Y(N,_.o=w),ye!==_.i&&Y(V,_.i=ye),Xe!==_.n&&Y(O,_.n=Xe),bn!==_.s&&Y(U,_.s=bn),Sn!==_.h&&Y(B,_.h=Sn),Rn!==_.r&&Y(y,_.r=Rn),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),P})()};jn(["click"]);const NI="/ts-battleship/assets/defeat-CVrvGHm7.opus",OI="/ts-battleship/assets/victory-BEcHz5yT.opus";var MI=de("<div id=overlay><section><h1 id=victor>");const xI=n=>{let e=document.getElementById("victor");const t=r=>{if(n.gameMode===null){n.overlay.style.display="none";return}if(n.overlay.style.display="flex",r===1)e.innerText="Player Wins!",rt(OI);else{const s=n.gameMode==="pvp"?"Opponent":"Computer";e.innerText=`${s} Wins...`,rt(NI)}};return Mt(()=>{const r=()=>{const s=n.game.playerVictorious,i=n.game.playerBoard.shipsPlaced>=Pt;console.log(s),s&&n.gameMode&&i?t(s):n.overlay.style.display="none"};n.boardUpdateTrigger(),r(),document.addEventListener("attack",r),Ar(()=>{document.removeEventListener("attack",r)})}),(()=>{var r=MI(),s=r.firstChild,i=s.firstChild,a=n.overlay;typeof a=="function"?hs(a,r):n.overlay=r;var c=e;return typeof c=="function"?hs(c,i):e=i,q(i,()=>n.game.playerVictorious),q(s,z(pg,{get game(){return n.game},get setGame(){return n.setGame},get setIsControlUp(){return n.setIsControlUp},get overlay(){return n.overlay},get gameMode(){return n.gameMode??void 0},get setGameMode(){return n.setGameMode}}),null),re(l=>{var h=Q`
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.75);
        justify-content: center;
        align-items: center;
        z-index: 1;
      `,f=Q`
          display: inherit;
          flex-direction: column;
          padding: 1rem;
          margin: 1rem;
          gap: 0.75rem;
          line-height: 1rem;
          background: ${x.primary};
          border: 2px solid ${x.secondary};
          border-radius: 0.125rem;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);

          ${ae.sm} {
            padding: 3rem;
          }

          ${ae.md} {
            padding: 4rem;
          }

          ${ae.lg} {
            padding: 5rem;
          }
        `,m=Q`
            font-size: 2.5rem;
            text-align: center;
            line-height: 1em;
          `;return h!==l.e&&Y(r,l.e=h),f!==l.t&&Y(s,l.t=f),m!==l.a&&Y(i,l.a=m),l},{e:void 0,t:void 0,a:void 0}),r})()};var LI=de("<div><section><h1>Game Mode</h1><div><button type=button><span>PvE</span></button><button type=button><span>PvP");const UI=n=>(()=>{var e=LI(),t=e.firstChild,r=t.firstChild,s=r.nextSibling,i=s.firstChild,a=i.firstChild,c=i.nextSibling,l=c.firstChild;return i.$$click=()=>void n.setGameMode("pve"),q(i,z(Ad,{}),a),c.$$click=()=>void n.setGameMode("pvp"),q(c,z(__,{}),l),re(h=>{var f=Q`
      display: flex;
      width: 100%;
      height: 100%;
      justify-content: center;
      align-items: center;
    `,m=Q`
        display: inherit;
        flex-direction: column;
        align-items: center;
        padding: 1.5rem;
        margin: 1rem;
        gap: 1.5rem;
        min-width: 18rem;
        background: ${x.primary};
        border: 2px solid ${x.secondary};
        border-radius: 0.125rem;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      `,p=Q`
          text-align: center;
          font-size: 2rem;
          margin: 0;

          ${ae.md} {
            font-size: 2.25rem;
          }
        `,I=Q`
          display: inherit;
          flex-direction: column;
          gap: 1rem;

          ${ae.sm} {
            flex-direction: row;
            gap: 1.5rem;
          }
        `,P=Q`
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            border: 2px solid ${x.secondary};
            border-radius: 0.125rem;
            cursor: pointer;
            font-size: 1.25rem;
            width: 11rem;
            font-weight: 500;
            background: ${x.primary};
            color: ${x.secondary};
            aspect-ratio: 1;
            transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);

            svg {
              font-size: 3rem;
            }

            &:active {
              background: ${x.secondary};
              color: ${x.primary};
            }

            ${ae.mouse} {
              &:hover {
                background: ${x.secondary};
                color: ${x.primary};
              }
            }

            ${ae.md} {
              font-size: 1.5rem;

              svg {
                font-size: 3.5rem;
              }
            }
          `,C=Q`
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            border: 2px solid ${x.secondary};
            border-radius: 0.125rem;
            cursor: pointer;
            font-size: 1.25rem;
            font-weight: 500;
            padding: 2rem 2.5rem;
            background: ${x.primary};
            color: ${x.secondary};
            transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
            aspect-ratio: 1;
            width: 11rem;

            svg {
              font-size: 3rem;
            }

            &:active {
              background: ${x.secondary};
              color: ${x.primary};
            }

            ${ae.mouse} {
              &:hover {
                background: ${x.secondary};
                color: ${x.primary};
              }
            }

            ${ae.md} {
              font-size: 1.5rem;

              svg {
                font-size: 3.5rem;
              }
            }
          `;return f!==h.e&&Y(e,h.e=f),m!==h.t&&Y(t,h.t=m),p!==h.a&&Y(r,h.a=p),I!==h.o&&Y(s,h.o=I),P!==h.i&&Y(i,h.i=P),C!==h.n&&Y(c,h.n=C),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),e})();jn(["click"]);var FI=de("<div id=app>"),$I=de("<div><div></div><button type=button> Back"),BI=de("<main><div><span><span> Player</span></span><span><span></span></span></div><div><button type=button>");const jI=()=>{let n=document.getElementById("overlay");const[e,t]=Se(null),[r,s]=Se(new tt),[i,a]=Se(!0),[c,l]=Se(!1),[h,f]=Se(!1),[m,p]=Se(""),[I,P]=Se(0),C=async R=>{if(t(R),R==="pvp"){l(!0),p(Qn.connecting);try{const N=await mg(),V=new wt(N);if(await V.joinMatchmaking(),e()!=="pvp"){V.cleanup();return}V.setRoomUpdateCallback(O=>{if(!O){ps(py),t(null),s(new tt),p(""),a(!0);return}switch(O.status){case"waiting":O.player2?p(""):p(Qn.waitingToJoin);break;case"ready":p(Qn.ready);break;case"playing":p(""),f(!V.isCurrPlayerTurn),P($=>$+1);break;case"finished":p(""),P($=>$+1),a(!1)}}),s(V)}catch(N){N instanceof Error&&(ps(N.message),console.error(N.message,N)),t(null),s(new tt),p(""),a(!0)}finally{l(!1)}}else s(new tt),p("")};return Ar(()=>{const R=r();R instanceof wt&&R.cleanup()}),(()=>{var R=FI();return q(R,z(xI,{get game(){return r()},setGame:s,setIsControlUp:a,overlay:n,get gameMode(){return e()},setGameMode:t,boardUpdateTrigger:I}),null),q(R,z(b_,{}),null),q(R,(()=>{var N=qe(()=>!e()&&!c());return()=>N()&&z(UI,{setGameMode:C})})(),null),q(R,(()=>{var N=qe(()=>!!(c()||m()));return()=>N()&&(()=>{var V=$I(),O=V.firstChild,$=O.nextSibling,U=$.firstChild;return q(O,z(Id,{get class(){return Q`
                animation: spin 1.5s linear infinite;

                @keyframes spin {
                  to {
                    transform: rotate(360deg);
                  }
                }
              `}}),null),q(O,()=>m()||Qn.connecting,null),$.$$click=()=>{const B=r();B instanceof wt&&B.cleanup(),l(!1),p(""),t(null),s(new tt)},q($,z(bd,{size:"1.75rem"}),U),re(B=>{var E=Q`
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 0.25rem;
          `,y=Q`
              display: inherit;
              justify-content: center;
              align-items: center;
              flex: 1;
              gap: 0.5rem;
              padding: 0 1rem;
              font-size: 1.5rem;

              & svg {
                font-size: 1.5rem;
              }
            `,_=Q`
              border: none;
              cursor: pointer;
              background: transparent;
              display: inherit;
              align-items: center;
              color: ${x.secondary};
              width: 3rem;
              height: 3.5rem;
              padding: 0.125rem 0 0;
              margin-left: -1.75rem;
              font-size: 1.375rem;

              &:active {
                color: ${x.hover};
              }

              ${ae.mouse} {
                &:hover {
                  color: ${x.hover};
                }
              }
            `;return E!==B.e&&Y(V,B.e=E),y!==B.t&&Y(O,B.t=y),_!==B.a&&Y($,B.a=_),B},{e:void 0,t:void 0,a:void 0}),V})()})(),null),q(R,(()=>{var N=qe(()=>!!(e()&&!c()&&(m()===""||m()===Qn.ready)&&i()));return()=>N()&&z(DI,{get game(){return r()},setGame:s,setIsControlUp:a,get gameMode(){return e()},setGameMode:t})})(),null),q(R,(()=>{var N=qe(()=>!!(e()&&!c()&&!i()));return()=>N()&&(()=>{var V=BI(),O=V.firstChild,$=O.firstChild,U=$.firstChild,B=U.firstChild,E=$.nextSibling,y=E.firstChild,_=O.nextSibling,T=_.firstChild;return q(U,z(Oa,{}),B),q(U,(()=>{var v=qe(()=>!!h());return()=>v()&&z(ha,{size:"1.25rem",get class(){return Q`
                      vertical-align: middle;
                      margin-left: 0.25rem;
                      animation: spin 1.5s linear infinite;

                      @keyframes spin {
                        to {
                          transform: rotate(360deg);
                        }
                      }
                    `}})})(),null),q($,z(cc,{isPlayerBoard:!0,isPlacing:!1,isVertical:!1,get game(){return r()},get isOpponentTurn(){return h()},setIsOpponentTurn:f,boardUpdateTrigger:I}),null),q(y,(()=>{var v=qe(()=>e()==="pve");return()=>v()?[z(Ad,{})," Computer",qe(()=>qe(()=>!h())()&&z(ha,{size:"1.25rem",get class(){return Q`
                          vertical-align: middle;
                          margin-left: 0.25rem;
                          animation: spin 1.5s linear infinite;

                          @keyframes spin {
                            to {
                              transform: rotate(360deg);
                            }
                          }
                        `}}))]:[z(Oa,{})," Opponent",qe(()=>qe(()=>!h())()&&z(ha,{size:"1.25rem",get class(){return Q`
                          vertical-align: middle;
                          margin-left: 0.25rem;
                          animation: spin 1.5s linear infinite;

                          @keyframes spin {
                            to {
                              transform: rotate(360deg);
                            }
                          }
                        `}}))]})()),q(E,z(cc,{isPlayerBoard:!1,isPlacing:!1,isVertical:!1,get game(){return r()},get isOpponentTurn(){return!h()},setIsOpponentTurn:f,boardUpdateTrigger:I}),null),q(_,z(pg,{get game(){return r()},setGame:s,setIsControlUp:a,get gameMode(){return e()},setGameMode:t}),T),fd(T,"click",uy,!0),q(T,(()=>{var v=qe(()=>!!mc());return()=>v()?z(E_,{size:"1.75rem"}):z(v_,{size:"1.75rem"})})()),re(v=>{var A=Q`
            display: inherit;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 1.5rem auto;
          `,w=Q`
              display: inherit;
              justify-content: center;
              flex-direction: column;
              align-items: center;
              margin-bottom: 2rem;
              font-size: 1.75rem;
              gap: 1.5rem;

              ${ae.sm} {
                flex-direction: row;
                gap: 2rem;
              }

              ${ae.md} {
                gap: 2.5rem;
              }

              ${ae.lg} {
                gap: 3rem;
              }
            `,ye=Q`
                display: inherit;
                flex-direction: column;
                justify-content: center;
                gap: 0.25rem;

                & svg {
                  font-size: 1.25rem;
                }
              `,Xe=Q`
                display: inherit;
                flex-direction: column;
                justify-content: center;
                gap: 0.25rem;

                svg {
                  font-size: 1.5rem;
                }
              `,bn=Q`
              display: inherit;
              margin-left: 3.5rem;
              gap: 0.5rem;
            `,Sn=Q`
                border: none;
                cursor: pointer;
                background: transparent;
                display: inherit;
                justify-content: center;
                align-items: center;
                color: ${x.secondary};
                width: 3rem;
                height: 3.5rem;
                padding: 0.125rem;
                font-size: 1.5rem;

                &:active {
                  color: ${x.hover};
                }

                ${ae.mouse} {
                  &:hover {
                    color: ${x.hover};
                  }
                }
              `;return A!==v.e&&Y(V,v.e=A),w!==v.t&&Y(O,v.t=w),ye!==v.a&&Y($,v.a=ye),Xe!==v.o&&Y(E,v.o=Xe),bn!==v.i&&Y(_,v.i=bn),Sn!==v.n&&Y(T,v.n=Sn),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),V})()})(),null),q(R,z(I_,{}),null),q(R,z(oy,{}),null),re(()=>Y(R,Q`
        font-family: 'Stick No Bills Variable', sans-serif;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        user-select: none;
        min-height: 100dvh;
        background: ${x.primary};
        accent-color: ${x.secondary};
        color: ${x.secondary};

        *::selection {
          background: ${x.secondary};
          color: ${x.primary};
        }

        & button {
          -webkit-tap-highlight-color: transparent;
        }
      `)),R})()};console.log("Pride of a nation, a beast made of steel!");jn(["click"]);const sd=document.getElementById("root");sd&&yp(()=>z(jI,{}),sd);const zI=()=>{"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/ts-battleship/sw.js",{scope:"/ts-battleship/"}).catch(n=>{n instanceof Error&&console.error(fy,n)})})};zI();
